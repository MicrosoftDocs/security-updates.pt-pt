---
TOCTitle: 'MS04-032'
Title: 'Microsoft Security Bulletin MS04-032 - Crítica'
ms:assetid: 'ms04-032'
ms:contentKeyID: 61234069
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms04-032(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS04-032 - Crítica
==============================================

Actualização de Segurança para o Microsoft Windows (840987)
-----------------------------------------------------------

Updated: 9 de dezembro de 2008

**actualizada:** 1.1

**Publicado em:** 12 de Outubro de 2004
**Versão:** 1.1

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o Microsoft Windows

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes devem instalar de imediato a actualização.

**Substituição de Actualizações de Segurança:** Este boletim substitui várias actualizações de segurança anteriores. Consulte a secção de Perguntas mais frequentes deste boletim para obter a lista completa.

**Avisos:** O Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) da Base de Dados de Conhecimento da Microsoft documenta as questões actualmente conhecidas que os clientes podem verificar quando instalam esta actualização de segurança. O artigo também documenta soluções recomendadas para estas questões. Para mais informações, consulte o Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) da Base de Dados de Conhecimento da Microsoft.

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   Microsoft Windows NT Server 4.0 Service Pack 6a - [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=533ae5cd-74ce-470a-8916-8e358084497c)
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6 - [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=3b871a96-5f64-4432-920f-fa5760df683a)
-   Microsoft Windows 2000 Service Pack 3 e Microsoft Windows 2000 Service Pack 4 – [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=4a614222-ba0b-4927-856d-d443bbbe1a42)
-   Microsoft Windows XP e Microsoft Windows XP Service Pack 1 – [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=715e985b-7929-4bd5-9564-5cfe7d528398)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1- [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=99184841-70a8-47c7-9993-44a60e999a40)
-   Microsoft Windows XP 64-Bit Edition Versão 2003 - [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c)
-   Microsoft Windows Server 2003 64-Bit Edition - [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c)
-   Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE) e Microsoft Windows Millennium Edition (ME) – Reveja a secção de Perguntas mais frequentes deste boletim para obter detalhes sobre estes sistemas operativos.

**Software Não Afectado:**

-   Microsoft Windows XP Service Pack 2

O software referido nesta lista foi testado para determinar se as versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida de suporte relativamente ao seu produto e versão, visite o [Web site do Ciclo de Vida de Suporte da Microsoft](http://support.microsoft.com/lifecycle/).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve várias vulnerabilidades recentemente descobertas e comunicadas de forma privada. Cada vulnerabilidade está documentada neste boletim na secção Detalhes sobre a Vulnerabilidade correspondente.

Um intruso que explore com sucesso a mais grave destas vulnerabilidades pode controlar totalmente o sistema afectado, incluindo instalar programas, visualizar, alterar ou eliminar dados, ou criar novas contas com todos os privilégios.

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                                       | Impacto da Vulnerabilidade | Windows 98, 98 SE, ME | Windows NT 4.0 | Windows 2000 | Windows XP  | Windows Server 2003 |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|-----------------------|----------------|--------------|-------------|---------------------|
| Vulnerabilidade do Sistema de Gestão do Windows - [CAN-2004-0207](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0207)       | Elevação de Privilégios    | Não Crítica           | Importante     | Importante   | Importante  | Importante          |
| Vulnerabilidade da Virtual DOS Machine - [CAN-2004-0118](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0208)                | Elevação de Privilégios    | Nenhum                | Importante     | Importante   | Importante  | Importante          |
| Vulnerabilidade do Motor de Processamento de Gráficos - [CAN-2004-0209](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0209) | Execução Remota de Código  | Nenhum                | Nenhum         | Crítica      | Crítica     | Crítica             |
| Vulnerabilidade do Kernel do Windows - [CAN-2004-0211](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0211)                  | Negação de Serviço         | Nenhum                | Nenhum         | Nenhum       | Nenhum      | Importante          |
| **Gravidade Agregada de Todas as Vulnerabilidades**                                                                                      |                            | **Não Crítica**       | **Importante** | **Crítica**  | **Crítica** | **Crítica**         |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Por que razão foi revisto este boletim a 9 de Dezembro de 2008?**
Este boletim foi revisto para comunicar a remoção do pacote Windows Server 2003 devido a questões não relacionadas com a estabilidade da actualização ou a segurança dos sistemas visados. Os clientes que já tenham aplicado esta actualização com sucesso não necessitam de efectuar qualquer acção. Os clientes do Windows Server 2003 que não tenham aplicado esta actualização e estejam preocupados com esta questão devem aplicar [o service pack mais recente](http://support.microsoft.com/kb/889100). A aplicabilidade deste boletim noutros sistemas operativos Windows não se alterou.

**Por que razão esta actualização resolve diversas vulnerabilidades de segurança comunicadas?**
Esta actualização contém suporte para diversas vulnerabilidades, porque as modificações necessárias para resolver essas questões estão incluídas nos ficheiros relacionados. Assim, em vez de instalarem diversas actualizações quase iguais, os clientes podem instalar apenas esta actualização.

**Que actualizações são substituídas por esta edição?**
Esta actualização de segurança substitui vários boletins de segurança anteriores. Os sistemas operativos e os ID do boletim de segurança afectados encontram-se listados na seguinte tabela.

| Identificação do Boletim                                     | Windows NT 4.0  | Windows 2000 | Windows XP      | Windows Server 2003 |
|--------------------------------------------------------------|-----------------|--------------|-----------------|---------------------|
| [**MS02-071**](http://go.microsoft.com/fwlink?linkid=10597)  | Substituído     | Substituído  | Não Substituído | Não Aplicável       |
| [**MS03-007**](http://go.microsoft.com/fwlink?linkid=14822)  | Não Substituído | Substituído  | Não Substituído | Não Aplicável       |
| [**MS03-013**](http://go.microsoft.com/fwlink?linkid=12675)  | Substituído     | Substituído  | Substituído     | Não Aplicável       |
| [**MS03-045**](http://go.microsoft.com/fwlink/?linkid=18866) | Substituído     | Substituído  | Substituído     | Não Substituído     |

**Ainda estou a utilizar o Windows XP, mas o suporte alargado a actualizações de segurança terminou a 30 de Setembro de 2004. No entanto, este boletim possui uma actualização de segurança para esta versão do sistema. Qual é a razão?**

A versão original do Windows XP, normalmente conhecida como Windows XP Gold ou Windows XP Release to Manufacturing (RTM), chegou ao fim do ciclo de vida do respectivo suporte alargado a actualizações de segurança a 30 de Setembro de 2004. Contudo, o fim do ciclo de vida ocorreu recentemente. Neste caso, a maior parte dos passos necessários para resolver esta vulnerabilidade foram concluídos antes dessa data. Assim, decidimos lançar uma actualização de segurança para esta versão do sistema operativo como parte deste boletim de segurança.
Não nos comprometemos a fazê-lo para vulnerabilidades futuras que poderão afectar esta versão do sistema operativo, mas reservamo-nos o direito de produzir actualizações e disponibilizá-las quando for necessário. Os utilizadores que tenham esta versão do sistema operativo deviam considerar a migração para versões suportadas de sistemas operativos como uma prioridade, de modo a poderem estar protegidos contra a potencial exposição a vulnerabilidades futuras. Para mais informações sobre o Ciclo de Vida de Produtos do Windows Service Pack, visite o [Web site do Ciclo de Vida de Suporte da Microsoft](http://support.microsoft.com/default.aspx?pr=lifesupsps). Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o [Web site do Ciclo de Vida do Suporte da Microsoft](http://support.microsoft.com/lifecycle/).

Para mais informações, consulte a secção de [Perguntas mais frequentes do Sistema Operativo Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Ainda estou a usar o Microsoft Windows NT 4.0 Workstation Service Pack 6a ou o Windows 2000 Service Pack 2, mas o suporte alargado a actualizações de segurança terminou a 30 de Junho de 2004. O que devo fazer?**
O Windows NT 4.0 Workstation Service Pack 6a e o Windows 2000 Service Pack 2 chegaram ao fim dos seus ciclos de vida, como documentado anteriormente, e a Microsoft prolongou este suporte até 30 de Junho de 2004.

Os utilizadores que tenham estas versões do sistema operativo deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os sues sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o [Web site do Ciclo de Vida do Suporte da Microsoft](http://support.microsoft.com/lifecycle/). Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o [Web site de Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisem de suporte adicional para o Windows NT Workstation 4.0 SP6a terão de contactar os seus representantes de equipa de contas Microsoft, o respectivo Gestor Técnico de Contas, ou o parceiro ou representante adequado da Microsoft, para mais informações sobre opções de suporte personalizadas. Os clientes que não disponham de um Contrato Alliance, Premier ou Autorizado podem contactar a subsidiária local da Microsoft. Para obter informações de contacto, visite o [Web site Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), seleccione o país e, em seguida, clique em **Go** para ver uma lista de números de telefones. Quando telefonar, peça para falar com o Gestor de Vendas de Suporte Premier local.

Para mais informações, consulte a secção de [Perguntas mais frequentes do Sistema Operativo Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Em que medida a extensão de suporte para o Windows 98, Windows 98 Second Edition e Windows Millennium Edition afecta a publicação de actualizações de segurança para estes sistemas operativos?**
A Microsoft vai publicar actualizações de segurança apenas para problemas de segurança críticos. As questões de segurança não críticas não são abrangidas durante este período de suporte. Para obter mais informações sobre as políticas relativas ao Ciclo de Vida do Suporte da Microsoft para estes sistemas operativos, visite o seguinte [Web site](http://support.microsoft.com/default.aspx?pr=lifean1).

Para mais informações sobre classificações de gravidade, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=21140).

**Os sistemas operativos Windows 98, Windows 98 Second Edition ou Windows Millennium Edition são afectados criticamente por alguma das vulnerabilidades abordadas neste boletim de segurança?**
Não. Nenhuma destas vulnerabilidades é considerada crítica em termos de gravidade no Windows 98, Windows 98 Second Edition ou no Windows Millennium Edition.

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**
Sim. O MBSA permite determinar se esta actualização é necessária. Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

**Nota** A partir de 20 de Abril de 2004, o ficheiro Mssecure.xml que é utilizado pelo MBSA 1.1.1 e versões anteriores deixou de ser actualizado com novos dados de boletins de segurança. Por conseguinte, as análises efectuadas após essa data com o MBSA 1.1.1 ou versão anterior serão incompletas. Todos os utilizadores deverão fazer a actualização para o MBSA 1.2, pois esta versão fornece uma detecção de actualizações de segurança mais precisa e suporta produtos adicionais. Os utilizadores podem transferir o MBSA 1.2 a partir do [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para mais informações sobre o suporte do MBSA, visite o [Web site Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)[1.2 Q&A](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)</a>.

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
Sim. O SMS pode ajudar a detectar e implementar esta actualização de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade do Sistema de Gestão de Janelas - CAN-2004-0207:

Existe uma vulnerabilidade de [elevação de privilégios](http://go.microsoft.com/fwlink/?linkid=21142) nas interfaces de programação da aplicação (APIs) do Sistema de Gestão de Janelas. Esta vulnerabilidade poderia permitir a um intruso com sessão iniciada obter controlo total sobre o sistema.

#### Factores Atenuantes para a Vulnerabilidade do Sistema de Gestão de Janelas - CAN-2004-0207:

Um intruso tem que ter credenciais de início de sessão válidas e conseguir iniciar a sessão localmente para explorar esta vulnerabilidade. A vulnerabilidade não poderia ser explorada remotamente ou por utilizadores anónimos.

#### Soluções para a Vulnerabilidade do Sistema de Gestão de Janelas - CAN-2004-0207:

Nenhum.

#### Perguntas mais frequentes sobre a Vulnerabilidade do Sistema de Gestão de Janelas - CAN-2004-0207:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de [elevação local de privilégios](http://go.microsoft.com/fwlink/?linkid=21142). Um intruso que conseguisse tirar partido desta vulnerabilidade poderia assumir o controlo total de um sistema afectado, incluindo instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**O que provoca a vulnerabilidade?**
Várias funções API do Sistema de Gestão de Janelas permitem aos programas a possibilidade de alterar as propriedades de outros programas que estão a ser executados com um nível mais elevado de privilégios. Os programas devem estar limitados na capacidade de alterar as propriedades de outros programas que estão a ser executados ao mesmo nível de privilégios. As propriedades do programa que está a ser executado ao mesmo nível de privilégio poderiam ser alteradas de forma a que a alteração pudesse provocar uma elevação do privilégio para um utilizador com a sessão iniciada localmente.

**Quais são as funções da interface de programação da aplicação do Sistema de Gestão de Janelas?**
A interface gráfica de utilizador (GUI) do Windows permite ao programas alterar várias propriedades que definem esse programa, tal como o tamanho das janelas ou o nome do programa. As funções API do Sistema de Gestão de Janelas são os componentes do sistema operativo que os programas utilizam para alterar essas propriedades. Para mais informações sobre os componentes que são utilizados para criar programas do Windows, visite o [site da Web MSDN](http://msdn2.microsoft.com/en-us/library/ms632587.aspx).

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que tirasse partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Quem poderia explorar a vulnerabilidade?**
Para explorar a vulnerabilidade, um intruso teria que conseguir iniciar sessão num sistema e executar um programa.

**Como poderia um intruso explorar a vulnerabilidade?**
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia então executar um programa especificamente concebido para o efeito, que poderia tentar explorar a vulnerabilidade e obter assim controlo total sobre o sistema afectado.

**Quais são os sistemas mais susceptíveis face a esta vulnerabilidade?**
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores só estão em risco se os utilizadores sem credenciais de administração suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.

**Os sistemas operativos Windows 98, Windows 98 Second Edition ou Windows Millennium Edition são afectados criticamente por esta vulnerabilidade?**
Não. Embora o Windows 98, Windows 98 Second Edition e o Windows Millennium Edition incluam o componente afectado, a vulnerabilidade não é crítica. Para obter mais informações sobre classificações de gravidade, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=21140).

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Não. O intruso tem de poder iniciar sessão no sistema específico que pretende atacar. Um intruso não pode carregar e executar um programa remotamente através desta vulnerabilidade.

**O que faz a actualização?**
A actualização remove a vulnerabilidade, impedindo que os programas alterem as propriedades de outros programas que estão a ser executados a um nível diferente de privilégios.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável. A Microsoft ainda não tinha recebido informações que indicassem que esta vulnerabilidade tivesse sido divulgada publicamente quando este boletim de segurança foi publicado pela primeira vez.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e ainda não tinha visto exemplos publicados de código para prova de conceito quando este boletim de segurança foi publicado pela primeira vez

#### Vulnerabilidade do Virtual DOS Machine - CAN-2004-0208:

Existe uma vulnerabilidade de [elevação local de privilégios](http://go.microsoft.com/fwlink/?linkid=21142) no componente do sistema operativo que processa o subsistema Virtual DOS Machine (VDM). Esta vulnerabilidade poderia permitir a um intruso com sessão iniciada obter controlo total sobre o sistema.

#### Factores Atenuantes para a Vulnerabilidade do Virtual DOS Machine - CAN-2004-0208:

-   Um intruso tem que ter credenciais de início de sessão válidas e conseguir iniciar a sessão localmente para explorar esta vulnerabilidade. A vulnerabilidade não poderia ser explorada remotamente ou por utilizadores anónimos.
-   O Windows XP Service Pack 2 não é afectado por esta vulnerabilidade.

#### Soluções para a Vulnerabilidade do Virtual DOS Machine - CAN-2004-0208:

Nenhum.

#### Perguntas mais frequentes sobre a Vulnerabilidade do Virtual DOS Machine - CAN-2004-0208:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de [elevação de privilégios](http://go.microsoft.com/fwlink/?linkid=21142). Um intruso que conseguisse tirar partido desta vulnerabilidade poderia assumir o controlo total de um sistema afectado, incluindo instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Para explorar a vulnerabilidade, um intruso teria que conseguir iniciar sessão no sistema e executar um programa.

**O que provoca a vulnerabilidade?**
O componente do sistema operativo que processa o subsistema Virtual DOS Machine (VDM) poderia ser utilizado para obter acesso a uma zona da memória kernel protegida. Em determinadas circunstâncias, algumas funções privilegiadas do sistema operativo poderão não validar estruturas do sistema e permitir que um intruso execute código especialmente concebido com privilégios de sistema.

**O que é o subsistema Virtual DOS Machine?**
O Virtual DOS Machine (VDM) é um ambiente que emula o sistema operativo MS-DOS e o sistema operativo Windows baseado em MS-DOS, em sistemas operativos baseados no Windows NT. Um VDM é criado sempre que um utilizador inicia uma aplicação de MS-DOS num sistema operativo baseado no Windows NT.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que conseguisse tirar partido desta vulnerabilidade poderia assumir o controlo total de um sistema afectado, incluindo instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**Quem poderia explorar a vulnerabilidade?**
Para explorar a vulnerabilidade, um intruso teria que conseguir iniciar sessão num sistema e executar um programa.

**Como poderia um intruso explorar esta vulnerabilidade?**
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia então executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter assim controlo total sobre o sistema afectado.

**Quais são os sistemas mais susceptíveis face a esta vulnerabilidade?**
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores só estão em risco se os utilizadores sem credenciais de administração suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Não. O intruso tem que poder iniciar sessão no sistema específico que pretende atacar. Um intruso não pode carregar e executar um programa remotamente através desta vulnerabilidade.

**O que faz a actualização?**
Esta actualização modifica a forma como o Windows valida os dados que se referem a zonas de memória atribuída ao VDM.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

**Como é que esta vulnerabilidade se encontra relacionada com a vulnerabilidade do Virtual DOS Machine corrigida na actualização MS04-011?**
Ambas as vulnerabilidades encontravam-se no Virtual DOS Machine. Contudo, esta actualização corrige uma nova vulnerabilidade que não foi corrigida no MS04-011. O MS04-011 ajuda a proteger contra a vulnerabilidade discutida nesse boletim, mas não corrige esta nova vulnerabilidade. Esta actualização não substitui a referida no boletim MS04-011. Terá de instalar esta actualização e a actualização fornecida no boletim de segurança MS04-011 para ajudar a proteger o seu sistema contra ambas as vulnerabilidades.

#### Vulnerabilidade do Motor de Processamento de Gráficos - CAN-2004-0209:

Verificou-se uma vulnerabilidade de execução remota de código no processamento dos formatos de imagem Metaficheiro do Windows (WMF) e Metaficheiro Avançado (EMF) que pode permitir a execução remota de código num sistema afectado. Quaisquer programas que processem imagens WMF ou EMF nos sistemas afectados podem estar vulneráveis a este ataque. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter o controlo total de um sistema afectado.

#### Factores Atenuantes para a Vulnerabilidade do Motor de Processamento de Gráficos - CAN-2004-0209:

-   Um intruso conseguiria tirar partido da vulnerabilidade se convencesse um utilizador a abrir um ficheiro especialmente concebido para o efeito ou a ver uma pasta contendo a imagem especialmente concebida. Não existe forma de um intruso forçar um utilizador a abrir um ficheiro mal intencionado, excepto potencialmente através da pré-visualização de uma mensagem de correio electrónico.
-   Num cenário de ataque com base na Web, um intruso teria de alojar um Web site contendo uma página Web que fosse utilizada para tirar partido desta vulnerabilidade. Um intruso não conseguiria obrigar os utilizadores a visitarem um Web site mal intencionado. Em vez disso, um intruso teria de persuadi-los a visitar o Web site, normalmente conseguindo que clicassem numa hiperligação que os levasse ao site do intruso.
-   O Windows XP Service Pack 2 não é afectado por esta vulnerabilidade.

#### Soluções para a Vulnerabilidade do Motor de Processamento de Gráficos - CAN-2004-0209:

A Microsoft testou as seguintes soluções alternativas. Apesar de estas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Em seguida identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Se estiver a utilizar o Outlook 2002 ou posterior, ou o Outlook Express 6 SP1 ou posterior, leia as mensagens de correio electrónico em formato de texto simples para o ajudar a proteger-se contra o vector de ataque através de mensagens de correio electrónico em HTML.**

    Os utilizadores do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os utilizadores do Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1, podem activar esta definição e ver mensagens de correio electrónico não assinadas digitalmente, ou não encriptadas, apenas em formato de texto simples.

    As mensagens de correio electrónico assinadas digitalmente ou encriptadas não são afectadas pela definição e poderão ser lidas no respectivo formato original. Para mais informações sobre como activar esta definição no Outlook 2002, consulte o Artigo [307594](http://support.microsoft.com/default.aspx?scid=kb;en-us;307594) da Base de Dados de Conhecimento da Microsoft.

    Para obter mais informações sobre esta definição no Outlook Express 6, consulte o Artigo [291387](http://support.microsoft.com/?kbid=291387) na Base de Dados de Conhecimento da Microsoft.

    **Impacto da solução alternativa:** As mensagens de correio electrónico que são apresentadas em formato de texto simples não contêm imagens, tipos de letra especializados, animação ou outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de pré-visualização e às mensagens abertas.
    -   As imagens são transformadas em anexos para evitar perdas.
        **Nota** Ver manualmente estas imagens poderá permitir a execução remota de código caso esteja a utilizar uma aplicação ou sistema operativo vulnerável.
    -   Dado que a mensagem ainda está em formato RTF ou HTML no arquivo, o modelo do objecto (soluções de código personalizadas) poderá apresentar um comportamento inesperado.

#### Perguntas mais frequentes sobre a Vulnerabilidade do Motor de Processamento de Gráficos - CAN-2004-0209:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de execução remota de código. Um intruso que explore com sucesso esta vulnerabilidade pode controlar totalmente o sistema afectado remotamente, incluindo instalar programas, visualizar, alterar ou eliminar dados, ou criar novas contas com todos os privilégios. Esta vulnerabilidade pode igualmente ser utilizada para tentar efectuar uma elevação local de privilégios ou uma negação de serviço remota.

**O que provoca a vulnerabilidade?**
Uma memória intermédia não verificada na forma como o Motor de Processamento de Gráficos processa os formatos de imagem Metaficheiro do Windows (WMF) e Metaficheiro Avançado (EMF).

**O que são os formatos de imagem Metaficheiro do Windows (WMF) e Metaficheiro Avançado (EMF)?**
Uma imagem WMF é um formato de metaficheiro de 16-bits que pode incluir informações sobre vectores e mapas de bits. Este formato foi optimizado para o sistema operativo Windows. Uma imagem EMF é um formato de 32-bits que pode incluir informações sobre vectores e mapas de bits. Este formato representa uma melhoria em relação ao formato Metaficheiro do Windows e inclui funcionalidades expandidas.

Para mais informações sobre tipos e formatos de imagem, consulte o Artigo [320314](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314) da Base de Dados de Conhecimento da Microsoft. Estão disponíveis informações adicionais sobre estes formatos de ficheiros no [Web site do MSDN Library](http://msdn2.microsoft.com/en-us/library/ms534574.aspx).

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que conseguisse tirar partido desta vulnerabilidade poderia assumir o controlo total de um sistema afectado, incluindo instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**Como poderia um intruso explorar esta vulnerabilidade?**
Qualquer programa que processe os tipos de imagem afectados pode estar vulnerável a este ataque. Eis alguns exemplos:

-   Um intruso poderia alojar um Web site mal intencionado concebido para tirar partido desta vulnerabilidade através do Internet Explorer, persuadindo depois um utilizador a ver o Web site em questão.
-   Um intruso poderia criar uma mensagem de correio electrónico em HTML com uma imagem especialmente concebida para o efeito em anexo. A imagem especialmente concebida para o efeito poderia ser concebida para tirar partido desta vulnerabilidade através do Microsoft Outlook ou do Outlook Express 6. Um intruso poderia persuadir o utilizador a visualizar a mensagem de correio electrónico em HTML.
-   Um intruso poderia incorporar uma imagem especialmente concebida para o efeito num documento do Office, persuadindo depois o utilizador a ver o documento.
-   Um intruso poderia adicionar uma imagem especialmente concebida para o efeito ao sistema de ficheiros local ou a uma partilha de rede, persuadindo depois o utilizador a pré-visualizar a pasta.
-   Um intruso poderia iniciar localmente a sessão no sistema. Um intruso poderia então executar um programa especialmente concebido para explorar a vulnerabilidade e obter assim controlo total sobre o sistema afectado.

Um intruso poderia também aceder ao componente afectado através de outro vector. Por exemplo, um intruso poderia iniciar sessão no sistema interactivamente ou utilizando outro programa que transmitisse parâmetros ao componente vulnerável (local ou remotamente). Para explorar localmente esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia então executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter assim controlo total sobre o sistema afectado.

**Quais são os sistemas mais susceptíveis face a esta vulnerabilidade?**
Um intruso conseguirá tirar partido da vulnerabilidade nos sistemas afectados se conseguir persuadir um utilizador a abrir um ficheiro especialmente concebido para o efeito ou a ver uma pasta que contenha a imagem especialmente concebida. Não existe forma de um intruso forçar um utilizador a abrir um ficheiro especialmente concebido para o efeito, excepto potencialmente através da pré-visualização de uma mensagem de correio electrónico.

Num cenário de ataque com base na Web, um intruso teria de alojar um Web site contendo uma página Web que fosse utilizada para tirar partido desta vulnerabilidade. Um intruso não conseguiria obrigar os utilizadores a visitarem um Web site mal intencionado. Em vez disso, um intruso teria de persuadi-los a visitar o Web site, normalmente conseguindo que clicassem numa hiperligação que os levasse ao site do intruso.

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Sim. Um intruso pode tentar explorar esta vulnerabilidade através da Internet.

**O que faz a actualização?**
A actualização remove a vulnerabilidade modificando a forma como o Motor de Processamento de Gráficos processa os formatos de imagem Metaficheiro do Windows (WMF) e Metaficheiro Avançado (EMF).

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável. A Microsoft ainda não tinha recebido informações que indicassem que esta vulnerabilidade tivesse sido divulgada publicamente quando este boletim de segurança foi publicado pela primeira vez.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

**Como é que esta vulnerabilidade se relaciona com a vulnerabilidade do metaficheiro corrigida pelo boletim MS04-011?**
Ambas as vulnerabilidades estão relacionadas com o processamento de formatos de imagem WMF e EMF. Contudo, esta actualização corrige uma nova vulnerabilidade que não foi corrigida no MS04-011. O MS04-011 ajuda a proteger contra a vulnerabilidade discutida nesse boletim, mas não corrige esta nova vulnerabilidade. Esta actualização não substitui a referida no boletim MS04-011. Terá de instalar esta actualização e a actualização fornecida no boletim de segurança MS04-011 para ajudar a proteger o seu sistema contra ambas as vulnerabilidades.

**Como está relacionada esta vulnerabilidade com a vulnerabilidade do processamento JPEG (GDI+) que é corrigida pelo boletim MS04-028?**
O componente afectado desta vulnerabilidade é um componente de origem do sistema operativo e não é redistribuído. O componente afectado na vulnerabilidade do processamento JPEG (GDI+) referido no boletim MS04-028 pôde ser redistribuído por outras aplicações e programas de outras empresas. Instalar esta actualização do sistema operativo ajuda a proteger o seu sistema contra esta vulnerabilidade, para todas as aplicações que possam constituir eventuais vectores de ataque, visando a exploração desta vulnerabilidade. O MS04-028 ajuda a proteger contra a vulnerabilidade que é discutida nesse boletim, mas não corrige esta nova vulnerabilidade. Esta actualização não substitui o MS04-028. Terá de instalar esta actualização e a actualização fornecida no boletim de segurança MS04-028 para ajudar a proteger o seu sistema contra ambas as vulnerabilidades.

#### Vulnerabilidade do Kernel do Windows - CAN-2004-0211:

Existe uma vulnerabilidade local de [negação de serviço](http://go.microsoft.com/fwlink/?linkid=21142) no kernel do Windows. Um intruso poderia executar localmente um programa que poderia fazer com que o sistema afectado deixasse de responder.

#### Factores Atenuantes para a Vulnerabilidade do Kernel do Windows - CAN-2004-0211:

-   A vulnerabilidade não permitiria a um intruso ganhar quaisquer privilégios num sistema afectado. Este problema é estritamente uma negação de serviço.
-   O Windows NT 4.0, o Windows 2000 e o Windows XP não são afectados por esta vulnerabilidade.

#### Soluções para a Vulnerabilidade do Kernel do Windows - CAN-2004-0211:

Nenhum.

#### Perguntas mais frequentes sobre a Vulnerabilidade do Kernel do Windows - CAN-2004-0211:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de "[negação de serviço"](http://go.microsoft.com/fwlink/?linkid=21142). Um intruso que explorasse esta vulnerabilidade poderia fazer com que o sistema afectado deixasse de responder e fosse automaticamente reiniciado. Durante esse período, o servidor não poderia responder a pedidos.

**Nota** Tenha em atenção que a vulnerabilidade de negação de serviço não permite aos intrusos executar código ou aumentar o seu nível de privilégios, mas pode fazer com que o sistema afectado deixe de aceitar pedidos.

**O que provoca a vulnerabilidade?**
O kernel do Windows não reinicia correctamente alguns valores das estruturas de dados da CPU.

**O que é o kernel do Windows?**
O kernel do Windows é o núcleo do sistema operativo. Proporciona serviços a nível do sistema tais como a gestão de dispositivos e gestão de memória, atribui tempo de processador aos processos e gere todo o processamento de erros. Para mais informações sobre o kernel e outras estruturas do sistema operativo, consulte o seguinte [site da Web](http://www.microsoft.com/technet/prodtechnol/winntas/training/ntarchitectoview/ntarc_2.mspx).

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que explorasse esta vulnerabilidade poderia fazer com que o sistema afectado deixasse de responder e fosse automaticamente reiniciado. Durante esse período, o servidor não poderia responder a pedidos.

**Quem poderia explorar a vulnerabilidade?**
Para explorar a vulnerabilidade, um intruso teria que conseguir iniciar sessão num sistema e executar um programa.

**Como poderia um intruso explorar a vulnerabilidade?**
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia executar um programa concebido especialmente para explorar a vulnerabilidade. Isto poderia fazer com que o sistema parasse de responder e, assim, provocar uma condição de negação de serviço.

**Quais são os sistemas mais susceptíveis face a esta vulnerabilidade?**
Os servidores de terminais estão principalmente em risco. Os servidores só estão em risco se os utilizadores sem credenciais de administração suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Não. O intruso tem que poder iniciar sessão no sistema específico que pretende atacar. Um intruso não pode carregar e executar um programa remotamente através desta vulnerabilidade.

**O que faz a actualização?**
A actualização corrige a vulnerabilidade modificando a forma como o kernel do Windows reinicia alguns valores em algumas estruturas de dados da CPU.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável. A Microsoft ainda não tinha recebido informações que indicassem que esta vulnerabilidade tivesse sido divulgada publicamente quando este boletim de segurança foi publicado pela primeira vez.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Plataformas de Instalação e Pré-requisitos:**

Para obter informações sobre a actualização de segurança específica para a sua plataforma, clique na hiperligação adequada:

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**
Esta actualização de segurança requer uma versão comercializada do Windows Server 2003.

**Inclusão em Service Packs Futuros:**
A actualização deste problema será incluída no Windows Server 2003 Service Pack 1.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração:

**/help                 **Apresenta as opções da linha de comandos

**Modos de Configuração**

**/quiet  **            **  **Modo silencioso (sem interacção do utilizador ou apresentação)

**/passive**            Modo automático (barra de progresso apenas)

**      /uninstall**          Desinstala o pacote

**Opções de Reinício**

**/norestart**          Não reinicia o computador quando a instalação é concluída

**/forcerestart**      Reinicia após a instalação

**Opções Especiais**

**/l**                        Lista hotfixes ou pacotes de actualização do Windows instalados

**/o**                       Substitui ficheiros OEM sem aviso

**/n**                       Não fazer cópias de segurança dos ficheiros necessários para desinstalação

**/f**                        Força outros programas a fechar quando o computador é encerrado

**/extract**             Extrai ficheiros sem iniciar o programa de configuração

**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do utilitário de configuração. Para mais informações acerca dos parâmetros de instalação suportados, consulte o Artigo da Base de Dados de Conhecimento da Microsoft acerca dos parâmetros de instalação suportados, consulte o Artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) da Base de Dados de Conhecimento da Microsoft.

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb840987-x86-enu /passive /quiet**

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb840987-x86-enu /norestart**

Para obter informações sobre como implementar esta actualização de segurança com o Software Update Services, visite o [Web site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe suporta os seguintes parâmetros de configuração:

**/?**: Mostrar a lista de parâmetros de instalação.

**/u**: Utilizar o modo automático.

**/f**: Obrigar outros programas a fechar quando o computador é encerrado.

**/z**: Não reiniciar o computador quando a instalação é concluída.

**/q**: Utilizar o Modo silencioso (sem interacção do utilizador).

**Informações de Ficheiros**

A versão inglesa desta actualização contém os atributos de ficheiro listados na tabela abaixo (ou posteriores). As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows Server 2003 Enterprise Edition, Windows Server 2003 Standard Edition, Windows Server 2003 Web Edition e Windows Server 2003 Datacenter Edition:

`Data         Hora   Versão       Tamanho       Nome fich.     Pasta-------------------------------------------------------------------------27-Mai-2004  00:33  5.2.3790.175  2,405,888  Ntkrnlmp.exe  RTMGDR26-Mai-2004  23:51  5.2.3790.175  2,063,360  Ntkrnlpa.exe  RTMGDR26-Mai-2004  23:51  5.2.3790.175  2,105,856  Ntkrpamp.exe  RTMGDR27-Mai-2004  00:35  5.2.3790.175  2,206,208  Ntoskrnl.exe  RTMGDR09-Ago-2004  22:48  5.2.3790.198  1,812,992  Win32k.sys    RTMGDR01-Jun-2004  18:06  5.2.3790.177  2,407,424  Ntkrnlmp.exe  RTMQFE01-Jun-2004  17:37  5.2.3790.177  2,064,384  Ntkrnlpa.exe  RTMQFE01-Jun-2004  17:37  5.2.3790.177  2,108,928  Ntkrpamp.exe  RTMQFE01-Jun-2004  18:13  5.2.3790.177  2,207,232  Ntoskrnl.exe  RTMQFE19-Ago-2004  21:53  5.2.3790.202  1,814,528  Win32k.sys    RTMQFE`

Windows Server 2003 64-Bit Enterprise Edition e Windows Server 2003 64-Bit Datacenter Edition:

`Data         Hora   Versão       Tamanho       Nome fich.    Plataforma  Pasta-------------------------------------------------------------------------10-Ago-2004  02:10  5.2.3790.198  4,952,576  Win32k.sys  IA-64     RTMGDR19-Ago-2004  21:44  5.2.3790.202  4,956,672  Win32k.sys  IA-64     RTMQFE`

**Nota** Quando instala esta actualização de segurança no Windows Server 2003 ou no Windows XP 64-Bit Edition Versão 2003, o programa de instalação verifica se algum dos ficheiros que estão a ser actualizados no seu sistema foi alvo de uma actualização anterior através de um hotfix da Microsoft. Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR para o sistema. Para obter mais informações, consulte o Artigo [824994](http://support.microsoft.com/default.aspx?kbid=824994) da Base de Dados de Conhecimento da Microsoft.

**Verificação da Instalação da Actualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança está instalada num sistema afectado poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Esta ferramenta permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.

        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.

    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.

        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a instalação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança, bastando para tal rever as seguintes chaves do registo.

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 840987 aos ficheiros de origem de instalação do Windows.

#### Windows XP (todas as versões)

**Nota** Para o Windows XP 64-Bit Edition Versão 2003 esta actualização de segurança é a mesma que a actualização de segurança para o Windows Server 2003 64-Bit Edition.

**Pré-requisitos**
Esta actualização de segurança requer a versão de lançamento do Windows XP ou Windows XP Service Pack 1 (SP1). Para obter mais informações, consulte o Artigo [322389](http://support.microsoft.com/default.aspx?scid=kb;en-us;322389) da Base de Dados de Conhecimento da Microsoft.

**Inclusão em Service Packs Futuros:**
A actualização para esta questão está incluída no Windows XP Service Pack 2.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração:

**/help                 **Apresenta as opções da linha de comandos

**Modos de Configuração**

**/quiet  **            **  **Modo silencioso (sem interacção do utilizador ou apresentação)

**/passive**            Modo automático (barra de progresso apenas)

**      /uninstall**          Desinstala o pacote

**Opções de Reinício**

**/norestart**          Não reinicia o computador quando a instalação é concluída

**/forcerestart**      Reinicia após a instalação

**Opções Especiais**

**/l**                        Lista hotfixes ou pacotes de actualização do Windows instalados

**/o**                       Substitui ficheiros OEM sem aviso

**/n**                       Não fazer cópias de segurança dos ficheiros necessários para desinstalação

**/f**                        Força outros programas a fechar quando o computador é encerrado

**/extract**             Extrai ficheiros sem iniciar o programa de configuração

**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do utilitário de configuração. Para mais informações sobre os parâmetros de instalação suportados, consulte o Artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) da Base de Dados de Conhecimento da Microsoft.

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos do Windows XP:

**Windowsxp-kb840987-x86-enu /passive /quiet**

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows XP:

**Windowsxp-kb840987-x86-enu /norestart**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe suporta os seguintes parâmetros de configuração:

**/?**: Mostrar a lista de parâmetros de instalação.

**/u**: Utilizar o modo automático.

**/f**: Obrigar outros programas a fechar quando o computador é encerrado.

**/z**: Não reiniciar o computador quando a instalação é concluída.

**/q**: Utilizar o Modo silencioso (sem interacção do utilizador).

**Informações de Ficheiros**

A versão inglesa desta actualização contém os atributos de ficheiro listados na tabela abaixo (ou posteriores). As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows XP Home Edition, Windows XP Professional, Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition e Windows XP Media Center Edition:

`Data         Hora   Versão        Tamanho       Nome fich.     Pasta-------------------------------------------------------------------17-Jun-2004  17:55  5.1.2600.159      48,128  Basesrv.dll   RTMQFE17-Jun-2004  17:55  5.1.2600.151     241,664  Gdi32.dll     RTMQFE17-Jun-2004  17:55  5.1.2600.153     898,048  Kernel32.dll  RTMQFE30-Mar-2004  01:25  5.1.2600.132      36,864  Mf3216.dll    RTMQFE17-Jun-2004  17:00  5.1.2600.160   1,849,856  Ntkrnlmp.exe  RTMQFE17-Jun-2004  17:00  5.1.2600.160   1,903,872  Ntkrnlpa.exe  RTMQFE17-Jun-2004  17:00  5.1.2600.160   1,877,504  Ntkrpamp.exe  RTMQFE17-Jun-2004  17:00  5.1.2600.160   1,881,856  Ntoskrnl.exe  RTMQFE14-Jun-2004  18:27  5.1.2600.157     395,264  Ntvdm.exe     RTMQFE17-Jun-2004  17:55  5.1.2600.153      13,312  Ntvdmd.dll    RTMQFE17-Jun-2004  17:55                 1,055,610  Sysmain.sdb   RTMQFE17-Jun-2004  17:55  5.1.2600.152     528,896  User32.dll    RTMQFE17-Jun-2004  17:55  5.1.2600.153      23,040  Vdmdbg.dll    RTMQFE04-Ago-2004  00:54  5.1.2600.166   1,648,384  Win32k.sys    RTMQFE17-Jun-2004  17:55  5.1.2600.153     272,896  Winsrv.dll    RTMQFE05-Jun-2004  02:21  5.1.2600.156     245,760  Wow32.dll     RTMQFE17-Jun-2004  17:58  5.1.2600.1566     47,616  Basesrv.dll   SP1QFE17-Jun-2004  17:58  5.1.2600.1561    257,536  Gdi32.dll     SP1QFE17-Jun-2004  17:58  5.1.2600.1560    930,816  Kernel32.dll  SP1QFE17-Mai-2004  22:48  3.10.0.103        92,224  Krnl386.exe   SP1QFE30-Mar-2004  01:48  5.1.2600.1331     36,864  Mf3216.dll    SP1QFE17-Mai-2004  22:43                    33,840  Ntio.sys      SP1QFE17-Mai-2004  22:43                    34,560  Ntio404.sys   SP1QFE17-Mai-2004  22:43                    35,648  Ntio411.sys   SP1QFE17-Mai-2004  22:43                    35,424  Ntio412.sys   SP1QFE17-Mai-2004  22:43                    34,560  Ntio804.sys   SP1QFE17-Jun-2004  08:02  5.1.2600.1568  1,899,008  Ntkrnlmp.exe  SP1QFE17-Jun-2004  08:03  5.1.2600.1568  1,954,688  Ntkrnlpa.exe  SP1QFE17-Jun-2004  08:03  5.1.2600.1568  1,926,656  Ntkrpamp.exe  SP1QFE17-Jun-2004  17:22  5.1.2600.1568  2,051,584  Ntoskrnl.exe  SP1QFE12-Jun-2004  01:14  5.1.2600.1564    396,288  Ntvdm.exe     SP1QFE17-Jun-2004  17:58  5.1.2600.1560     13,312  Ntvdmd.dll    SP1QFE17-Jun-2004  17:58  5.1.2600.1561    560,128  User32.dll    SP1QFE17-Jun-2004  17:58  5.1.2600.1560     23,040  Vdmdbg.dll    SP1QFE05-Ago-2004  18:15  5.1.2600.1581  1,845,888  Win32k.sys    SP1QFE27-Mai-2004  01:38  5.1.2600.1557    483,328  Winlogon.exe  SP1QFE17-Jun-2004  17:58  5.1.2600.1561    276,992  Winsrv.dll    SP1QFE04-Jun-2004  00:43  5.1.2600.1562    245,760  Wow32.dll     SP1QFE`

Windows XP 64-Bit Edition Service Pack 1:

`Data         Hora   Versão        Tamanho       Nome fich.    Plataforma  Pasta--------------------------------------------------------------------------------17-Jun-2004  18:05  5.1.2600.1556    885,248  Gdi32.dll    IA-64     SP1QFE30-Mar-2004  01:45  5.1.2600.1331    128,512  Mf3216.dll   IA-64     SP1QFE17-Jun-2004  18:05  5.1.2600.1557  1,483,264  User32.dll   IA-64     SP1QFE17-Jun-2004  00:45  5.1.2600.1567  5,627,520  Win32k.sys   IA-64     SP1QFE05-Ago-2004  17:27  5.1.2600.1581  5,629,952  Win32k.sys   IA-64     SP1QFE17-Jun-2004  17:58  5.1.2600.1561    237,568  Wgdi32.dll   x86       SP1QFE\WOW30-Mar-2004  01:48  5.1.2600.1331     36,864  Wmf3216.dll  x86       SP1QFE\WOW17-Jun-2004  17:58  5.1.2600.1561    556,544  Wuser32.dll  x86       SP1QFE\WOW`

Windows XP 64-Bit Edition Versão 2003:

`Data         Hora   Versão       Tamanho       Nome fich.    Plataforma  Pasta-------------------------------------------------------------------------10-Ago-2004  02:10  5.2.3790.198  4,952,576  Win32k.sys  IA-64     RTMGDR19-Ago-2004  21:44  5.2.3790.202  4,956,672  Win32k.sys  IA-64     RTMQFE`

**Notas** As versões do Windows XP e Windows XP 64-Bit Edition Versão 2003 desta actualização de segurança são fornecidas como pacotes com duplo modo, que contêm ficheiros para a versão original do Windows XP e Windows XP Service Pack 1 (SP1). Para mais informações sobre pacotes de modo duplo, consulte o Artigo [328848](http://support.microsoft.com/default.aspx?kbid=328848) da Base de Dados de Conhecimento da Microsoft.

Quando instala a actualização de segurança do Windows XP 64-Bit Edition Versão 2003, o programa de instalação verifica se qualquer um dos ficheiros que estão a ser actualizados no sistema foi alvo de uma actualização anterior através de um hotfix da Microsoft. Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR para o sistema. Para obter mais informações, consulte o Artigo [824994](http://support.microsoft.com/default.aspx?kbid=824994) da Base de Dados de Conhecimento da Microsoft.

**Verificação da Instalação da Actualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança está instalada num sistema afectado poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Esta ferramenta permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.

        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.

    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.

        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a instalação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança, bastando para tal rever as seguintes chaves do registo.

    Para o Windows XP Home Edition, Windows XP Professional, Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP 64-Bit Edition Service Pack 1, Windows XP Tablet PC Edition e Windows XP Media Center Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB840987\\Filelist

    Para o Windows XP 64-Bit Edition versão 2003:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **Nota** Estas chaves de registo poderão não conter uma lista completa dos ficheiros instalados. Além disso, estas chaves de registo poderão não ser criadas correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 840987 aos ficheiros de origem de instalação do Windows.

#### Windows 2000 (todas as versões)

**Pré-requisitos**
Para o Windows 2000, esta actualização de segurança requer o Service Pack 3 (SP3) ou o Service Pack 4 (SP4).

O software listado foi testado de forma a determinar se as versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o Web site do Ciclo de Vida do Suporte Microsoft.

Para mais informações sobre como obter o Service Pack mais recente consulte o Artigo [260910](http://support.microsoft.com/default.aspx?scid=kb;en-us;260910) da Base de Dados de Conhecimento da Microsoft.

**Inclusão em Service Packs Futuros:**
A actualização para este problema será incluída no Windows 2000 Service Pack 5.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração:

**/help                 **Apresenta as opções da linha de comandos

**Modos de Configuração**

**/quiet  **            **  **Modo silencioso (sem interacção do utilizador ou apresentação)

**/passive**            Modo automático (barra de progresso apenas)

**      /uninstall**          Desinstala o pacote

**Opções de Reinício**

**/norestart**          Não reinicia o computador quando a instalação é concluída

**/forcerestart**      Reinicia após a instalação

**Opções Especiais**

**/l**                        Lista hotfixes ou pacotes de actualização do Windows instalados

**/o**                       Substitui ficheiros OEM sem aviso

**/n**                       Não fazer cópias de segurança dos ficheiros necessários para desinstalação

**/f**                        Força outros programas a fechar quando o computador é encerrado

**/extract**             Extrai ficheiros sem iniciar o programa de configuração

**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do utilitário de configuração. Para mais informações sobre os parâmetros de instalação suportados, consulte o Artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) da Base de Dados de Conhecimento da Microsoft.

**Informações de Implementação**

Para instalar a actualização de segurança sem intervenção do utilizador, utilize o comando seguinte na linha de comandos no Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

**Windows2000-kb840987-x86-enu /passive /quiet**

Para instalar a actualização de segurança sem forçar o reinício do sistema, utilize o comando seguinte na linha de comandos para o Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

**Windows2000-kb840987-x86-enu /norestart**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe suporta os seguintes parâmetros de configuração:

**/?**: Mostrar a lista de parâmetros de instalação.

**/u**: Utilizar o modo automático.

**/f**: Obrigar outros programas a fechar quando o computador é encerrado.

**/z**: Não reiniciar o computador quando a instalação é concluída.

**/q**: Utilizar o Modo silencioso (sem interacção do utilizador).

**Informações de Ficheiros**

A versão inglesa desta actualização contém os atributos de ficheiro listados na tabela abaixo (ou posteriores). As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

**Nota** As informações sobre a data, hora nome de ficheiro ou tamanho podem ser alteradas durante a instalação. Consulte a secção Verificar a Instalação da Actualização para obter detalhes sobre como verificar uma instalação.

Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

`Data         Hora   Versão         Tamanho      Nome fich.       Pasta---------------------------------------------------------------------17-Jun-2004  23:05  5.0.2195.6951     46,352  Basesrv.dll21-Set-2003  00:45  5.0.2195.6824    236,304  Cmd.exe17-Jun-2004  23:05  5.0.2195.6945    231,184  Gdi32.dll17-Jun-2004  23:05  5.0.2195.6946    712,464  Kernel32.dll19-Jun-2003  20:05  3.10.0.103        92,032  Krnl386.exe17-Jun-2004  23:05  5.0.2195.6898     37,136  Mf3216.dll10-Fev-2004  19:47  5.0.2195.6897     30,160  Mountmgr.sys17-Jun-2004  23:05  5.0.2195.6824     54,544  Mpr.dll17-Jun-2004  23:05  5.0.2195.6928    335,120  Msgina.dll19-Jun-2003  20:05                    33,824  Ntio.sys19-Jun-2003  20:05                    34,544  Ntio404.sys19-Jun-2003  20:05                    35,648  Ntio411.sys19-Jun-2003  20:05                    35,408  Ntio412.sys19-Jun-2003  20:05                    34,544  Ntio804.sys17-Jun-2004  17:15  5.0.2195.6952  1,704,128  Ntkrnlmp.exe17-Jun-2004  17:15  5.0.2195.6952  1,703,744  Ntkrnlpa.exe17-Jun-2004  17:15  5.0.2195.6952  1,725,440  Ntkrpamp.exe17-Jun-2004  17:14  5.0.2195.6952  1,680,960  Ntoskrnl.exe27-Mai-2004  00:54  5.0.2195.6946    398,096  Ntvdm.exe17-Jun-2004  23:05  5.0.2195.6946     14,096  Ntvdmd.dll24-Mar-2004  02:17  5.0.2195.6892     90,264  Rdpwd.sys16-Mai-2004  19:43  5.0.2195.6928  5,873,664  Sp3res.dll24-Mar-2004  02:17  5.0.2195.6897    403,216  User32.dll05-Ago-2003  22:14  5.0.2195.6794    385,808  Userenv.dll17-Jun-2004  23:05  5.0.2195.6946     29,456  Vdmdbg.dll10-Ago-2004  03:51  5.0.2195.6966  1,632,624  Win32k.sys24-Ago-2004  22:59  5.0.2195.6970    182,544  Winlogon.exe17-Jun-2004  23:05  5.0.2195.6946    244,496  Winsrv.dll17-Jun-2004  23:05  5.0.2195.6946    239,888  Wow32.dll17-Jun-2004  23:05  5.0.2195.6946    712,464  Kernel32.dll  Uniproc10-Ago-2004  03:51  5.0.2195.6966  1,632,624  Win32k.sys    Uniproc17-Jun-2004  23:05  5.0.2195.6946    244,496  Winsrv.dll    Uniproc`

**Verificação da Instalação da Actualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança está instalada num sistema afectado poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Esta ferramenta permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.

        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.

    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.

        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a instalação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB840987\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente quando um administrador ou um OEM integrar ou associar a actualização de segurança 840987 aos ficheiros de origem de instalação do Windows.

#### Windows NT 4.0 (todas as versões)

**Pré-requisitos**
Esta actualização de segurança requer o Windows NT Server 4.0 Service Pack 6a (SP6a) ou Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6).

**Nota:** O Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) da Base de Dados de Conhecimento da Microsoft documenta os problemas actualmente conhecidos que os clientes poderão verificar em sistemas com Windows NT 4.0 Server e Windows NT 4.0 Terminal Server Edition. Se instalar actualizações de software num computador baseado no Windows NT 4.0 que possua uma partição de sistema superior a 7,8 GB, o computador poderá não reiniciar correctamente. O artigo também documenta soluções recomendadas para estas questões. Para mais informações, consulte o Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) da Base de Dados de Conhecimento da Microsoft.

O software listado foi testado de forma a determinar se as versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida de suporte relativamente ao seu produto e versão, visite o [Web site do Ciclo de Vida de Suporte da Microsoft](http://support.microsoft.com/lifecycle/).

Para mais informações sobre como obter o Service Pack mais recente, consulte o Artigo [152734](http://support.microsoft.com/default.aspx?scid=kb;en-us;152734) da Base de Dados de Conhecimento da Microsoft.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração:

**   /y:** Executar a remoção (apenas com **/m** ou **/q** )

**   /f:** Impor o fecho de programas durante o processo de encerramento

**   /n:** Não criar uma pasta Uninstall

**   /z:** Não reiniciar quando a actualização for concluída

**   /q:** Utilizar o modo Silencioso ou Automático sem interface do utilizador (este parâmetro inclui o parâmetro **/m** )

**   /m:** Utilizar o Modo automático com uma interface de utilizador

**   /l:** Listar os hotfixes instalados

**   /x:** Extrair os ficheiros sem executar o programa de configuração

**Nota** É possível combinar estes parâmetros no mesmo comando. Para mais informações sobre os parâmetros de instalação suportados, consulte o Artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) da Base de Dados de Conhecimento da Microsoft.

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção do utilizador, utilize o seguinte comando na linha de comandos do Windows NT Server 4.0:

**Windowsnt4server-kb840987-x86-enu /q**

Para o Windows NT Server 4.0 Terminal Server Edition:

**Windowsnt4terminalserver-kb840987-x86-enu /q**

Para instalar a actualização de segurança sem forçar o sistema a reiniciar, utilize o seguinte comando na linha de comandos do Windows NT Server 4.0:

**Windowsnt4server-kb840987-x86-enu /z**

Para o Windows NT Server 4.0 Terminal Server Edition:

**Windowsnt4terminalserver-kb840987-x86-enu /z**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar/Remover Programas no Painel de Controlo.

Os administradores do sistema podem também utilizar o utilitário Hotfix.exe para remover esta actualização de segurança. O utilitário Hotfix.exe encontra-se na pasta %Windir%\\$NTUninstallKB840987$. O utilitário Hotfix.exe suporta os seguintes parâmetros de configuração:

**/y:** Executar a remoção (apenas com o parâmetro **/m** ou **/q**)

**/f:** Impor o fecho de programas durante o processo de encerramento

**/n:** Não criar uma pasta Uninstall

**/z:** Não reiniciar quando a instalação for concluída

**/q:** Utilizar o modo Silencioso ou Automático sem interface do utilizador (este parâmetro inclui o parâmetro **/m**)

**/m:** Utilizar o Modo automático com uma interface de utilizador

**/l:** Listar os hotfixes instalados

**Informações de Ficheiros**

A versão inglesa desta actualização contém os atributos de ficheiro listados na tabela abaixo (ou posteriores). As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

**Nota** As informações sobre a data, hora nome de ficheiro ou tamanho podem ser alteradas durante a instalação. Consulte a secção Verificar a Instalação da Actualização para obter detalhes sobre como verificar uma instalação.

Windows NT Server 4.0:

`Data         Hora   Versão        Tamanho       Nome fich.----------------------------------------------------------08-Jun-2004  14:19  4.0.1381.7270    206,096  Gdi32.dll23-Fev-2004  15:13  4.0.1381.7263     40,720  Mf3216.dll22-Abr-2004  17:26  4.0.1381.7267    958,464  Ntkrnlmp.exe22-Abr-2004  17:26  4.0.1381.7267    938,048  Ntoskrnl.exe08-Jun-2004  14:19  4.0.1381.7273    326,928  User32.dll03-Ago-2004  12:31  4.0.1381.7292  1,255,472  Win32k.sys08-Jun-2004  14:19  4.0.1381.7260    174,864  Winsrv.dll`

Windows NT Server 4.0 Terminal Server Edition:

`Data         Hora   Versão         Tamanho       Nome fich.-------------------------------------------------------20-Mai-2004  18:23  4.0.1381.33566    206,096  Gdi32.dll24-Fev-2004  18:25  4.0.1381.33562     40,208  Mf3216.dll21-Mai-2004  16:41  4.0.1381.33568  1,004,160  Ntkrnlmp.exe21-Mai-2004  16:41  4.0.1381.33568    983,104  Ntoskrnl.exe20-Mai-2004  18:23  4.0.1381.33552    332,048  User32.dll03-Ago-2004  12:41  4.0.1381.33580  1,280,944  Win32k.sys20-Mai-2004  18:23  4.0.1381.33559    196,368  Winsrv.dll`

**Verificação da Instalação da Actualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança está instalada num sistema afectado poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Esta ferramenta permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.

        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.

    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.

        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a instalação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB840987\\File 1

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente quando um administrador ou um OEM integrar ou associar a actualização de segurança 840987 aos ficheiros de origem de instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Brett Moore da [Security-Assessment.com](http://www.security-assessment.com/) por fornecer informações sobre o problema da Vulnerabilidade do Sistema de Gestão de Janelas (CAN-2004-0201).
-   [eEye Digital Security](http://www.eeye.com/html/) por fornecer informações sobre o problema da Vulnerabilidade do Virtual DOS Machine (CAN-2004-0208)
-   [Patrick Porlan](https://technet.microsoft.com/pt-PT/mailto://porlan@free.fr) em conjunto com Mark Russinovich da [Winternals Software](http://www.winternals.com) por fornecer informações sobre a Vulnerabilidade do Motor de Processamento de Gráficos (CAN-2004-0209).
-   [hlt](https://technet.microsoft.com/pt-PT/mailto://hlt@dgap.mipt.ru) por fornecer informações sobre a Vulnerabilidade do Kernel do Windows (CAN-2004-0211).

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outros problemas de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do Web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web Site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update consulte o Artigo [323166](http://support.microsoft.com/default.aspx?scid=kb;en-us;323166) da Base de Dados de Conhecimento da Microsoft.
-   [Office Update](http://office.microsoft.com/pt-pt/downloads/default.aspx)

**Software Update Services:**

Utilizando os Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, consulte o [Web site SMS 2003 Security Patch Management](http://www.microsoft.com/smserver/evaluation/capabilities/patch.mspx). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://www.microsoft.com/smserver/downloads/20/featurepacks/suspack/) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer e Microsoft Office Detection Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, consulte o seguinte [Web site](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [**SMS 2003 Administration Feature Pack**](http://www.microsoft.com/technet/sms/2003/downloads/featurepacks/adminpack.mspx) e no [**SMS 2.0 Administration Feature Pack**](http://www.microsoft.com/smserver/downloads/20/featurepacks/adminpack/)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (12 de Outubro de 2004): Boletim publicado
-   V1.1 (9 de Dezembro de 2008): Boletim actualizado para adicionar uma entrada na secção de **Perguntas Mais Frequentes relativas a esta actualização de segurança**, sobre a remoção do pacote Windows Server 2003. Os clientes que já tenham aplicado esta actualização com sucesso não necessitam de efectuar qualquer acção.

*Built at 2014-04-18T01:50:00Z-07:00*
