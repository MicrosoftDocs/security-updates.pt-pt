---
TOCTitle: 'MS09-012'
Title: 'Microsoft Security Bulletin MS09-012 - Importante'
ms:assetid: 'ms09-012'
ms:contentKeyID: 61234731
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms09-012(v=Security.10)'
author: SharonSears
ms.author: SharonSears
---

Security Bulletin

Microsoft Security Bulletin MS09-012 - Importante
=================================================

Vulnerabilidades no Windows poderiam permitir Elevação de Privilégios (959454)
------------------------------------------------------------------------------

Data de publicação: 14 de abril de 2009 | Updated: 29 de abril de 2009

**actualizada:** 2.0

### Informações Gerais

#### Resumo Executivo

Esta actualização de segurança resolve quatro vulnerabilidades do Microsoft Windows divulgadas publicamente. As vulnerabilidades poderiam permitir elevação de privilégios se um intruso iniciasse sessão no sistema e executasse uma aplicação especialmente concebida para o efeito. O intruso teria de conseguir executar código no computador local para explorar esta vulnerabilidade. Um intruso que conseguisse tirar partido de qualquer uma destas vulnerabilidades poderia obter o controlo total sobre o sistema afectado.

Esta actualização de segurança está classificada como Importante para todas as edições suportadas do Windows 2000, Windows XP, Windows Server 2003, Windows Vista e Windows Server 2008. Para mais informações, consulte a subsecção **Software Afectado e Software Não Afectado**, nesta secção.

A actualização de segurança resolve as vulnerabilidades ao corrigir a forma como o Microsoft Windows resolve tokens solicitados pelo Coordenador de Transacções Distribuídas da Microsoft (MSDTC) e ao isolar de forma apropriada os fornecedores de WMI e os processos executados no contexto das contas NetworkService ou LocalService. Para mais informações sobre as vulnerabilidades, consulte a subsecção de Perguntas Mais Frequentes quanto à vulnerabilidade específica na secção seguinte, **Informações sobre as vulnerabilidades**.

Esta actualização de segurança também resolve a vulnerabilidade descrita previamente no [Aviso de Segurança da Microsoft 951306](http://technet.microsoft.com/security/advisory/951306).

**Recomendação.** A maioria dos clientes tem a actualização automática activada e não necessitará de efectuar qualquer acção, porque esta actualização de segurança será transferida e instalada automaticamente. Os clientes que não tenham a actualização automática activada necessitam de verificar as actualizações e instalar esta actualização manualmente. Para informações sobre opções específicas de configuração da actualização automática, consulte o [Artigo 294871 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/294871).

Para administradores e instalações empresariais, ou utilizadores finais que pretendam instalar esta actualização de segurança manualmente, a Microsoft recomenda que os clientes apliquem a actualização na primeira oportunidade, utilizando software de gestão de actualizações ou verificando as actualizações através do serviço [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

Consulte também a secção **Orientações e Ferramentas de Detecção e Implementação**, mais à frente neste boletim.

**Questões conhecidas.** O [Artigo 959454 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/959454) documenta as questões actualmente conhecidas que os clientes podem verificar quando instalam esta actualização de segurança. O artigo também documenta soluções recomendadas para estas questões.

#### Software Afectado e Software Não Afectado

O software que se segue foi testado para determinar quais as versões ou edições afectadas. As outras versões ou edições são antigas, ultrapassaram o respectivo ciclo de vida de suporte ou não são afectadas. Para determinar o ciclo de vida de suporte da versão ou edição do seu software, visite o [Web site do Ciclo de Vida de Suporte Microsoft](http://support.microsoft.com/lifecycle/).

**Software Afectado**

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" >Actualização da Funcionalidade de Transacções MSDTC</th>
<th style="border:1px solid black;" >Actualização do Isolamento de Serviços Windows</th>
<th style="border:1px solid black;" >Impacto de Segurança Máximo</th>
<th style="border:1px solid black;" >Classificação de Gravidade Agregada</th>
<th style="border:1px solid black;" >Boletins substituídos por esta actualização</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=52b756e7-636f-4d9e-8a17-dbf467bfbe4d">Microsoft Windows 2000 Service Pack 4</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=90fe715e-8190-43e9-9c43-df5be564d923">Windows XP Service Pack 2 e Windows XP Service Pack 3</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte as linhas abaixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=73d2324f-be59-4b0c-b1ac-9876a13c2c03">Windows XP Service Pack 2</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=85165">MS07-022</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=104921">MS08-002</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=73d2324f-be59-4b0c-b1ac-9876a13c2c03">Windows XP Service Pack 3</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=a794c32a-9a0c-47d9-9c57-ff5d4a8e4944">Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=b2f12ae5-0e46-47e1-ac5b-93550d030189">Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=104921">MS08-002</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=25adec10-db8c-4cac-bf74-2c784678150a">Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=42aba890-8b76-4c5a-8fb6-609797d19831">Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=85165">MS07-022</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=104921">MS08-002</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a><br />
</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=b014c399-f404-4cb2-8f9d-864df382efeb">Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=a0609f65-82d9-4d82-9f48-f3266e8de123">Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=104921">MS08-002</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=6ada372b-ba17-433e-b022-d2c57b35af8a">Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=fda8837c-e5d2-4489-9b44-4c24a1102e77">Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=104921">MS08-002</a>,<br />
<a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=f111b99a-e555-4f29-8d1f-e9ec03d5cf1f">Windows Vista e Windows Vista Service Pack 1</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=d0ea1598-45cb-4c79-8945-caae98969675">Windows Vista e Windows Vista Service Pack 1</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=fa153bdc-6b48-4df2-9e5e-abacd6da782c">Windows Vista x64 Edition e Windows Vista x64 Edition Service Pack 1</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=6dd82f4b-bb33-41ec-90a7-9ef91329b240">Windows Vista x64 Edition e Windows Vista x64 Edition Service Pack 1</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=9e3c7b52-65a7-42fb-beb5-1b374934737f">Windows Server 2008 para sistemas de 32 bits</a>*<br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=d58702af-bbf8-4f1b-ae72-ced9ef23d581">Windows Server 2008 para sistemas de 32 bits</a>*<br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=eebb4d4d-29d2-4247-8cbb-63a3b17585ec">Windows Server 2008 para sistemas baseados em x64</a>*<br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=20bf4e9b-909b-4bc3-ae43-322d74a4f1c3">Windows Server 2008 para sistemas baseados em x64</a>*<br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=cc383c24-b0f6-47c1-9e89-6a378b09e82f">Windows Server 2008 para sistemas baseados em Itanium</a><br />
(KB952004)</td>
<td style="border:1px solid black;">Consulte a linha em baixo</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;">Nenhum</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Consulte a linha em cima</td>
<td style="border:1px solid black;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=bcc2b18f-67db-4109-a9f4-764f985423ee">Windows Server 2008 para sistemas baseados em Itanium</a><br />
(KB956572)</td>
<td style="border:1px solid black;">Elevação de Privilégios</td>
<td style="border:1px solid black;">Importante</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=128103">MS08-064</a></td>
</tr>
</tbody>
</table>
  
**\*Instalação Server Core do Windows Server 2008 afectada.** Para edições suportadas do Windows Server 2008, esta actualização aplica-se com a mesma classificação de gravidade, quer o Windows Server 2008 tenha ou não sido instalado utilizando a opção de instalação Server Core. Para mais informações sobre esta opção de instalação, consulte a informação sobre [Server Core](http://msdn.microsoft.com/en-us/library/ms723891(vs.85).aspx). Tenha em atenção que a opção de instalação Server Core não se aplica a determinadas edições do Windows Server 2008; consulte [Comparar as Opções de Instalação Server Core](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).
  
Perguntas mais frequentes relativas a esta actualização de segurança  
--------------------------------------------------------------------
  
<span></span>
**Por que razão foi revisto este boletim a 29 de Abril de 2009?**    
A Microsoft reviu este boletim para comunicar o relançamento da actualização do idioma norueguês para o Microsoft Windows 2000 Service Pack 4 (KB952004) para corrigir uma questão de qualidade que poderia fazer com que a instalação falhasse. Os clientes que transferiram e tentaram instalar a actualização do idioma norueguês têm de transferir e instalar a actualização relançada para estarem protegidos contra as vulnerabilidades descritas neste boletim. Nenhuma outra actualização ou configuração local é afectada por este relançamento.
  
**Por que razão foi revisto este boletim a 22 de Abril de 2009?**    
Este boletim foi revisto para comunicar que a secção de **Questões conhecidas relacionadas com esta actualização de segurança**, referida no [Artigo 959454 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/959454), foi actualizada para descrever uma questão de compatibilidade de aplicações com esta actualização e os sistemas que executam o Microsoft Internet Security and Acceleration (ISA) Server 2000 Standard Edition, Microsoft Internet Security and Acceleration (ISA) Server 2004 Standard Edition, ou Microsoft Internet Security and Acceleration (ISA) Server 2006 Standard Edition.
  
**Onde estão os pormenores sobre as informações do ficheiro?**    
Os pormenores sobre as informações do ficheiro podem ser encontrados no [Artigo 959454 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/959454).
  
**Quais são as questões conhecidas que os clientes poderão experimentar quando instalam esta actualização de segurança?**    
O [Artigo 959454 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/959454) documenta as questões actualmente conhecidas que os clientes podem verificar quando instalam esta actualização de segurança. O artigo também documenta soluções recomendadas para estas questões.
  
**Por que razão este boletim contém duas actualizações para cada sistema operativo afectado?**    
Este boletim contém duas actualizações, identificadas pelo número KB, para todos sistemas operativos afectados. Os clientes do Microsoft Windows 2000 necessitam apenas de aplicar o pacote de actualização KB952004. Os clientes que utilizam outros sistemas operativos afectados necessitam de aplicar os pacotes de actualização de segurança KB952004 e KB956572 para cada sistema operativo, de acordo com o seu ambiente.
  
As duas actualizações são necessárias para a maioria dos sistemas operativos afectados porque as modificações necessárias para resolver as vulnerabilidades estão localizadas em componentes separados. O pacote KB952004 resolve a questão conhecida publicamente na funcionalidade de transacções MSDTC. O pacote KB956572 fornece as alterações ao nível da arquitectura necessárias para assegurar o isolamento de serviços adequado através de outros serviços em plataformas Windows.
  
**Por que razão esta actualização resolve diversas vulnerabilidades de segurança comunicadas?**    
Esta actualização contém suporte para diversas vulnerabilidades, porque as modificações necessárias para resolver essas questões estão incluídas nos ficheiros relacionados. Assim, em vez de instalarem diversas actualizações quase iguais, os clientes podem instalar apenas esta actualização.
  
**Esta actualização contém outras alterações de segurança em termos de funcionalidade?**    
Sim. Além das alterações listadas na secção **Informações sobre as vulnerabilidades** deste boletim, esta actualização de segurança também fornece uma infra-estrutura para isolar e tornar os serviços mais seguros. No Windows XP e Windows Server 2003, todos os processos executados no contexto de um conta individual terão controlo total entre si. Esta actualização fornece a outras empresas a capacidade de isolar e tornar mais seguros os serviços que possuem tokens de SISTEMA e que são executados no contexto das contas NetworkService ou LocalService. Para mais informações sobre a utilização desta chave de registo, consulte o [Artigo 956572 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/956572).
  
**Estou a usar uma edição anterior do software discutido neste boletim de segurança. O que devo fazer?**    
O software afectado incluído neste boletim foi testado para determinar quais as edições afectadas. As outras edições ultrapassaram o respectivo ciclo de vida de suporte. Para determinar o ciclo de vida de suporte da edição do seu software, visite o [Web site do Ciclo de Vida de Suporte Microsoft](http://support.microsoft.com/lifecycle/).
  
Os utilizadores que tenham edições anteriores do software deviam considerar a migração para edições suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o Web site do [Ciclo de Vida de Suporte Microsoft.](http://support.microsoft.com/lifecycle/) Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões ou edições de software, visite o Web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).
  
Os clientes que necessitem de suporte personalizado para edições anteriores devem contactar o seu representante de equipa de contas da Microsoft, o seu Gestor Técnico de Contas ou o parceiro ou representante Microsoft adequado para obter mais informações sobre opções de suporte personalizado. Os clientes que não disponham de um Contrato Alliance, Premier ou Autorizado podem contactar a subsidiária local da Microsoft. Para obter informações de contacto, visite o [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), seleccione o país e, em seguida, clique em **Go** para ver uma lista de números de telefone. Quando telefonar, peça para falar com o Gestor de Vendas de Suporte Premier local. Para mais informações, consulte as [Perguntas Mais Frequentes de suporte sobre o ciclo de vida de produto, relativas aos sistemas operativos Windows](http://go.microsoft.com/fwlink/?linkid=33330).
  
### Informações sobre as vulnerabilidades
  
Classificações da Gravidade e Identificadores da Vulnerabilidade  
----------------------------------------------------------------
  
<span></span>
As seguintes classificações de gravidade presumem o potencial impacto máximo da vulnerabilidade. Para obter informações sobre a probabilidade, dentro de 30 dias após a publicação deste boletim de segurança, de exploração da vulnerabilidade em relação à sua classificação de gravidade e impacto de segurança, consulte o Índice de Possibilidade de Exploração no [resumo dos boletins de Abril](http://technet.microsoft.com/security/bulletin/ms09-apr). Para mais informações, consulte o [Índice de Possibilidade de Exploração da Microsoft](http://technet.microsoft.com/en-us/security/cc998259.aspx).

 
<table style="border:1px solid black;">
<caption>Classificações da Gravidade da Vulnerabilidade e Impacto de Segurança Máximo por Software Afectado</caption>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Software Afectado</th>
<th style="border:1px solid black;" >Vulnerabilidade de Isolamento de Serviços MSDTC do Windows - CVE-2008-1436</th>
<th style="border:1px solid black;" >Vulnerabilidade de Isolamento de Serviços WMI do Windows - CVE-2009-0078</th>
<th style="border:1px solid black;" >Vulnerabilidade de Isolamento de Serviços RPCSS do Windows - CVE-2009-0079</th>
<th style="border:1px solid black;" >Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows - CVE-2009-0080</th>
<th style="border:1px solid black;" >Classificação de Gravidade Agregada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Windows 2000 Service Pack 4</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows XP Service Pack 2 e Windows XP Service Pack 3</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows Vista e Windows Vista Service Pack 1</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows Vista x64 Edition e Windows Vista x64 Edition Service Pack 1</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows Server 2008 para sistemas de 32 bits*</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows Server 2008 para sistemas baseados em x64*</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows Server 2008 para sistemas baseados em Itanium</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;">Não aplicável</td>
<td style="border:1px solid black;"><strong>Importante</strong> <br />
Elevação de Privilégios</td>
<td style="border:1px solid black;"><strong>Importante</strong></td>
</tr>
</tbody>
</table>
  
**\*Instalação Server Core do Windows Server 2008 afectada.** Para edições suportadas do Windows Server 2008, esta actualização aplica-se com a mesma classificação de gravidade, quer o Windows Server 2008 tenha ou não sido instalado utilizando a opção de instalação Server Core. Para mais informações sobre esta opção de instalação, consulte a informação sobre [Server Core](http://msdn.microsoft.com/en-us/library/ms723891(vs.85).aspx). Tenha em atenção que a opção de instalação Server Core não se aplica a determinadas edições do Windows Server 2008; consulte [Comparar as Opções de Instalação Server Core](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).
  
Vulnerabilidade de Isolamento de Serviços MSDTC do Windows - CVE-2008-1436  
--------------------------------------------------------------------------
  
<span></span>
Existe uma vulnerabilidade de elevação de privilégios na funcionalidade de transacções do Coordenador de Transacções Distribuídas da Microsoft (MSDTC) nas plataformas Microsoft Windows. O MSDTC deixa um token NetworkService que pode ser simulado por qualquer processo que a ele aceda. A vulnerabilidade permite que um processo que não está a ser executado no contexto da conta NetworkService, mas que tem o SeImpersonatePrivilege, eleve o seu privilégio NetworkService e execute código com privilégios NetworkService. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário e obter controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
Para visualizar esta vulnerabilidade como uma entrada comum na lista de Vulnerabilidades e Exposições Comuns, consulte [CVE-2008-1436](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2008-1436).
  
#### Factores Atenuantes para a Vulnerabilidade de Isolamento de Serviços MSDTC no Windows - CVE-2008-1436
  
A atenuação refere-se a uma definição, uma configuração comum ou uma prática recomendada geral, que existe num estado predefinido, que poderia reduzir a gravidade da exploração de uma vulnerabilidade. Os seguintes factores atenuantes podem ser úteis para a sua situação:
  
-   O intruso teria de conseguir executar código no computador local para explorar esta vulnerabilidade.
  
#### Soluções Alternativas para a Vulnerabilidade de Isolamento de Serviços MSDTC no Windows - CVE-2008-1436
  
Uma solução alternativa refere-se a uma definição ou alteração de configuração que não corrige a vulnerabilidade subjacente, mas que ajudaria a bloquear vectores de ataque conhecidos antes de aplicar a actualização. A Microsoft testou as seguintes soluções alternativas e estados na discussão acerca de casos em que uma solução alternativa reduz a funcionalidade:
  
-   **IIS 6.0 - Configure um WPI (identidade do processo de trabalho) no IIS para um conjunto aplicacional, permitindo assim utilizar uma conta criada no Gestor de IIS e desactivar o MSDTC**
  
    Siga os seguintes passos:
  
    1.  No Gestor de IIS, expanda o computador local, expanda **Conjuntos Aplicacionais**, clique com o botão direito no conjunto aplicacional e seleccione **Propriedades**.  
    2.  Clique no separador **Identidade** e clique em **Configurável**. Nas caixas **Nome de utilizador** e **Palavra-passe**, escreva o nome de utilizador e palavra-passe da conta sob a qual deseja que o processo de trabalho opere.  
    3.  Adicione a conta de utilizador escolhida ao grupo IIS\_WPG.
  
    Desactivar o Coordenador de Transacções Distribuídas ajudará a proteger o sistema afectado contra tentativas de explorar esta vulnerabilidade. Para desactivar o Coordenador de Transacções Distribuídas, execute estes passos:
  
    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**. Alternativamente, seleccione **Definições** e depois clique em **Painel de Controlo**.  
    2.  Faça duplo clique em **Ferramentas Administrativas**. Como alternativa, clique em **Mudar para a vista clássica** e a seguir clique duas vezes sobre **Ferramentas administrativas**.  
    3.  Faça duplo clique em **Serviços**.  
    4.  Faça duplo clique em **Coordenador de Transacções Distribuídas**.  
    5.  Na lista **Tipo de arranque**, clique em **Desactivado**.  
    6.  Clique em **Parar** (se iniciado) e a seguir em **OK**.
  
    Também pode parar e desactivar o serviço MSDTC utilizando o seguinte comando na linha de comandos:  
    sc stop MSDTC & sc config MSDTC start= disabled
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado. Um exemplo é a Autenticação do Windows; consulte o [Artigo 871179 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/871179). A desactivação do MSDTC impedirá que as aplicações utilizem transacções distribuídas. Desactivar o MSDTC impedirá que o IIS 5.1 seja executado no Windows XP Professional Service Pack 2 e no Windows XP Professional Service Pack 3 e que o IIS 6.0 seja executado no modo de compatibilidade IIS 5.0. Desactivar o MSDTC impedirá a configuração e a execução de aplicações COM+.
  
-   **IIS 7.0 - Especificar um WPI para um conjunto aplicacional no Gestor de IIS**
  
    1.  No Gestor de IIS, expandir o nó do servidor, clicar em **Conjuntos Aplicacionais**, clicar com o botão direito no conjunto aplicacional e depois em **Configurações Avançadas…**  
    2.  Encontre a entrada **Identidade** e clique no botão **…** para abrir a caixa de diálogo **Identidade do Conjunto Aplicacional**.  
    3.  Seleccione a opção **Conta personalizada** e clique em **Configurar** para abrir a caixa de diálogo **Configurar credenciais**. Digite o **Nome da conta** e **Palavra-passe** escolhidos nas respectivas caixas de texto. Volte a digitar a Palavra-passe na caixa de texto **Confirmar palavra-passe** e clique em **OK**.
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS7 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
-   **IIS 7.0 - Especifique um WPI para um conjunto aplicacional utilizando o utilitário da linha de comandos APPCMD.exe**
  
    1.  A partir de uma linha de comandos elevada, mude para o directório %systemroot%\\system32\\inetsrv.  
    2.  Execute o comando APPCMD.exe utilizando a seguinte sintaxe onde *string* é o nome do conjunto aplicacional; userName:*string* é o nome de utilizador da conta atribuído ao conjunto aplicacional; e password:*string* é a palavra-passe para a conta.  
        appcmd set config /section:applicationPools /  
        \[name='string'\].processModel.identityType:SpecificUser /  
        \[name='string'\].processModel.userName:string /  
        \[name='string'\].processModel.password:string
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS 7.0 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
#### Perguntas Mais Frequentes sobre a Vulnerabilidade de Isolamento de Serviços MSDTC do Windows - CVE-2008-1436
  
**Qual é a abrangência desta vulnerabilidade?**    
Esta é uma vulnerabilidade de elevação de privilégios. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário com privilégios NetworkService. Um intruso poderia então obter o token LocalSystem de outros serviços vulneráveis e instalar programas, ver, alterar ou eliminar dados, ou ainda criar novas contas com todos os privilégios.
  
**O que provoca a vulnerabilidade?**    
A vulnerabilidade deve-se ao facto de a funcionalidade de transacções do Coordenador de Transacções Distribuídas da Microsoft (MSDTC) permitir que o token NetworkService seja obtido e utilizado ao fazer uma chamada RPC.
  
**O que é o Coordenador de Transacções Distribuídas da Microsoft?**    
O Coordenador de Transacções Distribuídas da Microsoft (MSDTC) é uma funcionalidade de transacções distribuídas para plataformas Microsoft Windows. O MSDTC utiliza uma tecnologia de processamento de transacções testada. É resistente apesar de falhas no sistema, falhas no processo e falhas de comunicação; explora sem grande exactidão os sistemas associados para fornecer um desempenho escalável; e é fácil de instalar, de configurar e de gerir.
  
Para mais informações sobre o MSDTC, consulte o artigo MSDN sobre o [Guia de Programadores de DTC](http://msdn2.microsoft.com/en-us/library/ms679938.aspx).
  
**O que significa RPC?**    
A Chamada de Procedimento Remoto (RPC) é um protocolo que pode ser utilizado por um programa para requerer um serviço de um programa localizado noutro computador numa rede. A RPC ajuda na interoperabilidade, uma vez que um programa que utiliza RPC não necessita de compreender os protocolos de rede que suportam a comunicação. Na RPC, o programa que pede é o cliente e o programa que fornece o serviço é o servidor.
  
**O que é a Conta NetworkService?**    
A conta NetworkService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e actua como o computador na rede. Um serviço executado no contexto da conta NetworkService possui as credenciais do computador para servidores remotos. Para mais informações, consulte o artigo MSDN sobre a [Conta NetworkService](http://msdn.microsoft.com/en-us/library/ms684272(vs.85).aspx).
  
**O que é a Conta LocalService?**    
A conta LocalService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e apresenta credenciais anónimas na rede. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalService](http://msdn.microsoft.com/en-us/library/ms684188(vs.85).aspx).
  
**O que é a Conta LocalSystem?**    
A conta LocalSystem é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem vastos privilégios no computador local e actua como o computador na rede. O seu token inclui os SIDs NT AUTHORITY\\SYSTEM e BUILTIN\\Administrators; estas contas têm acesso à maioria dos objectos de sistema. Um serviço executado no contexto da conta LocalSystem herda o contexto de segurança do Gestor de Controlo de Serviços. A maioria dos serviços não necessita de um nível de privilégios elevado. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalSystem](http://msdn.microsoft.com/en-us/library/ms684190.aspx).
  
**Como é que o IIS é afectado por esta questão?**    
Os sistemas que executam código fornecido pelos utilizadores no Internet Information Services (IIS) podem ser afectados. Os filtros e as extensões ISAPI e a execução de códigos ASP.NET com confiança completa poderão ser afectadas por esta vulnerabilidade.
  
O IIS não é afectado nos seguintes casos:
  
-   Instalações predefinidas do IIS 5.1, IIS 6.0 e IIS 7.0  
-   ASP.NET configurado para ser executado com um nível de confiança inferior a Confiança Completa
  
**Como é que o SQL Server é afectado por esta questão?**    
Os sistemas que executam o SQL Server podem ser afectados se forem concedidos privilégios administrativos a um utilizador para carregar e executar código. Um utilizador com privilégios administrativos no SQL Server poderia executar código especialmente concebido para o efeito que poderia desencadear o ataque. Contudo, este privilégio não é concedido por predefinição.
  
**Que outras aplicações podem ser afectadas por esta vulnerabilidade?**    
Os sistemas que executam qualquer processo com SeImpersonatePrivilege que carrega e executa código fornecido pelo utilizador poderá estar susceptível a um ataque de elevação de privilégios tal como descrito neste boletim de segurança. A definição SeImpersonatePrivilege é descrita no Artigo 821546 da Base de Dados de Conhecimento da Microsoft.
  
**Como poderia um intruso utilizar a vulnerabilidade?**    
Um intruso que explorasse esta vulnerabilidade com sucesso poderia executar código especialmente concebido para o efeito no contexto de conta NetworkService. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**Como poderia um intruso explorar a vulnerabilidade?**    
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter controlo total sobre o sistema afectado.
  
**Quais os sistemas mais susceptíveis face a esta vulnerabilidade?**    
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores podem estar mais em risco se os utilizadores sem autorizações administrativas tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.
  
Todos os sistemas que executam todas as edições suportadas do Windows XP Professional Service Pack 2 e do Windows XP Professional Service Pack 3 e todas as versões e edições suportadas do Windows Server 2003, Windows Vista e Windows Server 2008 poderão estar susceptíveis se o IIS estiver activado ou se o SQL Server estiver instalado, configurado ou implementado de modo vulnerável, tal como descrito neste boletim.
  
Além disso, os sistemas IIS que permitem que os utilizadores carreguem código estão mais susceptíveis. Os sistemas SQL Server estão susceptíveis se for concedido acesso privilegiado a contas a utilizadores não fidedignos. Isso poderá incluir fornecedores de alojamento na Web ou ambientes semelhantes.
  
**O que faz a actualização?**    
A actualização resolve a vulnerabilidade ao reduzir o nível de privilégios no token solicitado pelo MSDTC.
  
**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**    
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum CVE-2008-1436.
  
**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios indicando que esta vulnerabilidade estava a ser explorada?**    
Sim. Sim, a Microsoft tem conhecimento de ataques limitados e muito específicos que tentam explorar a vulnerabilidade.
  
**A aplicação desta actualização de segurança ajuda a proteger os clientes contra o código que foi divulgado publicamente e que tenta explorar esta vulnerabilidade?**    
Sim. Esta actualização de segurança corrige a vulnerabilidade actualmente explorada. À vulnerabilidade que foi corrigida foi atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2008-1436](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2008-1436).
  
Vulnerabilidade de Isolamento de Serviços WMI do Windows - CVE-2009-0078  
------------------------------------------------------------------------
  
<span></span>
Existe uma vulnerabilidade de elevação de privilégios devido aos processos de isolamento impróprios do fornecedor do Windows Management Instrumentation (WMI) executados no contexto das contas NetworkService ou LocalService. A vulnerabilidade poderia permitir que um intruso executasse código com privilégios elevados. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário e obter controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
Para visualizar esta vulnerabilidade como uma entrada comum na lista de Vulnerabilidades e Exposições Comuns, consulte [CVE-2009-0078](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0078).
  
#### Factores Atenuantes para a Vulnerabilidade de Isolamento de Serviços WMI do Windows - CVE-2009-0078
  
A atenuação refere-se a uma definição, uma configuração comum ou uma prática recomendada geral, que existe num estado predefinido, que poderia reduzir a gravidade da exploração de uma vulnerabilidade. Os seguintes factores atenuantes podem ser úteis para a sua situação:
  
-   O intruso teria de conseguir executar código no computador local para explorar esta vulnerabilidade.
  
#### Soluções Alternativas para a Vulnerabilidade de Isolamento de Serviços WMI do Windows - CVE-2009-0078
  
Uma solução alternativa refere-se a uma definição ou alteração de configuração que não corrige a vulnerabilidade subjacente, mas que ajudaria a bloquear vectores de ataque conhecidos antes de aplicar a actualização. A Microsoft testou as seguintes soluções alternativas e estados na discussão acerca de casos em que uma solução alternativa reduz a funcionalidade:
  
-   **IIS 6.0 - Configure um WPI (identidade do processo de trabalho) no IIS para um conjunto aplicacional, permitindo assim utilizar uma conta criada no Gestor de IIS e desactivar o MSDTC**
  
    Siga os seguintes passos:
  
    1.  No Gestor de IIS, expanda o computador local, expanda **Conjuntos Aplicacionais**, clique com o botão direito no conjunto aplicacional e seleccione **Propriedades**.  
    2.  Clique no separador **Identidade** e clique em **Configurável**. Nas caixas **Nome de utilizador** e **Palavra-passe**, escreva o nome de utilizador e palavra-passe da conta sob a qual deseja que o processo de trabalho opere.  
    3.  Adicione a conta de utilizador escolhida ao grupo IIS\_WPG.
  
    Desactivar o Coordenador de Transacções Distribuídas ajudará a proteger o sistema afectado contra tentativas de explorar esta vulnerabilidade. Para desactivar o Coordenador de Transacções Distribuídas, execute estes passos:
  
    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**. Alternativamente, seleccione **Definições** e depois clique em **Painel de Controlo**.  
    2.  Faça duplo clique em **Ferramentas Administrativas**. Como alternativa, clique em **Mudar para a vista clássica** e a seguir clique duas vezes sobre **Ferramentas administrativas**.  
    3.  Faça duplo clique em **Serviços**.  
    4.  Faça duplo clique em **Coordenador de Transacções Distribuídas**.  
    5.  Na lista **Tipo de arranque**, clique em **Desactivado**.  
    6.  Clique em **Parar** (se iniciado) e a seguir em **OK**.
  
    Também pode parar e desactivar o serviço MSDTC utilizando o seguinte comando na linha de comandos:  
    sc stop MSDTC & sc config MSDTC start= disabled
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado. Um exemplo é a Autenticação do Windows; consulte o [Artigo 871179 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/871179). A desactivação do MSDTC impedirá que as aplicações utilizem transacções distribuídas. Desactivar o MSDTC impedirá que o IIS 5.1 seja executado no Windows XP Professional Service Pack 2 e no Windows XP Professional Service Pack 3 e que o IIS 6.0 seja executado no modo de compatibilidade IIS 5.0. Desactivar o MSDTC impedirá a configuração e a execução de aplicações COM+.
  
-   **IIS 7.0 - Especificar um WPI para um conjunto aplicacional no Gestor de IIS**
  
    1.  No Gestor de IIS, expandir o nó do servidor, clicar em **Conjuntos Aplicacionais**, clicar com o botão direito no conjunto aplicacional e depois em **Configurações Avançadas…**  
    2.  Encontre a entrada **Identidade** e clique no botão **…** para abrir a caixa de diálogo **Identidade do Conjunto Aplicacional**.  
    3.  Seleccione a opção **Conta personalizada** e clique em **Configurar** para abrir a caixa de diálogo **Configurar credenciais**. Digite o **Nome da conta** e **Palavra-passe** escolhidos nas respectivas caixas de texto. Volte a digitar a Palavra-passe na caixa de texto **Confirmar palavra-passe** e clique em **OK**.
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS7 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
-   **IIS 7.0 - Especifique um WPI para um conjunto aplicacional utilizando o utilitário da linha de comandos APPCMD.exe**
  
    1.  A partir de uma linha de comandos elevada, mude para o directório %systemroot%\\system32\\inetsrv.  
    2.  Execute o comando APPCMD.exe utilizando a seguinte sintaxe onde *string* é o nome do conjunto aplicacional; userName:*string* é o nome de utilizador da conta atribuído ao conjunto aplicacional; e password:*string* é a palavra-passe para a conta.  
        appcmd set config /section:applicationPools /  
        \[name='string'\].processModel.identityType:SpecificUser /  
        \[name='string'\].processModel.userName:string /  
        \[name='string'\].processModel.password:string
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS 7.0 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
#### Perguntas Mais Frequentes sobre a Vulnerabilidade de Isolamento de Serviços WMI do Windows - CVE-2009-0078
  
**Qual é a abrangência desta vulnerabilidade?**    
Esta é uma vulnerabilidade de elevação de privilégios. Um intruso que conseguisse tirar partido desta vulnerabilidade com sucesso poderia executar código arbitrário com os mesmos privilégios da conta LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**O que provoca a vulnerabilidade?**    
A vulnerabilidade deve-se aos processos de isolamento impróprios do fornecedor do Windows Management Instrumentation (WMI) executados no contexto das contas NetworkService ou LocalService. Dois processos separados executados no contexto da mesma conta têm acesso total aos recursos do outro processo, tais como o identificador de ficheiro, chaves de registo, identificadores, entre outros. O processo de alojamento do fornecedor de WMI mantém os tokens do SISTEMA em determinados cenários. Se um intruso obtiver acesso a um computador no contexto de uma conta NetworkService ou LocalService, o intruso poderá executar código para procurar tokens de SISTEMA nos processos de alojamento do fornecedor de WMI. Assim que o token de SISTEMA é descoberto, o código do intruso pode utilizá-lo para obter um nível de privilégios de SISTEMA.
  
**O que é o Windows Management Instrumentation (WMI)?**    
O Windows Management Instrumentation (WMI) é a principal tecnologia de gestão para sistemas operativos Microsoft Windows. Activa a gestão, o controlo e a monitorização consistentes e uniformes de sistemas em toda a sua empresa. O WMI permite que os administradores de sistema consultem, alterem e monitorizem as definições de configuração através dos sistemas de ambiente de trabalho e de servidor, aplicações, redes e outros componentes empresariais. Para mais informações, consulte [WMI Scripting Primer](http://www.microsoft.com/technet/scriptcenter/guide/sas_wmi_overview.mspx?mfr=true).
  
**O que é a Conta NetworkService?**    
A conta NetworkService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e actua como o computador na rede. Um serviço executado no contexto da conta NetworkService possui as credenciais do computador para servidores remotos. Para mais informações, consulte o artigo MSDN sobre a [Conta NetworkService](http://msdn.microsoft.com/en-us/library/ms684272(vs.85).aspx).
  
**O que é a Conta LocalService?**    
A conta LocalService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e apresenta credenciais anónimas na rede. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalService](http://msdn.microsoft.com/en-us/library/ms684188(vs.85).aspx).
  
**O que é a Conta LocalSystem?**    
A conta LocalSystem é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem vastos privilégios no computador local e actua como o computador na rede. O seu token inclui os SIDs NT AUTHORITY\\SYSTEM e BUILTIN\\Administrators; estas contas têm acesso à maioria dos objectos de sistema. Um serviço executado no contexto da conta LocalSystem herda o contexto de segurança do [Gestor de Controlo de Serviços](http://msdn.microsoft.com/en-us/library/ms685150(vs.85).aspx). A maioria dos serviços não necessita de um nível de privilégios elevado. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalSystem](http://msdn.microsoft.com/en-us/library/ms684190.aspx).
  
**Como é que o IIS é afectado por esta questão?**    
Os sistemas que executam código fornecido pelos utilizadores no Internet Information Services (IIS) podem ser afectados. Os filtros e as extensões ISAPI e a execução de códigos ASP.NET com confiança completa poderão ser afectadas por esta vulnerabilidade.
  
O IIS não é afectado nos seguintes casos:
  
-   Instalações predefinidas do IIS 5.1, IIS 6.0 e IIS 7.0  
-   ASP.NET configurado para ser executado com um nível de confiança inferior a Confiança Completa
  
**Como é que o SQL Server é afectado por esta questão?**    
Os sistemas que executam o SQL Server podem ser afectados se forem concedidos privilégios administrativos a um utilizador para carregar e executar código. Um utilizador com privilégios administrativos no SQL Server poderia executar código especialmente concebido para o efeito que poderia desencadear o ataque. Contudo, este privilégio não é concedido por predefinição.
  
**Que fornecedores de WMI são afectados por esta actualização?**  
Pode ser encontrada uma lista completa dos fornecedores de WMI afectados por esta actualização no [Artigo 956572 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/956572).
  
**Que outras aplicações podem ser afectadas por esta vulnerabilidade?**    
Os sistemas que executam qualquer processo com SeImpersonatePrivilege que carrega e executa código fornecido pelo utilizador poderá estar susceptível a um ataque de elevação de privilégios tal como descrito neste boletim de segurança. A definição SeImpersonatePrivilege é descrita no [Artigo 821546 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/821546).
  
**Como poderia um intruso utilizar a vulnerabilidade?**    
Um intruso que explorasse esta vulnerabilidade poderia executar código especialmente concebido para o efeito no contexto das contas NetworkService ou LocalService para aceder a recursos nos processos que também são executados como NetworkService ou LocalService. Alguns destes processos poderão ser capazes de elevar os seus privilégios para LocalSystem, permitindo também que quaisquer processos NetworkService ou LocalService elevem os seus privilégios para LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**Como poderia um intruso explorar a vulnerabilidade?**    
Para explorar esta vulnerabilidade, um intruso teria, primeiro, que convencer um utilizador com sessão iniciada a executar código no seu sistema. Um intruso poderia executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter controlo total sobre o sistema afectado.
  
**Quais os sistemas mais susceptíveis face a esta vulnerabilidade?**    
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores podem estar mais em risco se os utilizadores sem autorizações administrativas suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.
  
Todos os sistemas que executam todas as edições suportadas do Windows XP Professional Service Pack 2, Windows XP Professional Service Pack 3 e todas as versões e edições suportadas do Windows Server 2003, Windows Vista e Windows Server 2008 poderão estar susceptíveis se o IIS estiver activado ou se o SQL Server estiver instalado, configurado ou implementado de modo vulnerável, tal como descrito neste boletim.
  
Além disso, os sistemas IIS que permitem que os utilizadores carreguem código estão mais susceptíveis. Os sistemas SQL Server estão susceptíveis se for concedido acesso privilegiado a contas a utilizadores não fidedignos. Isso poderá incluir fornecedores de alojamento na Web ou ambientes semelhantes.
  
**O que faz a actualização?**    
A actualização resolve a vulnerabilidade isolando adequadamente os fornecedores de WMI, para garantir que são invocados de uma forma segura.
  
**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**    
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2009-0078](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0078).
  
**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios indicando que esta vulnerabilidade estava a ser explorada?**    
Sim. Sim, a Microsoft tem conhecimento de ataques limitados e muito específicos que tentam explorar a vulnerabilidade.
  
Vulnerabilidade de Isolamento de Serviços RPCSS do Windows - CVE-2009-0079  
--------------------------------------------------------------------------
  
<span></span>
Existe uma vulnerabilidade de elevação de privilégios devido aos processos de isolamento impróprios do serviço RPCSS executados no contexto das contas NetworkService ou LocalService. A vulnerabilidade poderia permitir que um intruso executasse código com privilégios elevados. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário e obter controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
Para visualizar esta vulnerabilidade como uma entrada comum na lista de Vulnerabilidades e Exposições Comuns, consulte [CVE-2009-0079](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0079).
  
#### Factores Atenuantes para a Vulnerabilidade de Isolamento de Serviços RPCSS no Windows - CVE-2009-0079
  
A atenuação refere-se a uma definição, uma configuração comum ou uma prática recomendada geral, que existe num estado predefinido, que poderia reduzir a gravidade da exploração de uma vulnerabilidade. Os seguintes factores atenuantes podem ser úteis para a sua situação:
  
-   O intruso teria de conseguir executar código no computador local para explorar esta vulnerabilidade.
  
#### Soluções Alternativas para a Vulnerabilidade de Isolamento de Serviços RPCSS no Windows - CVE-2009-0079
  
Uma solução alternativa refere-se a uma definição ou alteração de configuração que não corrige a vulnerabilidade subjacente, mas que ajudaria a bloquear vectores de ataque conhecidos antes de aplicar a actualização. A Microsoft testou as seguintes soluções alternativas e estados na discussão acerca de casos em que uma solução alternativa reduz a funcionalidade:
  
-   **IIS 6.0 - Configure um WPI (identidade do processo de trabalho) no IIS para um conjunto aplicacional, permitindo assim utilizar uma conta criada no Gestor de IIS e desactivar o MSDTC**
  
    Siga os seguintes passos:
  
    1.  No Gestor de IIS, expanda o computador local, expanda **Conjuntos Aplicacionais**, clique com o botão direito no conjunto aplicacional e seleccione **Propriedades**.  
    2.  Clique no separador **Identidade** e clique em **Configurável**. Nas caixas **Nome de utilizador** e **Palavra-passe**, escreva o nome de utilizador e palavra-passe da conta sob a qual deseja que o processo de trabalho opere.  
    3.  Adicione a conta de utilizador escolhida ao grupo IIS\_WPG.
  
    Desactivar o Coordenador de Transacções Distribuídas ajudará a proteger o sistema afectado contra tentativas de explorar esta vulnerabilidade. Para desactivar o Coordenador de Transacções Distribuídas, execute estes passos:
  
    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**. Alternativamente, seleccione **Definições** e depois clique em **Painel de Controlo**.  
    2.  Faça duplo clique em **Ferramentas Administrativas**. Como alternativa, clique em **Mudar para a vista clássica** e a seguir clique duas vezes sobre **Ferramentas administrativas**.  
    3.  Faça duplo clique em **Serviços**.  
    4.  Faça duplo clique em **Coordenador de Transacções Distribuídas**.  
    5.  Na lista **Tipo de arranque**, clique em **Desactivado**.  
    6.  Clique em **Parar** (se iniciado) e a seguir em **OK**.
  
    Também pode parar e desactivar o serviço MSDTC utilizando o seguinte comando na linha de comandos:  
    sc stop MSDTC & sc config MSDTC start= disabled
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado. Um exemplo é a Autenticação do Windows; consulte o [Artigo 871179 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/871179). A desactivação do MSDTC impedirá que as aplicações utilizem transacções distribuídas. Desactivar o MSDTC impedirá que o IIS 5.1 seja executado no Windows XP Professional Service Pack 2 e no Windows XP Professional Service Pack 3 e que o IIS 6.0 seja executado no modo de compatibilidade IIS 5.0. Desactivar o MSDTC impedirá a configuração e a execução de aplicações COM+.
  
-   **IIS 7.0 - Especificar um WPI para um conjunto aplicacional no Gestor de IIS**
  
    1.  No Gestor de IIS, expandir o nó do servidor, clicar em **Conjuntos Aplicacionais**, clicar com o botão direito no conjunto aplicacional e depois em **Configurações Avançadas…**  
    2.  Encontre a entrada **Identidade** e clique no botão **…** para abrir a caixa de diálogo **Identidade do Conjunto Aplicacional**.  
    3.  Seleccione a opção **Conta personalizada** e clique em **Configurar** para abrir a caixa de diálogo **Configurar credenciais**. Digite o **Nome da conta** e **Palavra-passe** escolhidos nas respectivas caixas de texto. Volte a digitar a Palavra-passe na caixa de texto **Confirmar palavra-passe** e clique em **OK**.
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS7 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
-   **IIS 7.0 - Especifique um WPI para um conjunto aplicacional utilizando o utilitário da linha de comandos APPCMD.exe**
  
    1.  A partir de uma linha de comandos elevada, mude para o directório %systemroot%\\system32\\inetsrv.  
    2.  Execute o comando APPCMD.exe utilizando a seguinte sintaxe onde *string* é o nome do conjunto aplicacional; userName:*string* é o nome de utilizador da conta atribuído ao conjunto aplicacional; e password:*string* é a palavra-passe para a conta.  
        appcmd set config /section:applicationPools /  
        \[name='string'\].processModel.identityType:SpecificUser /  
        \[name='string'\].processModel.userName:string /  
        \[name='string'\].processModel.password:string
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS 7.0 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
#### Perguntas Mais Frequentes sobre a Vulnerabilidade de Isolamento de Serviços RPCSS no Windows - CVE-009-0079
  
**Qual é a abrangência desta vulnerabilidade?**    
Esta é uma vulnerabilidade de elevação de privilégios. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário com privilégios LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**O que provoca a vulnerabilidade?**    
A vulnerabilidade deve-se aos processos de isolamento impróprios do serviço RPCSS executados no contexto das contas NetworkService ou LocalService.
  
**O que significa RPC?**    
A Chamada de Procedimento Remoto (RPC) é um protocolo que pode ser utilizado por um programa para requerer um serviço de um programa localizado noutro computador numa rede. A RPC ajuda na interoperabilidade, uma vez que um programa que utiliza RPC não necessita de compreender os protocolos de rede que suportam a comunicação. Na RPC, o programa que pede é o cliente e o programa que fornece o serviço é o servidor.
  
**O que é a Conta NetworkService?**    
A conta NetworkService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e actua como o computador na rede. Um serviço executado no contexto da conta NetworkService possui as credenciais do computador para servidores remotos. Para mais informações, consulte o artigo MSDN sobre a [Conta NetworkService](http://msdn.microsoft.com/en-us/library/ms684272(vs.85).aspx).
  
**O que é a Conta LocalService?**    
A conta LocalService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e apresenta credenciais anónimas na rede. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalService](http://msdn.microsoft.com/en-us/library/ms684188(vs.85).aspx).
  
**O que é a Conta LocalSystem?**    
A conta LocalSystem é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem vastos privilégios no computador local e actua como o computador na rede. O seu token inclui os SIDs NT AUTHORITY\\SYSTEM e BUILTIN\\Administrators; estas contas têm acesso à maioria dos objectos de sistema. Um serviço executado no contexto da conta LocalSystem herda o contexto de segurança do [Gestor de Controlo de Serviços](http://msdn.microsoft.com/en-us/library/ms685150(vs.85).aspx). A maioria dos serviços não necessita de um nível de privilégios elevado. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalSystem](http://msdn.microsoft.com/en-us/library/ms684190.aspx).
  
**Como é que o IIS é afectado por esta questão?**    
Os sistemas que executam código fornecido pelos utilizadores no Internet Information Services (IIS) podem ser afectados. Os filtros e as extensões ISAPI e a execução de códigos ASP.NET com confiança completa poderão ser afectadas por esta vulnerabilidade.
  
O IIS não é afectado nos seguintes casos:
  
-   Instalações predefinidas do IIS 5.1, IIS 6.0 e IIS 7.0  
-   ASP.NET configurado para ser executado com um nível de confiança inferior a Confiança Completa
  
**Como é que o SQL Server é afectado por esta questão?**    
Os sistemas que executam o SQL Server podem ser afectados se forem concedidos privilégios administrativos a um utilizador para carregar e executar código. Um utilizador com privilégios administrativos no SQL Server poderia executar código especialmente concebido para o efeito que poderia desencadear o ataque. Contudo, este privilégio não é concedido por predefinição.
  
**Que outras aplicações podem ser afectadas por esta vulnerabilidade?**    
Os sistemas que executam qualquer processo com SeImpersonatePrivilege que carrega e executa código fornecido pelo utilizador poderá estar susceptível a um ataque de elevação de privilégios tal como descrito neste boletim de segurança. A definição SeImpersonatePrivilege é descrita no [Artigo 821546 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/821546).
  
**Como poderia um intruso utilizar a vulnerabilidade?**    
Um intruso que explorasse esta vulnerabilidade poderia executar código especialmente concebido para o efeito no contexto das contas NetworkService ou LocalService para aceder a recursos nos processos que também são executados como NetworkService ou LocalService. Alguns destes processos poderão ser capazes de elevar os seus privilégios para LocalSystem, permitindo também que quaisquer processos NetworkService ou LocalService elevem os seus privilégios para LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**Como poderia um intruso explorar a vulnerabilidade?**    
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter controlo total sobre o sistema afectado.
  
**Quais os sistemas mais susceptíveis face a esta vulnerabilidade?**    
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores podem estar mais em risco se os utilizadores sem autorizações administrativas suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.
  
Todos os sistemas que executam o Windows XP Professional Service Pack 2, o Windows XP Professional Service Pack 3 e todas as versões e edições suportadas do Windows Server 2003 poderão estar susceptíveis se o IIS estiver activado ou se o SQL Server estiver instalado, configurado ou implementado de modo vulnerável, tal como descrito neste boletim.
  
Além disso, os sistemas IIS que permitem que os utilizadores carreguem código estão mais susceptíveis. Os sistemas SQL Server estão susceptíveis se for concedido acesso privilegiado a contas a utilizadores não fidedignos. Isso poderá incluir fornecedores de alojamento na Web ou ambientes semelhantes.
  
**O que faz a actualização?**    
A actualização resolve a vulnerabilidade ao isolar de forma adequada os processos executados no contexto das contas NetworkService ou LocalService.
  
**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**    
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2009-0079](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0079).
  
**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios indicando que esta vulnerabilidade estava a ser explorada?**    
Sim. Sim, a Microsoft tem conhecimento de ataques limitados e muito específicos que tentam explorar a vulnerabilidade.
  
Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows - CVE-2009-0080  
------------------------------------------------------------------------------------
  
<span></span>
Existe uma vulnerabilidade de elevação de privilégios devido ao facto de o Windows colocar listas de controlo de acesso (ACLs) incorrectas em threads no ThreadPool actual. A vulnerabilidade poderia permitir que um intruso executasse código com privilégios elevados. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário e obter controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
Para visualizar esta vulnerabilidade como uma entrada comum na lista de Vulnerabilidades e Exposições Comuns, consulte [CVE-2009-0080](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0080).
  
#### Factores Atenuantes para a Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows - CVE- 2009-0080
  
A atenuação refere-se a uma definição, uma configuração comum ou uma prática recomendada geral, que existe num estado predefinido, que poderia reduzir a gravidade da exploração de uma vulnerabilidade. Os seguintes factores atenuantes podem ser úteis para a sua situação:
  
-   O intruso teria de conseguir executar código no computador local para explorar esta vulnerabilidade. Um intruso que conseguisse explorar esta vulnerabilidade com êxito poderia obter os mesmos privilégios que o serviço LocalSystem.
  
#### Soluções Alternativas para a Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows - CVE- 2009-0080
  
Uma solução alternativa refere-se a uma definição ou alteração de configuração que não corrige a vulnerabilidade subjacente, mas que ajudaria a bloquear vectores de ataque conhecidos antes de aplicar a actualização. A Microsoft testou as seguintes soluções alternativas e estados na discussão acerca de casos em que uma solução alternativa reduz a funcionalidade:
  
-   **IIS 6.0 - Configure um WPI (identidade do processo de trabalho) no IIS para um conjunto aplicacional, permitindo assim utilizar uma conta criada no Gestor de IIS e desactivar o MSDTC**
  
    Siga os seguintes passos:
  
    1.  No Gestor de IIS, expanda o computador local, expanda **Conjuntos Aplicacionais**, clique com o botão direito no conjunto aplicacional e seleccione **Propriedades**.  
    2.  Clique no separador **Identidade** e clique em **Configurável**. Nas caixas **Nome de utilizador** e **Palavra-passe**, escreva o nome de utilizador e palavra-passe da conta sob a qual deseja que o processo de trabalho opere.  
    3.  Adicione a conta de utilizador escolhida ao grupo IIS\_WPG.
  
    Desactivar o Coordenador de Transacções Distribuídas ajudará a proteger o sistema afectado contra tentativas de explorar esta vulnerabilidade. Para desactivar o Coordenador de Transacções Distribuídas, execute estes passos:
  
    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**. Alternativamente, seleccione **Definições** e depois clique em **Painel de Controlo**.  
    2.  Faça duplo clique em **Ferramentas Administrativas**. Como alternativa, clique em **Mudar para a vista clássica** e a seguir clique duas vezes sobre **Ferramentas administrativas**.  
    3.  Faça duplo clique em **Serviços**.  
    4.  Faça duplo clique em **Coordenador de Transacções Distribuídas**.  
    5.  Na lista **Tipo de arranque**, clique em **Desactivado**.  
    6.  Clique em **Parar** (se iniciado) e a seguir em **OK**.
  
    Também pode parar e desactivar o serviço MSDTC utilizando o seguinte comando na linha de comandos:  
    sc stop MSDTC & sc config MSDTC start= disabled
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado. Um exemplo é a Autenticação do Windows; consulte o [Artigo 871179 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/871179). A desactivação do MSDTC impedirá que as aplicações utilizem transacções distribuídas. Desactivar o MSDTC impedirá que o IIS 5.1 seja executado no Windows XP Professional Service Pack 2 e no Windows XP Professional Service Pack 3 e que o IIS 6.0 seja executado no modo de compatibilidade IIS 5.0. Desactivar o MSDTC impedirá a configuração e a execução de aplicações COM+.
  
-   **IIS 7.0 - Especificar um WPI para um conjunto aplicacional no Gestor de IIS**
  
    1.  No Gestor de IIS, expandir o nó do servidor, clicar em **Conjuntos Aplicacionais**, clicar com o botão direito no conjunto aplicacional e depois em **Configurações Avançadas…**  
    2.  Encontre a entrada **Identidade** e clique no botão **…** para abrir a caixa de diálogo **Identidade do Conjunto Aplicacional**.  
    3.  Seleccione a opção **Conta personalizada** e clique em **Configurar** para abrir a caixa de diálogo **Configurar credenciais**. Digite o **Nome da conta** e **Palavra-passe** escolhidos nas respectivas caixas de texto. Volte a digitar a Palavra-passe na caixa de texto **Confirmar palavra-passe** e clique em **OK**.
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS7 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
-   **IIS 7.0 - Especifique um WPI para um conjunto aplicacional utilizando o utilitário da linha de comandos APPCMD.exe**
  
    1.  A partir de uma linha de comandos elevada, mude para o directório %systemroot%\\system32\\inetsrv.  
    2.  Execute o comando APPCMD.exe utilizando a seguinte sintaxe onde *string* é o nome do conjunto aplicacional; userName:*string* é o nome de utilizador da conta atribuído ao conjunto aplicacional; e password:*string* é a palavra-passe para a conta.  
        appcmd set config /section:applicationPools /  
        \[name='string'\].processModel.identityType:SpecificUser /  
        \[name='string'\].processModel.userName:string /  
        \[name='string'\].processModel.password:string
  
    **Nota** As identidades dos conjuntos aplicacionais são adicionadas dinamicamente ao grupo IIS\_WPG no IIS 7.0 e não necessitam de ser adicionadas manualmente.
  
    **Impacto da solução alternativa:** A gestão de contas de utilizador adicionais criadas através desta solução alternativa resulta num aumento de tarefas de administração. Dependendo da natureza das aplicações executadas neste conjunto aplicacional, o desempenho das aplicações poderá ser afectado.
  
#### Perguntas Mais Frequentes sobre a Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows - CVE- 2009-0080
  
**Qual é a abrangência desta vulnerabilidade?**    
Esta é uma vulnerabilidade de elevação de privilégios. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia executar código arbitrário com privilégios LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**O que provoca a vulnerabilidade?**    
A vulnerabilidade deve-se ao facto de o Windows colocar listas de controlo de acesso (ACLs) incorrectas em threads no ThreadPool actual.
  
**O que é a Classe do ThreadPool do Windows?**    
A classe do ThreadPool do Windows fornece um conjunto de threads que pode ser utilizado para publicar itens de trabalho, processar entradas/saídas assíncronas, aguardar em nome de outros threads e processar temporizadores. Muitas aplicações criam threads que passam muito tempo adormecidos, aguardando que um evento ocorra. Outros threads podem ficar adormecidos e ser despertados apenas periodicamente para procurar uma alteração ou informação sobre o estado da actualização. O pooling de threads permite-lhe utilizar os threads mais eficientemente ao fornecer à sua aplicação um conjunto de threads de trabalho geridos pelo sistema. Um thread monitoriza o estado de várias operações em espera no conjunto de threads. Quando uma operação em espera é concluída, um thread de trabalho do conjunto de threads executa a função correspondente de chamada de retorno. Para mais informações, consulte o artigo MSDN sobre a [Classe do ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx).
  
**O que é uma Lista de Controlo de Acesso (ACL)?**    
Uma lista de controlo de acesso (ACL) é uma lista de protecções de segurança que se aplica a um objecto. O objecto pode ser um ficheiro, um processo, um evento, ou qualquer coisa que possua um descritor de segurança. Uma entrada numa ACL é uma entrada de controlo de acesso (ACE). Há dois tipos de listas de controlo de acesso: discricionário e de sistema. Cada ACE numa ACL identifica os direitos de acesso permitidos, recusados ou revistos para aquela entidade fidedigna. Para informações, consulte o artigo MSDN sobre [Listas de Controlo de Acesso](http://msdn.microsoft.com/en-us/library/aa374872(vs.85).aspx).
  
**O que é a Conta NetworkService?**    
A conta NetworkService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e actua como o computador na rede. Um serviço executado no contexto da conta NetworkService possui as credenciais do computador para servidores remotos. Para mais informações, consulte o artigo MSDN sobre a [Conta NetworkService](http://msdn.microsoft.com/en-us/library/ms684272(vs.85).aspx).
  
**O que é a Conta LocalService?**    
A conta LocalService é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem privilégios mínimos no computador local e apresenta credenciais anónimas na rede. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalService](http://msdn.microsoft.com/en-us/library/ms684188(vs.85).aspx).
  
**O que é a Conta LocalSystem?**    
A conta LocalSystem é uma conta local predefinida utilizada pelo gestor de controlo de serviços. Tem vastos privilégios no computador local e actua como o computador na rede. O seu token inclui os SIDs NT AUTHORITY\\SYSTEM e BUILTIN\\Administrators; estas contas têm acesso à maioria dos objectos de sistema. Um serviço executado no contexto da conta LocalSystem herda o contexto de segurança do [Gestor de Controlo de Serviços](http://msdn.microsoft.com/en-us/library/ms685150(vs.85).aspx). A maioria dos serviços não necessita de um nível de privilégios elevado. Para mais informações, consulte o artigo MSDN sobre a [Conta LocalSystem](http://msdn.microsoft.com/en-us/library/ms684190.aspx).
  
**Como é que o IIS é afectado por esta questão?**    
Os sistemas que executam código fornecido pelos utilizadores no Internet Information Services (IIS) podem ser afectados. Os filtros e as extensões ISAPI e a execução de códigos ASP.NET com confiança completa poderão ser afectadas por esta vulnerabilidade.
  
O IIS não é afectado nos seguintes casos:
  
-   Instalações predefinidas do IIS 5.1, IIS 6.0 e IIS 7.0  
-   ASP.NET configurado para ser executado com um nível de confiança inferior a Confiança Completa
  
**Como é que o SQL Server é afectado por esta questão?**    
Os sistemas que executam o SQL Server podem ser afectados se forem concedidos privilégios administrativos a um utilizador para carregar e executar código. Um utilizador com privilégios administrativos no SQL Server poderia executar código especialmente concebido para o efeito que poderia desencadear o ataque. Contudo, este privilégio não é concedido por predefinição.
  
**Como poderia um intruso utilizar a vulnerabilidade?**    
Um intruso que explorasse esta vulnerabilidade poderia executar código especialmente concebido para o efeito no contexto das contas NetworkService ou LocalService para aceder a recursos nos processos que também são executados como NetworkService ou LocalService. Alguns destes processos poderão ser capazes de elevar os seus privilégios para LocalSystem, permitindo também que quaisquer processos NetworkService ou LocalService elevem os seus privilégios para LocalSystem. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.
  
**Como poderia um intruso explorar a vulnerabilidade?**    
Para explorar esta vulnerabilidade, um intruso teria de iniciar primeiro sessão no sistema. Um intruso poderia executar uma aplicação especialmente concebida para explorar a vulnerabilidade e obter controlo total sobre o sistema afectado.
  
**Quais os sistemas mais susceptíveis face a esta vulnerabilidade?**    
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores podem estar mais em risco se os utilizadores sem autorizações administrativas suficientes tiverem a capacidade de iniciar sessão nos servidores e de executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.
  
Todos sistemas que executam todas as edições suportadas do Windows Vista e Windows Server 2008 poderão estar susceptíveis se o IIS estiver activado ou se o SQL Server estiver instalado, configurado ou implementado de modo vulnerável, tal como descrito neste boletim.
  
Além disso, os sistemas IIS que permitem que os utilizadores carreguem código estão mais susceptíveis. Os sistemas SQL Server estão susceptíveis se for concedido acesso privilegiado a contas a utilizadores não fidedignos. Isso poderá incluir fornecedores de alojamento na Web ou ambientes semelhantes.
  
**O que faz a actualização?**    
A actualização resolve a vulnerabilidade corrigindo as ACLs no thread do Conjunto de Threads.
  
**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**    
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2009-0080](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0080).
  
**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios indicando que esta vulnerabilidade estava a ser explorada?**    
Sim. Sim, a Microsoft tem conhecimento de ataques limitados e muito específicos que tentam explorar a vulnerabilidade.
  
### Informação de actualização
  
Orientações e ferramentas de detecção e implementação  
-----------------------------------------------------
  
<span></span>
Faça a gestão do software e actualizações de segurança de que necessita para implementação em servidores, ambientes de trabalho e sistemas portáteis na sua organização. Para mais informações, visite o [Centro de Gestão de Actualizações TechNet](http://go.microsoft.com/fwlink/?linkid=69903). O Web Site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
  
As actualizações de segurança estão disponíveis no [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt), no [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e no [Office Update](http://office.microsoft.com/pt-pt/downloads/default.aspx). As actualizações de segurança estão também disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security update".
  
Finalmente, as actualizações de segurança podem ser transferidas a partir do [Catálogo do Microsoft Update](http://go.microsoft.com/fwlink/?linkid=96155). O Catálogo do Microsoft Update permite pesquisar conteúdos disponibilizados através do Windows Update e do Microsoft Update, incluindo actualizações de segurança, controladores e service packs. Utilizando o número do boletim de segurança para pesquisar (por exemplo, "MS07-036"), pode adicionar todas as actualizações aplicáveis ao seu cesto (incluindo diferentes idiomas para uma actualização) e transferi-las para uma pasta à sua escolha. Para mais informação sobre o Catálogo do Microsoft Update, consulte as [Perguntas Mais Frequentes sobre o Catálogo do Microsoft Update](http://go.microsoft.com/fwlink/?linkid=97900).
  
**Orientações de detecção e implementação**
  
A Microsoft forneceu orientações sobre a detecção e implementação das actualizações de segurança deste mês. Estas orientações também auxiliarão os profissionais de informática a compreenderem de que forma podem usar diferentes ferramentas de suporte à implementação de actualizações de segurança, tais como o Windows Update, o Microsoft Update, o Office Update, o Microsoft Baseline Security Analyzer (MBSA), a Office Detection Tool, o Microsoft Systems Management Server (SMS) e a Extended Security Update Inventory Tool. Para obter mais informações, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723).
  
**Microsoft Baseline Security Analyzer**
  
O Microsoft Baseline Security Analyzer (MBSA) permite aos administradores procurar actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para obter mais informações acerca do MBSA, visite o Web site do [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx).
  
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.
  
| Software                                                                                                                      | MBSA 2.1 |  
|-------------------------------------------------------------------------------------------------------------------------------|----------|  
| Microsoft Windows 2000 Service Pack 4                                                                                         | Sim      |  
| Windows XP Service Pack 2 e Windows XP Service Pack 3                                                                         | Sim      |  
| Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2                                      | Sim      |  
| Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2                                                       | Sim      |  
| Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2                                              | Sim      |  
| Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium | Sim      |  
| Windows Vista e Windows Vista Service Pack 1                                                                                  | Sim      |  
| Windows Vista x64 Edition e Windows Vista x64 Edition Service Pack 1                                                          | Sim      |  
| Windows Server 2008 para sistemas de 32 bits                                                                                  | Sim      |  
| Windows Server 2008 para sistemas baseados em x64                                                                             | Sim      |  
| Windows Server 2008 para sistemas baseados em Itanium                                                                         | Sim      |
  
Para mais informações sobre o MBSA 2.1, consulte as [Perguntas Mais Frequentes sobre o MBSA 2.1](http://www.microsoft.com/technet/security/tools/mbsa2/qa.mspx).
  
**Windows Server Update Services**
  
Ao utilizar o Windows Server Update Services (WSUS), os administradores podem implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000. Para mais informações sobre como implementar esta actualização de segurança usando o Windows Server Update Services, visite o [Web site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).
  
**Systems Management Server**
  
A tabela seguinte fornece o resumo de detecções e implementação do SMS para esta actualização de segurança.
  
| Software                                                                                                                      | SMS 2.0 | SMS 2003 com SUSFP | SMS 2003 com ITMU                                                        | Configuration Manager 2007 |  
|-------------------------------------------------------------------------------------------------------------------------------|---------|--------------------|--------------------------------------------------------------------------|----------------------------|  
| Microsoft Windows 2000 Service Pack 4                                                                                         | Sim     | Sim                | Sim                                                                      | Sim                        |  
| Windows XP Service Pack 2 e Windows XP Service Pack 3                                                                         | Sim     | Sim                | Sim                                                                      | Sim                        |  
| Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2                                      | Não     | Não                | Sim                                                                      | Sim                        |  
| Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2                                                       | Sim     | Sim                | Sim                                                                      | Sim                        |  
| Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2                                              | Não     | Não                | Sim                                                                      | Sim                        |  
| Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium | Não     | Não                | Sim                                                                      | Sim                        |  
| Windows Vista e Windows Vista Service Pack 1                                                                                  | Não     | Não                | Consultar a **Nota para o Windows Vista e Windows Server 2008** em baixo | Sim                        |  
| Windows Vista x64 Edition e Windows Vista x64 Edition Service Pack 1                                                          | Não     | Não                | Consultar a **Nota para o Windows Vista e Windows Server 2008** em baixo | Sim                        |  
| Windows Server 2008 para sistemas de 32 bits                                                                                  | Não     | Não                | Consultar a **Nota para o Windows Vista e Windows Server 2008** em baixo | Sim                        |  
| Windows Server 2008 para sistemas baseados em x64                                                                             | Não     | Não                | Consultar a **Nota para o Windows Vista e Windows Server 2008** em baixo | Sim                        |  
| Windows Server 2008 para sistemas baseados em Itanium                                                                         | Não     | Não                | Consultar a **Nota para o Windows Vista e Windows Server 2008** em baixo | Sim                        |
  
Para o SMS 2.0 e SMS 2003, o SMS SUS Feature Pack (SUSFP), que inclui a ferramenta Security Update Inventory Tool (SUIT), pode ser usado pelo SMS para detectar actualizações de segurança. Consulte também as [transferências para o Systems Management Server 2.0](http://technet.microsoft.com/en-us/sms/bb676799.aspx).
  
Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para mais informações sobre o SMS 2003 ITMU, consulte [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office. Para mais informações sobre a ferramenta Office Inventory Tool e outras ferramentas de análise, consulte [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). Consulte também as [transferências para o Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx).
  
O System Center Configuration Manager 2007 utiliza o WSUS 3.0 para a detecção de actualizações. Para mais informações sobre o Configuration Manager 2007 Software Update Management, visite o [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx).
  
**Nota para o Windows Vista e Windows Server 2008** O Microsoft Systems Management Server 2003 com Service Pack 3 inclui suporte para gestão do Windows Vista e Windows Server 2008.
  
Para mais informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).
  
Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.
  
**Update Compatibility Evaluator e Application Compatibility Toolkit**
  
É frequente as actualizações utilizarem os mesmos ficheiros e configurações de registo necessários para a execução das aplicações. Isso pode dar origem a incompatibilidades e aumentar o tempo necessário para a implementação de actualizações de segurança. Pode simplificar o teste e a validação de actualizações do Windows relativamente às aplicações instaladas com os componentes do [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) incluído no [Application Compatibility Toolkit 5.0](http://www.microsoft.com/downloads/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en).
  
O Application Compatibility Toolkit (ACT) contém as ferramentas e documentação necessárias para avaliar e atenuar questões de compatibilidade da aplicação antes de implementar o Microsoft Windows Vista, uma Actualização do Windows, uma Actualização de Segurança da Microsoft ou uma nova versão do Windows Internet Explorer no seu ambiente.
  
Implementação da Actualização de Segurança  
------------------------------------------
  
<span></span>
**Software Afectado**
  
Para obter mais informações sobre a actualização de segurança específica do software afectado, clique na ligação adequada:
  
#### Windows 2000 (todas as edições)
  
**Tabela de referência**
  
A tabela seguinte contém a informação sobre a actualização de segurança para este software. Pode encontrar informações adicionais na subsecção **Informações de implementação**, nesta secção.

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs Futuros</strong></td>
<td style="border:1px solid black;">A actualização para esta questão poderá ser incluída num conjunto de actualizações futuro</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implementação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem intervenção do utilizador</td>
<td style="border:1px solid black;">Para Microsoft Windows 2000 Service Pack 4:<br />
Windows2000-KB952004-x86-ENU /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Instalação sem reiniciar</td>
<td style="border:1px solid black;">Para Microsoft Windows 2000 Service Pack 4:<br />
Windows2000-KB952004-x86-ENU /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Ficheiro log da actualização</td>
<td style="border:1px solid black;">kb952004.log</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Informações adicionais</td>
<td style="border:1px solid black;">Consultar a subsecção <strong>Orientações e ferramentas de detecção e implementação</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Requisito de Reinício</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Reinício necessário?</td>
<td style="border:1px solid black;">Sim, é necessário reiniciar o sistema depois de aplicar esta actualização de segurança.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HotPatching</td>
<td style="border:1px solid black;">Não aplicável</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações de Remoção</strong></td>
<td style="border:1px solid black;">Para Microsoft Windows 2000 Service Pack 4:<br />
Utilize a ferramenta <strong>Adicionar ou Remover Programas</strong> no Painel de Controlo ou o utilitário Spuninst.exe que está localizado na pasta %Windir%\$NTUninstallKB952004$\Spuninst</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações de Ficheiros</strong></td>
<td style="border:1px solid black;">Consulte o <a href="http://support.microsoft.com/kb/959454">Artigo 959454 da Base de Dados de Conhecimento da Microsoft</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Verificação da Chave de Registo</strong></td>
<td style="border:1px solid black;">Para Microsoft Windows 2000 Service Pack 4: 
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB952004</td>
</tr>
</tbody>
</table>
 

#### Informações de Implementação

**Instalação da actualização**

Quando instala esta actualização de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.

Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre o programa de instalação, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841).

**Remoção da actualização**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Verificar se a actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a secção "**Orientações e ferramentas de detecção e implementação**" mais acima neste boletim para obter mais informações.

-   **Verificação das Versões dos Ficheiros**

    Dado existirem várias edições do Microsoft Windows, os passos que se seguem podem ser diferentes no seu sistema. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da edição do sistema operativo, ou dos programas instalados no sistema, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no sistema, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança consultando as chaves de registo listadas na **Tabela de referência**, nesta secção.

    Estas chaves de registo poderão não conter uma lista completa dos ficheiros instalados. Além disso, estas chaves de registo poderão não ser criadas correctamente se um administrador ou um OEM integrar ou associar esta actualização de segurança aos ficheiros de origem de instalação do Windows.

#### Windows XP (todas as edições)

**Tabela de referência**

A tabela seguinte contém a informação sobre a actualização de segurança para este software. Pode encontrar informações adicionais na subsecção **Informações de implementação**, nesta secção.

 
<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs Futuros</strong></td>
<td style="border:1px solid black;">A actualização para esta questão será incluída num service pack ou num conjunto de actualizações futuros</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implementação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem intervenção do utilizador</td>
<td style="border:1px solid black;">Para Windows XP Service Pack 2 e Windows XP Service Pack 3:<br />
WindowsXP-KB952004-x86-ENU /quiet<br />
WindowsXP-KB956572-x86-ENU /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2:<br />
WindowsServer2003.WindowsXP-KB952004-x64-ENU /quiet<br />
WindowsServer2003.WindowsXP-KB956572-x64-ENU /quiet</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem reiniciar</td>
<td style="border:1px solid black;">Windows XP Service Pack 2 e Windows XP Service Pack 3:<br />
WindowsXP-KB952004-x86-ENU /norestart<br />
WindowsXP-KB956572-x86-ENU /norestart</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2:<br />
WindowsServer2003.WindowsXP-KB952004-x64-ENU /norestart<br />
WindowsServer2003.WindowsXP-KB956572-x64-ENU /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Ficheiro log da actualização</td>
<td style="border:1px solid black;">KB952004.log<br />
KB956572.log</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Informações adicionais</td>
<td style="border:1px solid black;">Consultar a subsecção <strong>Orientações e ferramentas de detecção e implementação</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Requisito de Reinício</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Reinício necessário?</td>
<td style="border:1px solid black;">Sim, é necessário reiniciar o sistema depois de aplicar esta actualização de segurança.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HotPatching</td>
<td style="border:1px solid black;">Não aplicável</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações de Remoção</strong></td>
<td style="border:1px solid black;">Utilize a ferramenta <strong>Adicionar ou Remover Programas</strong> no Painel de Controlo ou o utilitário Spuninst.exe que está localizado nas pastas %Windir%\$NTUninstallKB952004$\Spuninst e %Windir%\$NTUninstallKB956572$\Spuninst</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações de Ficheiros</strong></td>
<td style="border:1px solid black;">Consulte o <a href="http://support.microsoft.com/kb/959454">Artigo 959454 da Base de Dados de Conhecimento da Microsoft</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Verificação da Chave de Registo</strong></td>
<td style="border:1px solid black;">Para todas as edições suportadas de 32 bits do Windows XP:<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB952004<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB956572</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para todas as edições baseadas em x64 do Windows XP suportadas:<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB952004\Filelist<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB956572\Filelist</td>
</tr>
</tbody>
</table>
 

**Nota** Para versões do Windows XP Professional x64 Edition suportadas, esta actualização de segurança é a mesma que para as versões do Windows Server 2003 x64 Edition suportadas.

#### Informações de Implementação

**Instalação da actualização**

Quando instala esta actualização de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.

Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre o programa de instalação, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841).

**Remoção da actualização**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Verificar se a actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a secção "**Orientações e ferramentas de detecção e implementação**" mais acima neste boletim para obter mais informações.

-   **Verificação das Versões dos Ficheiros**

    Dado existirem várias edições do Microsoft Windows, os passos que se seguem podem ser diferentes no seu sistema. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da edição do sistema operativo, ou dos programas instalados no sistema, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no sistema, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança consultando as chaves de registo listadas na **Tabela de referência**, nesta secção.

    Estas chaves de registo poderão não conter uma lista completa dos ficheiros instalados. Além disso, estas chaves de registo poderão não ser criadas correctamente se um administrador ou um OEM integrar ou associar esta actualização de segurança aos ficheiros de origem de instalação do Windows.

#### Windows Server 2003 (todas as edições)

**Tabela de referência**

A tabela seguinte contém a informação sobre a actualização de segurança para este software. Pode encontrar informações adicionais na subsecção **Informações de implementação**, nesta secção.

 
<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs Futuros</strong></td>
<td style="border:1px solid black;">A actualização para esta questão será incluída num service pack ou num conjunto de actualizações futuros</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implementação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem intervenção do utilizador</td>
<td style="border:1px solid black;">Para todas as edições de 32 bits do Windows Server 2003 suportadas:<br />
WindowsServer2003-KB952004-x86-ENU /quiet<br />
WindowsServer2003-KB956572-x86-ENU /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para todas as edições baseadas em x64 do Windows Server 2003 suportadas:<br />
WindowsServer2003.WindowsXP-KB952004-x64-ENU /quiet<br />
WindowsServer2003.WindowsXP-KB956572-x64-ENU /quiet</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para todas as edições baseadas em Itanium do Windows Server 2003 suportadas:<br />
WindowsServer2003-KB952004-ia64-ENU /quiet<br />
WindowsServer2003-KB956572-ia64-ENU /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Instalação sem reiniciar</td>
<td style="border:1px solid black;">Para todas as edições de 32 bits do Windows Server 2003 suportadas:<br />
WindowsServer2003-KB952004-x86-ENU /norestart<br />
WindowsServer2003-KB956572-x86-ENU /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para todas as edições baseadas em x64 do Windows Server 2003 suportadas:<br />
WindowsServer2003.WindowsXP-KB952004-x64-ENU /norestart<br />
WindowsServer2003.WindowsXP-KB956572-x64-ENU /norestart</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"></td>
<td style="border:1px solid black;">Para todas as edições baseadas em Itanium do Windows Server 2003 suportadas:<br />
WindowsServer2003-KB952004-ia64-ENU /norestart<br />
WindowsServer2003-KB956572-ia64-ENU /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Ficheiro log da actualização</td>
<td style="border:1px solid black;">KB952004.log<br />
KB956572.log</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Informações adicionais</td>
<td style="border:1px solid black;">Consultar a subsecção <strong>Orientações e ferramentas de detecção e implementação</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Requisito de Reinício</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Reinício necessário?</td>
<td style="border:1px solid black;">Sim, é necessário reiniciar o sistema depois de aplicar esta actualização de segurança.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HotPatching</td>
<td style="border:1px solid black;">Esta actualização de segurança não suporta HotPatching. Para obter mais informações sobre HotPatching, consulte o Artigo 897341 da Base de Dados de Conhecimento da Microsoft.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações de Remoção</strong></td>
<td style="border:1px solid black;">Utilize a ferramenta <strong>Adicionar ou Remover Programas</strong> no Painel de Controlo ou o utilitário Spuninst.exe que está localizado nas pastas %Windir%\$NTUninstallKB952004$\Spuninst e %Windir%\$NTUninstallKB956572$\Spuninst</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações de Ficheiros</strong></td>
<td style="border:1px solid black;">Consulte o <a href="http://support.microsoft.com/kb/959454">Artigo 959454 da Base de Dados de Conhecimento da Microsoft</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Verificação da Chave de Registo</strong></td>
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB952004\Filelist<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB956572\Filelist</td>
</tr>
</tbody>
</table>
 

#### Informações de Implementação

**Instalação da actualização**

Quando instala esta actualização de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.

Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre o programa de instalação, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta muitos dos parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841).

**Remoção da actualização**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da Configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a secção "**Orientações e ferramentas de detecção e implementação**" mais acima neste boletim para obter mais informações.

-   **Verificação das Versões dos Ficheiros**

    Dado existirem várias edições do Microsoft Windows, os passos que se seguem podem ser diferentes no seu sistema. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da edição do sistema operativo, ou dos programas instalados no sistema, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no sistema, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança consultando as chaves de registo listadas na **Tabela de referência**, nesta secção.

    Estas chaves de registo poderão não conter uma lista completa dos ficheiros instalados. Além disso, estas chaves de registo poderão não ser criadas correctamente se um administrador ou um OEM integrar ou associar esta actualização de segurança aos ficheiros de origem de instalação do Windows.

#### Windows Vista (todas as edições)

**Tabela de referência**

A tabela seguinte contém a informação sobre a actualização de segurança para este software. Pode encontrar informações adicionais na subsecção **Informações de implementação**, nesta secção.

 
<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs Futuros</strong></td>
<td style="border:1px solid black;">A actualização para esta questão será incluída num service pack ou num conjunto de actualizações futuros</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implementação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem intervenção do utilizador</td>
<td style="border:1px solid black;">Para todas as edições suportadas de 32 bits do Windows Vista:<br />
Windows6.0-KB952004-x86 /quiet<br />
Windows6.0-KB956572-x86 /quiet<br />
<br />
Para todas as edições baseadas em x64 do Windows Vista suportadas:<br />
Windows6.0-KB952004-x64 /quiet<br />
Windows6.0-KB956572-x64 /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Instalação sem reiniciar</td>
<td style="border:1px solid black;">Para todas as edições suportadas de 32 bits do Windows Vista:<br />
Windows6.0-KB952004-x86 /quiet /norestart<br />
Windows6.0-KB956572-x86 /quiet /norestart<br />
<br />
Para todas as edições baseadas em x64 do Windows Vista suportadas:<br />
Windows6.0-KB952004-x64 /quiet /norestart<br />
Windows6.0-KB956572-x64 /quiet /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Informações adicionais</td>
<td style="border:1px solid black;">Consultar a subsecção <strong>Orientações e ferramentas de detecção e implementação</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Requisito de Reinício</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Reinício necessário?</td>
<td style="border:1px solid black;">Sim, é necessário reiniciar o sistema depois de aplicar esta actualização de segurança.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HotPatching</td>
<td style="border:1px solid black;">Não aplicável.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações de Remoção</strong></td>
<td style="border:1px solid black;">O WUSA.exe não suporta a desinstalação de actualizações. Para desinstalar uma actualização instalada pelo WUSA, clique em <strong>Painel de Controlo</strong> e, depois, clique em <strong>Segurança</strong>. Em Windows Update, clique em <strong>Ver actualizações instaladas</strong> e seleccione-a a partir da lista de actualizações.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações de Ficheiros</strong></td>
<td style="border:1px solid black;">Consulte o <a href="http://support.microsoft.com/kb/959454">Artigo 959454 da Base de Dados de Conhecimento da Microsoft</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Verificação da Chave de Registo</strong></td>
<td style="border:1px solid black;"><strong>Nota</strong> Não existe uma chave de registo para validar a presença desta actualização.</td>
</tr>
</tbody>
</table>
  
#### Informações de Implementação
  
**Instalação da actualização**
  
Quando instala esta actualização de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.
  
Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).
  
Esta actualização de segurança suporta os seguintes parâmetros de configuração.
  
| Parâmetro         | Descrição                                                                                                                                            |  
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|  
| **/?, /h, /help** | Apresenta ajuda para os parâmetros suportados.                                                                                                       |  
| **/quiet**        | Elimina a janela de mensagem de estado ou de erro.                                                                                                   |  
| **/norestart**    | Quando combinado com **/quiet**, o sistema não será reiniciado depois da instalação, mesmo que seja necessário reiniciar para concluir a instalação. |
  
**Nota** Para mais informações sobre o programa de instalação wusa.exe, consulte o [Artigo 934307 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/934307).
  
**Verificar se a actualização foi aplicada**
  
-   **Microsoft Baseline Security Analyzer**
  
    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a secção "**Orientações e ferramentas de detecção e implementação**" mais acima neste boletim para obter mais informações.
  
-   **Verificação das Versões dos Ficheiros**
  
    Dado existirem várias edições do Microsoft Windows, os passos que se seguem podem ser diferentes no seu sistema. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.
  
    1.  Clique em **Iniciar** e depois introduza um nome de ficheiro de actualização em **Iniciar pesquisa**.  
    2.  Quando o ficheiro aparecer em **Programas**, clique com o botão direito do rato no nome do ficheiro e depois em **Propriedades**.  
    3.  No separador **Geral**, compare o tamanho do ficheiro com as tabelas de informação de ficheiros fornecidas no artigo da Base de Dados de Conhecimento do boletim.  
    4.  Também pode clicar no separador **Detalhes** e comparar informações, como a versão de ficheiro e a data de modificação, com as tabelas de informação fornecidas no artigo da Base de Dados de Conhecimento do boletim.  
    5.  Por fim, também pode clicar no separador **Versões anteriores** e comparar a informação de ficheiros sobre a versão anterior do ficheiro com a informação da versão do ficheiro nova ou actualizada.
  
#### Windows Server 2008 (todas as edições)
  
**Tabela de referência**
  
A tabela seguinte contém a informação sobre a actualização de segurança para este software. Pode encontrar informações adicionais na subsecção **Informações de implementação**, nesta secção.

 
<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs Futuros</strong></td>
<td style="border:1px solid black;">A actualização para esta questão será incluída num service pack ou num conjunto de actualizações futuros</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implementação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalação sem intervenção do utilizador</td>
<td style="border:1px solid black;">Para todas as edições de 32 bits do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-x86 /quiet<br />
Windows6.0-KB956572-x86 /quiet<br />
<br />
Para todas as edições baseadas em x64 do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-x64 /quiet<br />
Windows6.0-KB956572-x64 /quiet<br />
<br />
Para todas as edições baseadas em Itanium do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-ia64 /quiet<br />
Windows6.0-KB956572-ia64 /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Instalação sem reiniciar</td>
<td style="border:1px solid black;">Para todas as edições de 32 bits do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-x86 /quiet /norestart<br />
Windows6.0-KB956572-x86 /quiet /norestart<br />
<br />
Para todas as edições baseadas em x64 do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-x64 /quiet /norestart<br />
Windows6.0-KB956572-x64 /quiet /norestart<br />
<br />
Para todas as edições baseadas em Itanium do Windows Server 2008 suportadas:<br />
Windows6.0-KB952004-ia64 /quiet /norestart<br />
Windows6.0-KB956572-ia64 /quiet /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Informações adicionais</td>
<td style="border:1px solid black;">Consultar a subsecção <strong>Orientações e ferramentas de detecção e implementação</strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Requisito de Reinício</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Reinício necessário?</td>
<td style="border:1px solid black;">Sim, é necessário reiniciar o sistema depois de aplicar esta actualização de segurança.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HotPatching</td>
<td style="border:1px solid black;">Não aplicável.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações de Remoção</strong></td>
<td style="border:1px solid black;">O WUSA.exe não suporta a desinstalação de actualizações. Para desinstalar uma actualização instalada pelo WUSA, clique em <strong>Painel de Controlo</strong> e, depois, clique em <strong>Segurança</strong>. Em Windows Update, clique em <strong>Ver actualizações instaladas</strong> e seleccione-a a partir da lista de actualizações.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações de Ficheiros</strong></td>
<td style="border:1px solid black;">Consulte o <a href="http://support.microsoft.com/kb/959454">Artigo 959454 da Base de Dados de Conhecimento da Microsoft</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Verificação da Chave de Registo</strong></td>
<td style="border:1px solid black;"><strong>Nota</strong> Não existe uma chave de registo para validar a presença desta actualização.</td>
</tr>
</tbody>
</table>
  
#### Informações de Implementação
  
**Instalação da actualização**
  
Quando instala esta actualização de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.
  
Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).
  
Esta actualização de segurança suporta os seguintes parâmetros de configuração.
  
| Parâmetro         | Descrição                                                                                                                                            |  
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|  
| **/?, /h, /help** | Apresenta ajuda para os parâmetros suportados.                                                                                                       |  
| **/quiet**        | Elimina a janela de mensagem de estado ou de erro.                                                                                                   |  
| **/norestart**    | Quando combinado com **/quiet**, o sistema não será reiniciado depois da instalação, mesmo que seja necessário reiniciar para concluir a instalação. |
  
**Nota** Para mais informações sobre o programa de instalação wusa.exe, consulte o [Artigo 934307 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/934307).
  
**Verificar se a actualização foi aplicada**
  
-   **Microsoft Baseline Security Analyzer**
  
    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a secção "**Orientações e ferramentas de detecção e implementação**" mais acima neste boletim para obter mais informações.
  
-   **Verificação das Versões dos Ficheiros**
  
    Dado existirem várias edições do Microsoft Windows, os passos que se seguem podem ser diferentes no seu sistema. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.
  
    1.  Clique em **Iniciar** e depois introduza um nome de ficheiro de actualização em **Iniciar pesquisa**.  
    2.  Quando o ficheiro aparecer em **Programas**, clique com o botão direito do rato no nome do ficheiro e depois em **Propriedades**.  
    3.  No separador **Geral**, compare o tamanho do ficheiro com as tabelas de informação de ficheiros fornecidas no artigo da Base de Dados de Conhecimento do boletim.  
    4.  Também pode clicar no separador **Detalhes** e comparar informações, como a versão de ficheiro e a data de modificação, com as tabelas de informação fornecidas no artigo da Base de Dados de Conhecimento do boletim.  
    5.  Por fim, também pode clicar no separador **Versões anteriores** e comparar a informação de ficheiros sobre a versão anterior do ficheiro com a informação da versão do ficheiro nova ou actualizada.
  
### Outras informações
  
#### Agradecimentos
  
A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:
  
-   Cesar Cerrudo, da [Argeniss](http://www.argeniss.com/), por fornecer informações sobre a Vulnerabilidade de Isolamento de Serviços MSDTC do Windows (CVE-2008-1436), Vulnerabilidade de Isolamento de Serviços WMI do Windows (CVE-2009-0078), Vulnerabilidade de Isolamento de Serviços RPCSS do Windows (CVE-2009-0079) e Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows (CVE-2009-0080)
  
#### Microsoft Active Protections Program (MAPP)
  
Para melhorar as protecções de segurança dos clientes, a Microsoft fornece informações sobre as vulnerabilidades aos principais fornecedores de software de segurança antes de cada publicação mensal de actualizações de segurança. Os fornecedores de software de segurança podem então utilizar estas informações sobre as vulnerabilidades para assegurar protecções actualizadas aos clientes através do seu software ou dispositivos de segurança, tais como antivírus, sistemas de detecção de intrusos com base na rede ou sistemas de prevenção de intrusões com base no anfitrião. Para determinar se as protecções activas estão disponíveis nos fornecedores de software de segurança, visite os Web sites de protecções activas disponibilizados pelos parceiros do programa, indicados na lista de [parceiros do Microsoft Active Protections Program (MAPP)](http://www.microsoft.com/security/msrc/mapp/partners.mspx).
  
#### Assistência
  
-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico através do [Suporte de Segurança](http://go.microsoft.com/fwlink/?linkid=21131) ou da linha 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas. Para obter mais informações sobre opções de suporte disponíveis, consulte a [Ajuda e Suporte da Microsoft](http://support.microsoft.com/).  
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).
  
#### Exclusão de garantia
  
As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.
  
#### Revisões
  
-   V1.0 (14 de Abril de 2009): Boletim publicado.  
-   V1.1 (15 de Abril de 2009): Secção de Perguntas Mais Frequentes corrigida quanto à Vulnerabilidade de Fraqueza da ACL do Conjunto de Threads do Windows (CVE-2009-0080) para retirar uma entrada errada sobre "o que faz a actualização". Trata-se de uma alteração informativa apenas.  
-   V1.2 (22 de Abril de 2009): Adicionada entrada à secção de **Perguntas Mais Frequentes relativas a esta Actualização de Segurança** para comunicar que a secção de **Questões conhecidas relacionadas com esta actualização de segurança**, referida no Artigo 959454 da Base de Dados de Conhecimento, foi actualizada. Trata-se de uma alteração informativa apenas.  
-   V2.0 (29 de Abril de 2009): Adicionada uma entrada à secção de **Perguntas Mais Frequentes relativas a esta Actualização de Segurança** para comunicar o relançamento da actualização do idioma norueguês para o Microsoft Windows 2000 Service Pack 4 (KB952004). Os clientes que necessitam da actualização do idioma norueguês devem transferir e instalar a actualização relançada. Nenhuma outra actualização ou configuração local é afectada por este relançamento.
  
*Built at 2014-04-18T01:50:00Z-07:00*
