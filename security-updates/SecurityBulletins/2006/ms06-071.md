---
TOCTitle: 'MS06-071'
Title: 'Microsoft Security Bulletin MS06-071 - Crítica'
ms:assetid: 'ms06-071'
ms:contentKeyID: 61234185
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms06-071(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS06-071 - Crítica
==============================================

Vulnerabilidade no Microsoft XML Core Services poderia permitir Execução Remota de Código (928088)
--------------------------------------------------------------------------------------------------

Data de publicação: 14 de novembro de 2006 | Updated: 15 de novembro de 2006

**actualizada:** 1.1

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o Microsoft Windows e que tenham instalado o Microsoft XML Core Services (MSXML) 4.0 ou Microsoft XML Core Services (MSXML) 6.0

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes que tenham as versões vulneráveis do MSXML instaladas no seu sistema operativo são afectados e devem implementar imediatamente esta actualização

**Substituição de Actualizações de Segurança:** Este boletim substitui uma actualização de segurança anterior. Consulte a secção de Perguntas mais frequentes deste boletim para obter a lista completa.

**Avisos:** Nenhum

**Componentes Testados do Microsoft Windows:**

**Componentes afectados:**

-   Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) – [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=24b7d141-6cdf-4fc4-a91b-6f18fe6921d4) (KB927978)
-   Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) – [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=9ae7f4e9-8228-4098-af71-49c35684c17e) (KB927977)

**Software Não Afectado:**

-   Microsoft XML Core Services 3.0
-   Microsoft XML Core Services 5.0

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve uma vulnerabilidade recentemente descoberta e divulgada publicamente. A vulnerabilidade está documentada neste boletim na respectiva subsecção, em "Detalhes sobre a Vulnerabilidade".

Se um utilizador tiver sessão iniciada com privilégios administrativos, um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter controlo total sobre um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                                | Impacto da Vulnerabilidade | Microsoft XML Core Services 4.0 | Microsoft XML Core Services 6.0 |
|-----------------------------------------------------------------------------------------------------------------------------------|----------------------------|---------------------------------|---------------------------------|
| Vulnerabilidade no Microsoft XML Core Services - [CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745) | Execução Remota de Código  | Crítica                         | Crítica                         |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Posso implementar esta actualização de segurança após ter aplicado as soluções alternativas fornecidas no Aviso de Segurança da Microsoft 927892?**
Os clientes que implementaram as soluções alternativas fornecidas no Aviso de Segurança da Microsoft 927892 poderão aplicar esta actualização de segurança sem problemas.

**Tenho uma instalação predefinida do Windows sem aplicações instaladas. Sou afectado por esta vulnerabilidade?**
Nenhuma versão do Windows inclui as versões vulneráveis do Microsoft XML Core Services.

**Como é que posso determinar se tenho o Microsoft XML Core Services 4.0 e o Microsoft XML Core Services 6.0 no meu sistema?**
Por predefinição, as versões vulneráveis do Microsoft XML Core Services 4.0 e Microsoft XML Core Services 6.0 não são incluídas em quaisquer versões do Windows. Contudo, estão disponíveis para transferência versões vulneráveis do Microsoft XML Core Services e também podem ter sido redistribuídas por software adicional. Os clientes que pretendem determinar se possuem o Microsoft XML Core Services 4.0 ou o Microsoft XML Core Services 6.0 nos seus sistemas, podem seguir os passos indicados abaixo em “Informações de Actualização de Segurança” para “Verificação das Versões dos Ficheiros” e confirmar a existência do msxml4.dll ou do msxml6.dll. As versões anteriores a 4.20.9841.0 para o msxlm4.dll e 6.0.3890.0 para o msxml6.dll são vulneráveis e devem ser actualizadas. Para além disso, o MBSA 1.2.1, MBSA 2.0, SMS 2.0, SMS 2003 e WSUS também podem ser utilizados para determinar se esta actualização de segurança é necessária.

Os clientes que tenham as versões vulneráveis do Microsoft XML Core Services instaladas no seu sistema operativo são afectados e devem implementar imediatamente esta actualização

**O Windows** **Vista** **é vulnerável a esta questão?**
O Windows Vista não inclui as versões vulneráveis do Microsoft XML Core Services. O Windows Vista inclui a versão 6.10.1129 do msxml6.dll e não está vulnerável. Contudo, se foi executada uma aplicação que instalou uma versão vulnerável do Microsoft XML Core Services 4.0, deve aplicar esta actualização

**Quais são das diferentes versões do Microsoft XML Core Services e que aplicações poderiam instalá-las no meu sistema?**
Muitas aplicações podem instalar o Microsoft XML Core Services e não está disponível uma lista completa. Para obter informações sobre diferentes versões do Microsoft XML Core Services disponíveis e os principais produtos Microsoft que as instalam, consulte o [Artigo 269238 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/269238).

**Que actualizações são substituídas por esta edição?**
Esta actualização de segurança substitui uma anterior. O ID do boletim de segurança e os componentes afectados encontram-se listados na seguinte tabela.

| Identificação do Boletim                                                | Microsoft XML Core Services 4.0 | Microsoft XML Core Services 6.0 |
|-------------------------------------------------------------------------|---------------------------------|---------------------------------|
| [**MS06-061**](http://technet.microsoft.com/security/bulletin/ms06-061) | Substituído                     | Substituído                     |

**Nota** Esta actualização de segurança apenas substitui a actualização de segurança [**MS06-061**](http://technet.microsoft.com/security/bulletin/ms06-061) para o Microsoft XML Core Services 4.0 e o Microsoft XML Core Services 6.0, uma vez que o Microsoft XML Core Services 3.0 e o Microsoft XML Core Services 5.0 não são afectados**.**

**O suporte alargado a actualizações de segurança para o Microsoft Windows 98, Windows 98 Second Edition ou Windows Millennium Edition terminou a 11 de Julho de 2006. Ainda utilizo um destes sistemas operativos - o que devo fazer?**
O Windows 98, Windows 98 Second Edition e Windows Millennium Edition chegaram ao fim dos respectivos ciclos de vida de suporte. Os utilizadores que tenham estas versões do sistema operativo deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o seguinte Web site Ciclo de Vida de Suporte de Produto Microsoft. Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o Web site de Suporte Técnico da Microsoft.

**O suporte alargado a actualizações de segurança para o Microsoft Windows NT Workstation 4.0 Service Pack 6a e Windows 2000 Service Pack 2 terminou a 30 de Junho de 2004. O suporte alargado a actualizações de segurança para o Microsoft Windows NT Server 4.0 Service Pack 6a terminou a 31 de Dezembro de 2004. O suporte alargado a actualizações de segurança para o Microsoft Windows 2000 Service Pack 3 terminou a 30 de Junho de 2005. Ainda utilizo um destes sistemas operativos - o que devo fazer?**
O Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a, Windows 2000 Service Pack 2 e Windows 2000 Service Pack 3 chegaram ao fim dos respectivos suportes de ciclos de vida. Os utilizadores que tenham estas versões do sistema operativo deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o [Web site do Ciclo de Vida do Suporte da Microsoft](http://support.microsoft.com/lifecycle/). Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o [Web site de Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que necessitem de suporte personalizado para estes produtos devem contactar o seu representante de equipa de contas da Microsoft, o seu Gestor Técnico de Contas ou o parceiro ou representante Microsoft adequado para mais informações sobre opções de suporte personalizado. Os clientes que não disponham de um Contrato Alliance, Premier ou Autorizado podem contactar a subsidiária local da Microsoft. Para obter informações de contacto, visite o [Web site Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), seleccione o país e, em seguida, clique em **Go** para ver uma lista de números de telefone. Quando telefonar, peça para falar com o Gestor de Vendas de Suporte Premier local. Para mais informações, consulte as [Perguntas mais frequentes de suporte sobre o ciclo de vida de produto, relativas aos sistemas operativos Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**O suporte alargado a actualizações de segurança para o Microsoft Windows XP Home Edition Service Pack 1 ou Service Pack 1a, Windows XP Media Center Edition 2002 Service Pack 1, Windows XP Media Center Edition 2004 Service Pack 1, Windows XP Professional Service Pack 1 ou Service Pack 1a e Windows XP Tablet PC Edition Service Pack 1 terminou a 10 de Outubro de 2006. Ainda utilizo um destes sistemas operativos, o que devo fazer?**
O Windows XP (todas as versões) Service Pack 1 chegou ao fim do respectivo ciclo de vida de suporte. Os utilizadores que tenham estas versões do sistema operativo deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o seguinte Web site Ciclo de Vida de Suporte de Produto Microsoft. Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o Web site de Suporte Técnico da Microsoft.

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Produto                                                                        | MBSA 1.2.1 | MBSA 2.0 |
|--------------------------------------------------------------------------------|------------|----------|
| Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) | Sim        | Sim      |
| Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) | Sim        | Sim      |

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para mais informações sobre programas que o Microsoft Update e o MBSA 2.0 não detectam actualmente, consulte o [artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723).

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Produto                                                                        | SMS 2.0 | SMS 2003 |
|--------------------------------------------------------------------------------|---------|----------|
| Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) | Sim     | Sim      |
| Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) | Sim     | Sim      |

Os utilizadores do SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem utilizar o MBSA 1.2.1 para detecção e, por isso, têm a mesma limitação listada anteriormente neste boletim, relacionada com programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool (SUIT), pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre o SUIT, visite o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/). Para mais informações sobre as limitações do SUIT, consulte [o artigo 306460 da base de dados de conhecimento da Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para mais informações sobre o SMS 2003 ITMU, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723).

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade no Microsoft XML Core Services - CVE-2006-5745:

Existe uma vulnerabilidade no controlo ActiveX XMLHTTP no Microsoft XML Core Services que poderia permitir a execução remota de código. Um intruso poderia explorar a vulnerabilidade construindo uma página Web especialmente concebida para o efeito que poderia potencialmente permitir a execução remota de código se um utilizador visitasse essa página ou clicasse numa hiperligação numa mensagem de correio electrónico. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter o controlo total de um sistema afectado. No entanto, é necessária interacção por parte do utilizador para explorar esta vulnerabilidade.

#### Factores atenuantes para a Vulnerabilidade no Microsoft XML Core Services - CVE-2006-5745:

-   O Microsoft XML Core Services 4.0 e o Microsoft XML Core Services 6.0 não são incluídos em quaisquer versões do Windows.
-   Num cenário de ataque com base na Web, um intruso teria de alojar um Web site contendo uma página Web que fosse utilizada para tirar partido desta vulnerabilidade. Um intruso não conseguiria obrigar os utilizadores a visitarem a página. Em vez disso, um intruso teria de persuadir os utilizadores a visitar o Web site, levando-os normalmente a clicar numa hiperligação presente numa mensagem de correio electrónico, ou num programa de mensagens instantâneas, que levasse o utilizador para o Web site do intruso.
-   Um intruso que conseguisse explorar esta vulnerabilidade com êxito poderia obter os mesmos privilégios que o utilizador com sessão iniciada. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.
-   A zona de Sites restritos ajuda a reduzir os ataques que tentem explorar esta vulnerabilidade, ao impedir a utilização de Scripts Activos durante a leitura de mensagens de correio electrónico em HTML. Contudo, se um utilizador clicar numa hiperligação numa mensagem de correio electrónico, poderá continuar vulnerável a esta questão através de um cenário de ataque baseado na Web.
    Por predefinição, o Outlook Express 6, o Outlook 2002 e o Outlook 2003 abrem mensagens de correio electrónico HTML na zona de Sites restritos. Além disso, o Outlook 2000 abre mensagens de correio electrónico em HTML na zona de sites Restritos se tiver sido instalada a Actualização de Segurança do correio electrónico do Outlook. O Outlook Express 5.5 Service Pack 2 abre mensagens de correio electrónico em HTML na zona de Sites restritos se o [Boletim de Segurança Microsoft MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018) tiver sido instalado.
-   Por predefinição, o Internet Explorer do Windows Server 2003 é executado no modo restrito, conhecido como a [Configuração de Segurança Avançada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo define o nível de segurança para a zona da Internet como Elevado. Este é um factor atenuante para Web sites que não foram adicionados à Zona de sites fidedignos do Internet Explorer. Consulte a secção de Perguntas mais frequentes sobre esta actualização de segurança para obter mais informações acerca da Configuração de Segurança Avançada do Internet Explorer.

#### Soluções Alternativas para a Vulnerabilidade no Microsoft XML Core Services - CVE-2006-5745:

A Microsoft testou as seguintes soluções alternativas. Embora estas soluções alternativas não corrijam a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Evite a execução de controlos ActiveX XMLHTTP 4.0 e XMLHTTP 6.0 no Internet Explorer.**

    Pode desactivar tentativas de instanciar estes controlos ActiveX no Internet Explorer definindo o kill bit para os controlos no registo.

    **Aviso** Se utilizar o Editor de Registo incorrectamente, pode causar problemas sérios que podem vir a obrigar à reinstalação do seu sistema operativo. A Microsoft não pode garantir que consiga resolver problemas que resultam da utilização incorrecta do Editor de Registo. A utilização do Editor de Registo é da sua responsabilidade.

    Para obter informações detalhadas sobre o que pode usar para impedir que um controlo seja executado no Internet Explorer, consulte o [Artigo 240797 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/240797). Siga os passos apresentados neste artigo para criar um valor Compatibility Flags no registo para impedir que o objecto COM seja instanciado no Internet Explorer:

    1.  Para definir o kill bit para um controlo CLSID com o valor de {88d969c5-f192-11d4-a65f-0040963251e5} (XMLHTTP 4.0 no Microsoft XML Core Services 4.0) e {88d96a0a-f192-11d4-a65f-0040963251e5} (XMLHTTP 6.0 no Microsoft XML Core Services 6.0) cole o seguinte texto num editor de texto como o Notepad. Depois, guarde o ficheiro com a extensão de nome de ficheiro .reg:

        Editor de registo do Windows versão 5.00

        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d969c5-f192-11d4-a65f-0040963251e5}\] "Compatibility Flags"=dword:00000400

        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d96a0a-f192-11d4-a65f-0040963251e5}\] "Compatibility Flags"=dword:00000400

    2.  Pode aplicar este ficheiro .reg a sistemas individuais ao clicar duas vezes sobre ele. Pode ainda aplicá-lo através de domínios usando uma Política de Grupo. Para mais informações sobre as Políticas de Grupos, consulte os seguintes Web sites da Microsoft:

        [Conjunto de Política de Grupos](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)

        [O que é o Editor de Objectos da Política de Grupos?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

        [Ferramentas e definições da Política de Grupos Central](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)

    **Nota** Tem de reiniciar o Internet Explorer para que as alterações tenham efeito.

    **Impacto da solução alternativa:** Os Web sites que utilizam os controlos ActiveX XMLHTTP 4.0 ou XMLHTTP 6.0 podem não abrir ou não funcionar correctamente.

    Esta actualização de segurança não faz automaticamente a anulação das operações do kill bit para estes controlos ActiveX. Para anular as operações do kill bit, siga estes passos:

    1.  Para anular as operações do kill bit, cole o seguinte texto num editor de texto como o Notepad. Depois, guarde o ficheiro com a extensão de nome de ficheiro .reg:

        Editor de registo do Windows versão 5.00

        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d969c5-f192-11d4-a65f-0040963251e5}\]

        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d96a0a-f192-11d4-a65f-0040963251e5}\]

    2.  Pode aplicar este ficheiro .reg a sistemas individuais ao clicar duas vezes sobre ele. Pode ainda aplicá-lo através de domínios usando uma Política de Grupo. Para mais informações sobre as Políticas de Grupos, consulte os seguintes Web sites da Microsoft:

        [Conjunto de Política de Grupos](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)

        [O que é o Editor de Objectos da Política de Grupos?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

        [Ferramentas e definições da Política de Grupos Central](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)

    **Nota** Tem de reiniciar o Internet Explorer para que as alterações tenham efeito.

-   **Negar acesso aos CLSIDs afectados para o Microsoft XML Core Services 4.0 ({88D969C5-F192-11D4-A65F-0040963251E5}) e Microsoft XML Core Services 6.0 ({88D96A0A-F192-11D4-A65F-0040963251E5}) no registo**

    Para modificar o acesso aos CLSIDs afectados para Windows 2000, siga estes passos:

    1.  Clique em **Iniciar**, seleccione a opção **Executar**, introduza "**regedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT** e expanda **CLSID**.
    3.  **Para Microsoft XML Core Services 4.0 clique em**: **{88D969C5-F192-11D4-A65F-0040963251E5}**

        Para Microsoft XML Core Services 6.0 clique em: **{88D96A0A-F192-11D4-A65F-0040963251E5}**

    4.  Clique em **Segurança** e a seguir clique em **Permissões**.

        **Nota** Tome nota das permissões que são apresentadas nesta caixa de diálogo, para que possa recuperar os seus valores originais mais tarde.

    5.  Clique de forma a desactivar a caixa de verificação **Herdar do objecto principal as entradas de permissões que se aplicam a objectos secundários**. É-lhe pedido que clique em **Copiar**, **Remover**, ou **Cancelar**. Clique em **Remover** e a seguir em **OK**.
    6.  Aparece uma mensagem a informar que ninguém poderá aceder a esta chave de registo. Clique em **Sim** quando essa mensagem surgir.

    Para modificar o acesso para os CLSIDs afectados para Windows XP Service Pack 2 e sistemas operativos posteriores, siga estes passos:

    1.  Clique em **Iniciar**, seleccione a opção **Executar**, introduza "**regedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT** e expanda **CLSID**.
    3.  **Para Microsoft XML Core Services 4.0 clique em**: **{88D969C5-F192-11D4-A65F-0040963251E5}**

        Para Microsoft XML Core Services 6.0 clique em: **{88D96A0A-F192-11D4-A65F-0040963251E5}**

    4.  Clique em **Editar** e a seguir clique em **Permissões**.

        **Nota** Tome nota das permissões que são apresentadas nesta caixa de diálogo, para que possa recuperar os seus valores originais mais tarde.

    5.  Clique em **Avançadas**.
    6.  Clique de forma a desactivar a caixa de verificação **Herdar do objecto principal as entradas de permissões que se aplicam a objectos secundários. Incluir estas nas entradas definidas explicitamente aqui.** É-lhe pedido que clique em **Copiar**, **Remover**, ou **Cancelar**. Clique em **Remover** e a seguir em **OK**.
    7.  Aparece uma mensagem a informar que ninguém poderá aceder a esta chave de registo. Clique em **Sim** quando essa mensagem surgir e clique em **OK** para fechar a caixa de diálogo **Permissões para {88D969C5-F192-11D4-A65F-0040963251E5}** ou **Permissões para {88D96A0A-F192-11D4-A65F-0040963251E5}** (dependendo do CLSID escolhido).

    **Impacto da solução alternativa:** Os Web sites que utilizam os controlos ActiveX XMLHTTP 4.0 ou XMLHTTP 6.0 podem não abrir ou não funcionar correctamente.

-   **Configure o Internet Explorer de forma a que seja pedida uma confirmação antes de executar Scripts Activos ou desactive os Scripts Activos nas zonas de segurança de Intranet Local e Internet.**

    Pode ajudar a proteger-se contra esta vulnerabilidade mudando as definições, para que seja pedida uma confirmação antes de executar Scripts Activos, ou desactivando os Scripts Activos, nas zonas de segurança de Internet e de Intranet local. Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique no separador **Segurança**.
    3.  **Clique em Internet** e, em seguida, clique em **Personalizar Nível**.
    4.  Em **Definições**, na secção **Processamento de Scripts**, em **Processamento de Scripts Activo**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK**.
    5.  Clique em **Intranet Local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Definições**, na secção **Processamento de Scripts**, em **Processamento de Scripts Activo**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK**.
    7.  Clique duas vezes em **OK** para voltar ao Internet Explorer.

    **Nota** Desactivar Scripts Activos nas zonas de Internet e Intranet local pode fazer com que alguns Web sites não funcionem correctamente. Se tiver dificuldade em usar o Web site depois de alterar esta definição e tiver a certeza de que o site é seguro, pode adicionar esse site à sua lista de sites fidedignos. Isto fará com que o site funcione correctamente.

    **Nota** Depois de definir o Internet Explorer para requerer solicitação antes de executar controlos ActiveX e/ou Scripts Activos nas zonas da Internet e da Intranet Local, pode adicionar sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer. Isto irá permitir que continue a utilizar os Web sites fidedignos da mesma forma que actualmente, enquanto ajuda a proteger-se contra este ataque a sites não fidedignos. A Microsoft recomenda que adicione à Zona de sites fidedignos unicamente sites que considere fidedignos.

    Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique no separador **Segurança**.
    2.  Na caixa **Seleccione uma zona de conteúdo da Web para especificar as respectivas definições de segurança**, clique em **Sites Fidedignos** e, em seguida, clique em **Sites**.
    3.  Se quiser adicionar sites que não precisam de um canal encriptado, desmarque a caixa de verificação **Pedir verificação de servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este Web site à zona** escreva o URL do site que considera fidedigno e, em seguida, clique em **Adicionar**.
    5.  Repita estes passos para cada site que pretenda adicionar à zona.
    6.  Clique duas vezes em **OK** para aceitar as alterações e voltar ao Internet Explorer.

    **Nota** Desactivar Scripts Activos nas zonas de Internet e Intranet local pode fazer com que alguns Web sites não funcionem correctamente. Há dois em particular que pode querer adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem aspas). Estes são os sites que alojam a actualização e requerem a utilização de um controlo ActiveX para instalar a actualização.

    **Impacto da solução alternativa:** Os pedidos de confirmação antes de executar Scripts Activos têm efeitos que pode não desejar. Muitos Web sites na Internet ou numa intranet utilizam Scripts Activos para fornecer funcionalidades adicionais. Por exemplo, um site de comércio electrónico online ou alguns sites de operações bancárias podem utilizar Scripts Activos para fornecer menus, formulários de encomenda ou mesmo extractos bancários. Os pedidos de confirmação antes de executar Scripts Activos são uma definição global que afecta todos os sites da Internet e intranet. Ser-lhe-á pedida frequentemente a confirmação quando activar esta solução alternativa. Para cada pedido, se achar que pode confiar no site que está a visitar, clique em Sim para executar os Scripts Activos. Se não quiser que lhe seja pedida a confirmação para todos estes sites, efectue os passos indicados em "Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer”.

-   **Configure o Internet Explorer de forma a que seja pedida uma confirmação antes de executar controlos ActiveX, ou desactive-os nas zonas de segurança de Intranet Local e Internet.**

    Pode ajudar a proteger-se contra esta vulnerabilidade alterando as definições do Internet Explorer para pedir confirmação antes de executar controlos ActiveX. Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique no separador **Segurança**.
    3.  **Clique em Internet** e, em seguida, clique em **Personalizar Nível**.
    4.  Em **Definições**, na secção **Controlos e extensões ActiveX**, em **Executar controlos e extensões ActiveX**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK**.
    5.  Clique em **Intranet Local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Definições**, na secção **Controlos e extensões ActiveX**, em **Executar controlos e extensões ActiveX**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK**.
    7.  Clique duas vezes em **OK** para voltar ao Internet Explorer.

    **Nota** Depois de definir o Internet Explorer para requerer solicitação antes de executar controlos ActiveX e/ou Scripts Activos nas zonas da Internet e da Intranet Local, pode adicionar sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer. Isto irá permitir que continue a utilizar os Web sites fidedignos da mesma forma que actualmente, enquanto ajuda a proteger-se contra este ataque a sites não fidedignos. A Microsoft recomenda que adicione à Zona de sites fidedignos unicamente sites que considere fidedignos.

    Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique no separador **Segurança**.
    2.  Na caixa **Seleccione uma zona de conteúdo da Web para especificar as respectivas definições de segurança**, clique em **Sites Fidedignos** e, em seguida, clique em **Sites**.
    3.  Se quiser adicionar sites que não precisam de um canal encriptado, desmarque a caixa de verificação **Pedir verificação de servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este Web site à zona** escreva o URL do site que considera fidedigno e, em seguida, clique em **Adicionar**.
    5.  Repita estes passos para cada site que pretenda adicionar à zona.
    6.  Clique duas vezes em **OK** para aceitar as alterações e voltar ao Internet Explorer.

    **Nota** Desactivar Scripts Activos nas zonas de Internet e Intranet local pode fazer com que alguns Web sites não funcionem correctamente. Há dois em particular que pode querer adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem aspas). Estes são os sites que alojam a actualização e requerem a utilização de um controlo ActiveX para instalar a actualização.

    **Impacto da solução alternativa:** Existem efeitos secundários da confirmação antes de executar controlos ActiveX. Muitos Web sites na Internet ou numa intranet utilizam o ActiveX para fornecer funcionalidades adicionais. Por exemplo, um site de comércio electrónico online ou sites de operações bancárias podem utilizar controlos ActiveX para fornecer menus, formulários de encomenda ou mesmo extractos bancários. A solicitação de confirmação antes de executar controlos ActiveX é uma definição global que afecta todos os sites da Internet e intranet. Ser-lhe-á pedida frequentemente a confirmação quando activar esta solução alternativa. Para cada pedido, se achar que pode confiar no site que está a visitar, clique em **Sim** para executar os controlos ActiveX. Se não quiser que lhe seja pedida a confirmação para todos estes sites, efectue os passos indicados em "Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer”.

-   **Configure as definições das zonas de segurança Internet e Intranet Local para “Alta” para que lhe seja pedida confirmação antes de executar controlos e scripts ActiveX nas zonas Internet e Intranet Local.**

    Pode ajudar a proteger-se contra esta vulnerabilidade alterando as definições da zona de segurança da Internet para pedir confirmação antes de executar controlos e scripts ActiveX. Pode contribuir para isso definindo a segurança do seu browser para **Alta**.

    Para aumentar o nível de segurança do browser no Microsoft Internet Explorer:

    1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.
    2.  Na caixa de diálogo **Opções da Internet**, clique no separador **Segurança** e, em seguida, clique no ícone **Internet**.
    3.  Em **Nível de segurança para esta zona**, mova o cursor para **Alta**. Isso define o nível de segurança para Alto para todos os Web sites que visita.

    **Nota** Se não vir nenhum cursor, clique em **Nível predefinido** e, em seguida, mova o cursor para **Alto.**

    **Nota** Definir o nível para Alto pode fazer com que alguns Web sites funcionem incorrectamente. Se tiver dificuldade em usar o Web site depois de alterar esta definição e tiver a certeza de que o site é seguro, pode adicionar esse site à sua lista de sites fidedignos. Isso permitirá que o site funcione correctamente, mesmo com a definição de segurança configurada para alto.

    De outro modo, pode alterar as suas definições para pedir confirmação antes de executar controlos ActiveX apenas se seguir os passos seguintes:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique no separador **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Personalizar Nível**.
    4.  Em **Definições**, na secção **Controlos e extensões ActiveX**, em **Executar controlos e extensões ActiveX**, clique em **Pedir.**
    5.  Na secção **Processamento de Scripts**, em **Processamento de Scripts Activos**,****clique em **Pedir** e, em seguida, clique em OK.
    6.  Clique em **Intranet Local** e, em seguida, clique em **Nível Personalizado**.
    7.  Em **Definições**, na secção **Controlos e suplementos ActiveX**, em **Executar controlos e suplementos ActiveX**, clique em **Pedir**.
    8.  Na secção **Processamento de scripts**, em **Processamento de Scripts Activos**,****clique em Pedir.
    9.  Clique duas vezes em **OK** para voltar ao Internet Explorer.

    **Impacto da solução alternativa:** Existem efeitos secundários da confirmação antes de executar controlos ActiveX. Muitos Web sites na Internet ou numa intranet utilizam o ActiveX para fornecer funcionalidades adicionais. Por exemplo, um site de comércio electrónico online ou sites de operações bancárias podem utilizar controlos ActiveX para fornecer menus, formulários de encomenda ou mesmo extractos bancários. A solicitação de confirmação antes de executar controlos ActiveX é uma definição global que afecta todos os sites da Internet e intranet. Ser-lhe-á pedida frequentemente a confirmação quando activar esta solução alternativa. Para cada pedido, se achar que pode confiar no site que está a visitar, clique em **Sim** para executar os controlos ActiveX. Se não quiser que lhe seja pedida a confirmação para todos este sites, utilize a solução alternativa "Restringir os Web sites apenas aos considerados fidedignos".

#### Perguntas mais frequentes sobre a Vulnerabilidade no Microsoft XML Core Services - CVE-2006-5745:

**Qual é a abrangência desta vulnerabilidade?**
Trata-se de uma vulnerabilidade que poderia permitir a execução remota de código. Um intruso poderia explorar a vulnerabilidade construindo uma página Web especialmente concebida para o efeito que pudesse conduzir à execução remota de código se um utilizador visitasse essa página ou clicasse numa hiperligação numa mensagem de correio electrónico especialmente concebida. Se um utilizador tiver sessão iniciada com privilégios administrativos, um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter controlo total sobre um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.

**O que provoca a vulnerabilidade?**
O Controlo ActiveX XMLHTTP incluído no Microsoft XML Core Services poderia, se forem transmitidos dados inesperados, fazer com que o Internet Explorar falhasse de um modo que permitisse a execução remota de código.

**O que é o Microsoft XML Core Services (MSXML)?**
O Microsoft XML Core Services (MSXML) proporciona implementações de conformidade com os padrões para: XML 1.0 (APIs DOM e SAX2), XML Schema (XSD) 1.0, XPath 1.0 e XSLT 1.0. Permite que os programadores concebam aplicações baseadas em XML em Jscript, Visual Basic Scripting Edition (VBScript), Visual Basic 6.0 e native C++ que possibilitam a interoperabilidade com outras aplicações aderentes ao padrão XML 1.0. Consulte o [Web site da MSDN](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/b24aafc2-bf1b-4702-bf1c-b7ae3597eb0c.asp) para obter mais informações sobre MSXML.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que conseguisse tirar partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Como poderia um intruso explorar a vulnerabilidade?**
Um intruso poderia alojar um Web site especialmente concebido para o efeito, destinado a tirar partido desta vulnerabilidade através do Internet Explorer, persuadindo depois um utilizador a ver o Web site em questão. Isto também pode incluir Web sites que aceitam conteúdos fornecidos por utilizadores ou publicidade, Web sites que alojam conteúdos fornecidos por utilizadores ou publicidade e Web sites nocivos. Estes Web sites podem conter conteúdos especialmente concebidos para o efeito, que poderiam explorar esta vulnerabilidade. Contudo, em qualquer dos casos, o intruso não teria forma de forçar os utilizadores a visitar estes Web sites. Em vez disso, o intruso teria de persuadir os utilizadores a visitar o Web site, levando-os normalmente a clicar numa hiperligação numa mensagem de correio electrónico, ou num pedido de mensagem instantânea que leva o utilizador para o Web site do intruso. Também poderia ser possível exibir conteúdos Web nocivos concebidos especialmente para o efeito, usando espaços de publicidade como banners, ou usando outros métodos para entregar conteúdos Web a sistemas afectados.

**Quais os sistemas mais susceptíveis a esta vulnerabilidade?**
Esta vulnerabilidade exige que um utilizador tenha sessão iniciada e que visite um Web site para que ocorra qualquer acção nociva. Deste modo, qualquer sistema onde o Internet Explorer seja frequentemente utilizado, como as estações de trabalho ou servidores de terminal dos utilizadores, está mais susceptível a esta vulnerabilidade. Os sistemas que não sejam normalmente utilizados para visitar Web sites, como os sistemas de servidor, correm pouco risco.

**Tenho o Internet Explorer no Windows Server 2003. Isto atenua alguma destas vulnerabilidades?**
Sim. Por predefinição, o Internet Explorer do Windows Server 2003 é executado no modo restrito, conhecido como a [Configuração de Segurança Avançada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo define o nível de segurança para a zona da Internet como Elevado. Este é um factor atenuante para Web sites que não foram adicionados à Zona de sites fidedignos do Internet Explorer.

**O que é a Configuração de Segurança Avançada do Internet Explorer?**
A Configuração de Segurança Avançada do Internet Explorer é um grupo de definições pré-configuradas do Internet Explorer que reduz a probabilidade de um utilizador ou de um administrador transferir e executar conteúdos Web especialmente concebidos para o efeito num servidor. A Configuração de Segurança Avançada do Internet Explorer reduz o risco, modificando muitas definições relacionadas com segurança. Isso inclui as definições no separador **Segurança** e o separador **Avançado** na caixa de diálogo das **Opções da Internet**. Algumas das modificações importantes incluem o seguinte:

-   O nível de segurança para a zona da Internet está definido como **Elevado**. Esta definição desactiva scripts, controlos ActiveX, Microsoft Java Virtual Machine (MSJVM) e transferências de ficheiros.
-   A detecção automática de sites da intranet está desactivada. Esta definição atribui todos os Web sites da intranet e todos os caminhos da Convenção de Nomenclatura Universal (UNC, Universal Naming Convention), que não estejam listados explicitamente na zona da Intranet Local, para a zona da Internet.
-   A instalação a pedido e extensões do browser que não sejam da Microsoft estão desactivados. Esta definição impede as páginas Web de instalarem automaticamente componentes e impede a execução de extensões que não sejam da Microsoft.
-   O conteúdo multimédia está desactivado. Esta definição impede a execução de música, animação e reprodução de vídeo.

Para obter mais informações sobre a Configuração de Segurança Avançada do Internet Explorer, consulte o guia de gestão da configuração de segurança avançada do Internet Explorer, no seguinte [Web site](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en%20http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en).

**O que faz a actualização?**
A actualização elimina a vulnerabilidade modificando a forma como o Controlo ActiveX XMLHTTP executa a validação de parâmetros.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum CVE-2006-5745.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido informações sobre a exploração desta vulnerabilidade?**
Sim. Quando o boletim de segurança foi publicado, a Microsoft já tinha recebido informações de que esta vulnerabilidade estava a ser explorada.

**A aplicação desta actualização de segurança ajuda a proteger os clientes contra o código que foi divulgado publicamente e que tenta explorar esta vulnerabilidade?**
Sim. Esta actualização de segurança corrige a vulnerabilidade actualmente explorada. À vulnerabilidade que foi corrigida foi atribuído o número de Vulnerabilidade e Exposição Comum CVE-2006-5745.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica do software afectado, clique na ligação adequada:

#### Microsoft XML Core Services 4 quando instalado no Windows (todas as versões)

**Inclusão em Service Packs Futuros**
A actualização para este problema será incluída num conjunto de actualizações futuro.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção do utilizador, utilize o seguinte comando numa linha de comandos para o Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1:

**msxml4-KB927978-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB927978.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem forçar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos para o Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1:

**msxml4-KB927978-enu /norestart**

**Nota** Todos os parâmetros da linha de comando são baseados no Windows Installer 3.0. Os clientes com o Windows Installer 2.0 podem executar o seguinte comando para uma instalação sem problemas, sem ser necessário reiniciar o computador e para guardar um registo com informações detalhadas:

**msxml4-KB927978-enu /q REBOOT=ReallySuppress /l\*v c:\\KB927978.log**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Esta versão do Microsoft XML Core Services é instalada lado a lado com versões anteriores do MSXML4. Siga estes passos para remover a actualização de segurança:

1.  Remova a actualização de segurança 927978 utilizando a ferramenta Adicionar ou remover programas, no Painel de controlo.
2.  Elimine o ficheiro Msxml4.dll da pasta %SystemRoot%\\System32.
3.  Faça a reparação do ficheiro Msxml4.dll anterior utilizando a ferramenta Adicionar ou remover programas, no Painel de controlo.

**Nota** As versões anteriores dos ficheiros Msxml4.dll e Msxml4r.dll são restauradas na pasta %SystemRoot%\\System32 e também na pasta lado a lado %SystemRoot%\\WinSxS.

**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Microsoft XML Core Services 4.0:

| Nome do Ficheiro | Versão      | Data       | Hora | Tamanho |
|------------------|-------------|------------|------|---------|
| MSXML4.dll       | 4.20.9841.0 | 11-04-2006 | 2:14 | 1,18 MB |

**Nota** Esta actualização de segurança é instalada na pasta %SystemRoot%\\System32 e na pasta lado a lado %SystemRoot%\\WinSxS.

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a pergunta frequente, “Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?” na secção de Perguntas mais frequentes relativas a esta actualização de segurança, publicada neste boletim.

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
        **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

#### Microsoft XML Core Services 6 quando instalado no Windows (todas as versões)

**Inclusão em Service Packs Futuros**
A actualização para este problema será incluída num conjunto de actualizações futuro.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção do utilizador, utilize o seguinte comando numa linha de comandos para o Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1:

**msxml6-KB927977-enu-x86 /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB927977.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem forçar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos para o Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1:

**msxml6-KB927977-enu-x86 /norestart**

**Nota** Todos os parâmetros da linha de comando são baseados no Windows Installer 3.0. Os clientes com o Windows Installer 2.0 podem executar o seguinte comando para uma instalação sem problemas, sem ser necessário reiniciar o computador e para guardar um registo com informações detalhadas:

**msxml6-KB927977-enu-x86 /q REBOOT=ReallySuppress /l\*v c:\\KB927977.log**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

**Nota** A remoção desta actualização de segurança para o Microsoft XML Core Services 6 removerá completamente o MSXML6 do computador.

**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Microsoft XML Core Services 6.0:

| Nome do Ficheiro | Versão     | Data       | Hora | Tamanho |
|------------------|------------|------------|------|---------|
| MSXML6.dll       | 6.0.3890.0 | 11-04-2006 | 8:25 | 1,25 MB |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a pergunta frequente, “Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?” na secção de Perguntas mais frequentes relativas a esta actualização de segurança, publicada neste boletim.

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
        **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\MSXML 6.0 Parser e SDK\\CurrentVersion

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente quando um administrador ou um OEM integrar ou associar a actualização de segurança 927977 aos ficheiros de origem de instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Robert Freeman, da [ISS](http://www.iss.net/), por trabalhar connosco na Vulnerabilidade no Microsoft XML Core Services ([CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745)).
-   Dror Shalev e Moti Jospeh, da [Checkpoint](http://www.checkpoint.com/), por trabalharem connosco na Vulnerabilidade no Microsoft XML Core Services ([CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745)).

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outras questões de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Centro de Gestão de Actualizações TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166).
-   [Office Update](http://office.microsoft.com/pt-pt/officeupdate/default.aspx)

**Software Update Services:**

Utilizando os Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scan Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (14 de Novembro de 2006): Boletim publicado.
-   V1.1 (15 de Novembro de 2006): Boletim actualizado: o nome do ficheiro executável para o msxml6 foi actualizado com o nome correcto e o ficheiro log foi actualizado com o número correcto da Base de dados de conhecimento. Foi também adicionada clarificação extra em relação aos componentes do boletim anterior que esta actualização substitui.

*Built at 2014-04-18T01:50:00Z-07:00*
