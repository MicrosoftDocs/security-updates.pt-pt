---
TOCTitle: 'MS06-047'
Title: 'Microsoft Security Bulletin MS06-047 - Crítica'
ms:assetid: 'ms06-047'
ms:contentKeyID: 61234123
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms06-047(v=Security.10)'
author: SharonSears
ms.author: SharonSears
---

Security Bulletin

Microsoft Security Bulletin MS06-047 - Crítica
==============================================

Vulnerabilidade no Microsoft Visual Basic for Applications poderia permitir Execução Remota de Código (921645)
--------------------------------------------------------------------------------------------------------------

Data de publicação: 8 de agosto de 2006 | Updated: 15 de agosto de 2006

**actualizada:** 1.1

#### Resumo

**Quem deve ler este documento:** Os clientes que utilizam aplicações Microsoft Office ou aplicações que utilizam o Microsoft Visual Basic for Applications.

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes deverão aplicar de imediato a actualização

**Substituição de Actualizações de Segurança:** Este boletim substitui uma actualização de segurança anterior. Consulte a secção de Perguntas mais frequentes deste boletim para obter a lista completa.

**Avisos:** Nenhum

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   Microsoft Office 2000 Service Pack 3 — [Transferir a actualização (KB920822)](http://www.microsoft.com/downloads/details.aspx?familyid=837a4fa9-fabc-4119-9aaf-2c8663029d2b)
-   Microsoft Project 2000 Service Release 1 — [Transferir a actualização (KB920822)](http://www.microsoft.com/downloads/details.aspx?familyid=744dd25d-b9a7-4e30-b64e-1c9bb0f87d90)
-   Microsoft Access 2000 Runtime Service Pack 3 — [Transferir a actualização (KB920822)](http://www.microsoft.com/downloads/details.aspx?familyid=ed5a8c40-c592-4299-afb2-5f0f6e2b1dcd)
-   Microsoft Office XP Service Pack 3 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=b26adc3c-1db8-46fd-8381-b199ee351e7c)
-   Microsoft Project 2002 Service Pack 1 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=62ef50aa-6061-4185-9713-f8c31b195103)
-   Microsoft Visio 2002 Service Pack 2 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=43525b6a-58b7-49c7-88d8-4983d1614a96)
-   Microsoft Works Suites:
    -   Microsoft Works Suite 2004 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=b26adc3c-1db8-46fd-8381-b199ee351e7c) (a mesma actualização para o Microsoft Office XP)
    -   Microsoft Works Suite 2005 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=b26adc3c-1db8-46fd-8381-b199ee351e7c) (a mesma actualização para o Microsoft Office XP)
    -   Microsoft Works Suite 2006 — [Transferir a actualização (KB920821)](http://www.microsoft.com/downloads/details.aspx?familyid=b26adc3c-1db8-46fd-8381-b199ee351e7c) (a mesma actualização para o Microsoft Office XP)
-   Microsoft Visual Basic for Applications SDK 6.0 — [Transferir a actualização (KB923167)](http://www.microsoft.com/downloads/details.aspx?familyid=424df92a-3cc4-4b72-b2f8-d45ed2a8f4b3)
-   Microsoft Visual Basic for Applications SDK 6.2 — [Transferir a actualização (KB923167)](http://www.microsoft.com/downloads/details.aspx?familyid=424df92a-3cc4-4b72-b2f8-d45ed2a8f4b3)
-   Microsoft Visual Basic for Applications SDK 6.3 — [Transferir a actualização (KB923167)](http://www.microsoft.com/downloads/details.aspx?familyid=424df92a-3cc4-4b72-b2f8-d45ed2a8f4b3)
-   Microsoft Visual Basic for Applications SDK 6.4 — [Transferir a actualização (KB923167)](http://www.microsoft.com/downloads/details.aspx?familyid=424df92a-3cc4-4b72-b2f8-d45ed2a8f4b3)

**Software Não Afectado:**

-   Microsoft Office 2003 Service Pack 1 e Microsoft Office 2003 Service Pack 2

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve uma vulnerabilidade recentemente descoberta e comunicada de forma privada. A vulnerabilidade está documentada na secção "Detalhes sobre a Vulnerabilidade" deste boletim.

Nas versões vulneráveis do Office ou do Microsoft Visual Basic for Applications, se um utilizador tiver iniciado sessão com direitos de administrador, um intruso que explorasse com sucesso esta vulnerabilidade poderia assumir o controlo total sobre um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                                  | Impacto da Vulnerabilidade | Microsoft Office 2000 | Microsoft Office XP | Microsoft Visual Basic for Applications SDK 6.0, 6.2, 6.3 e 6.4 |
|-------------------------------------------------------------------------------------------------------------------------------------|----------------------------|-----------------------|---------------------|-----------------------------------------------------------------|
| Vulnerabilidade no Visual Basic for Applications - [CVE-2006-3649](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3649) | Execução Remota de Código  | Crítica               | Importante          | Importante                                                      |

**Nota** As classificações de gravidade para o Microsoft Works Suite estão associadas às versões para o Microsoft Office da seguinte forma:

-   A classificação de gravidade para o Microsoft Works Suite 2004, 2005 e 2006 é a mesma do Microsoft Office XP.

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Que actualizações são substituídas por esta edição?**
Esta actualização de segurança substitui uma anterior. O ID do boletim de segurança e os sistemas operativos afectados encontram-se listados na seguinte tabela.

| Identificação do Boletim | Microsoft Office 2000, Project 2000 Service Release 1 e Access 2000 Runtime Service Pack 3 | Microsoft Office XP, Project 2002 Service Pack 1 e Visio 2002 Service Pack 2 | Microsoft Visual Basic for Applications SDK 6.0, 6.2 e 6.3 | Microsoft Visual Basic for Applications SDK 6.4 |
|--------------------------|--------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------------------------------------------------------|-------------------------------------------------|
| **MS03-037**             | Substituído                                                                                | Não aplicável                                                                | Substituído                                                | Não aplicável                                   |

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**

A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Produto                   | MBSA 1.2.1 | MBSA 2.0 |
|---------------------------|------------|----------|
| **Microsoft Office 2000** | Sim        | Não      |
| **Microsoft Office XP**   | Sim        | Sim      |

**Nota** O MBSA 1.2.1 utiliza uma versão integrada da ferramenta Office Detection Tool (ODT) que não suporta análises remotas desta actualização de segurança. Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

**Nota** O MSBA não suporta Microsoft Visual Basic for Applications SDK 6.0, 6.2, 6.3 e 6.4.

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para mais informações sobre programas que o Microsoft Update e o MBSA 2.0 não detectam actualmente, consulte o [artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660).

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Produto                   | SMS 2.0 | SMS 2003 |
|---------------------------|---------|----------|
| **Microsoft Office 2000** | Sim     | Não      |
| **Microsoft Office XP**   | Sim     | Sim      |

O SMS utiliza o MBSA para fins de detecção. Por conseguinte, o SMS tem as mesmas limitações listadas anteriormente neste boletim relacionadas com programas que o MBSA não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool, pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre a ferramenta Security Update Inventory Tool, consulte o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/). Para mais informações sobre as limitações da ferramenta Security Update Inventory Tool, consulte o [artigo 306460 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool para actualizações de software Microsoft pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obter mais informações sobre a ferramenta SMS 2003 Inventory Tool for Microsoft Updates, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=50757). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade no Visual Basic for Applications - CVE-2006-3649

Existe uma vulnerabilidade de execução remota de código no Visual Basic for Applications (VBA) devido à forma como este verifica as propriedades de um documento que uma aplicação alojadora transfere quando abre um documento. Esta vulnerabilidade poderia permitir que um intruso que explorasse a vulnerabilidade com sucesso obtivesse controlo total do sistema afectado.

#### Factores atenuantes para a Vulnerabilidade no Visual Basic for Applications - CVE-2006-3649:

-   Um intruso que explore com sucesso esta vulnerabilidade poderia obter os mesmos privilégios que o utilizador local. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.
-   No Outlook 2002 e Outlook 2003, a vulnerabilidade não pode ser automaticamente explorada através de correio electrónico. Um utilizador teria de clicar num anexo e, em seguida, ler um aviso e aceitar o pedido para **Abrir** antes de a vulnerabilidade poder ser explorada.
-   No cenário de um ataque baseado na Web, um intruso poderia alojar um Web site contendo uma página Web que fosse utilizada para explorar esta vulnerabilidade. Além disso, os Web sites afectados e os Web sites que aceitam ou alojam conteúdos ou anúncios fornecidos por utilizadores poderiam conter conteúdos especialmente concebidos que poderiam explorar esta vulnerabilidade. Contudo, em qualquer dos casos, o intruso não teria forma de forçar os utilizadores a visitar estes Web sites. Em vez disso, um intruso teria de persuadir os utilizadores a visitar o Web site, levando-os normalmente a clicar numa hiperligação presente numa mensagem de correio electrónico, ou num programa de mensagens instantâneas, que levasse o utilizador para o Web site do intruso.

**Nota** Os produtos Office 2000 não solicitam ao utilizador para **Abrir**, **Guardar**, ou **Cancelar** antes de abrir um documento.

#### Soluções alternativas para a Vulnerabilidade no Visual Basic for Applications - CVE-2006-3649:

A Microsoft testou as seguintes soluções alternativas. Apesar de estas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

**Não abra ou guarde ficheiros Microsoft Office que tenha recebido de fontes não-fidedignas, ou que recebeu de fontes fidedignas, mas que de alguma forma não correspondem ao que é habitual.**

É possível tirar partido desta vulnerabilidade quando um utilizador abre um ficheiro.

#### Perguntas mais frequentes sobre a Vulnerabilidade no Visual Basic for Applications - CVE-2006-3649:

**Qual é a abrangência desta vulnerabilidade?**
Existe uma vulnerabilidade de execução remota de código no Visual Basic for Applications (VBA) devido à forma como este verifica as propriedades de um documento que uma aplicação alojadora transfere quando abre um documento. Esta vulnerabilidade poderia permitir que um intruso que explorasse esta vulnerabilidade com sucesso obtivesse controlo total do sistema afectado.

**O que provoca a vulnerabilidade?**
A vulnerabilidade resulta da forma como o VBA verifica determinadas propriedades de documentos que uma aplicação alojadora transfere para o mesmo ao abrir um documento. Por isso, é possível que uma aplicação alojadora transfira parâmetros não verificados para o VBA, dando origem a uma condição de sobrecarga da memória intermédia que poderia permitir a execução de código arbitrário.

**O que é o Visual Basic for Applications (VBA)?**
O Microsoft VBA é uma tecnologia de programação para o desenvolvimento de aplicações compactadas de ambiente de trabalho de clientes e para as integrar em dados e em sistemas existentes. O Microsoft VBA baseia-se no sistema de programação Microsoft Visual Basic. Os produtos Microsoft Office incluem o VBA e utilizam-no para executar determinadas funções. O VBA também pode ser usado para construir aplicações personalizadas baseadas numa aplicação alojadora existente.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que conseguisse tirar partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Como poderia um intruso explorar a vulnerabilidade?**
Para que um ataque pudesse ter sucesso, um utilizador teria de abrir um documento especialmente concebido que lhe tivesse sido enviado por um intruso. Este documento poderia ser de qualquer tipo que suportasse VBA, como um documento Word, uma folha de cálculo Excel ou uma apresentação em PowerPoint. No caso de o Microsoft Word ser usado como editor de correio electrónico HTML para Microsoft Outlook, este documento poderia ser uma mensagem de correio electrónico; contudo, o utilizador teria de responder ou reencaminhar a mensagem para que a vulnerabilidade fosse explorada.

No cenário de um ataque baseado na Web, um intruso poderia alojar um Web site contendo uma página Web que fosse utilizada para explorar esta vulnerabilidade. Além disso, os Web sites afectados e os Web sites que aceitam ou alojam conteúdos ou anúncios fornecidos por utilizadores poderiam conter conteúdos especialmente concebidos que poderiam explorar esta vulnerabilidade. Contudo, em qualquer dos casos, o intruso não teria forma de forçar os utilizadores a visitar estes Web sites. Em vez disso, um intruso teria de persuadir os utilizadores a visitar o Web site, levando-os normalmente a clicar numa hiperligação presente numa mensagem de correio electrónico, ou num programa de mensagens instantâneas, que levasse o utilizador para o Web site do intruso.

**Quais os sistemas mais susceptíveis a esta vulnerabilidade?**
Os sistemas afectados são principalmente estações de trabalho e servidores de terminais. Os servidores podem estar mais sujeitos a risco se os utilizadores com permissões administrativas suficientes tiverem a capacidade de iniciar sessão nos servidores e executar programas. Contudo, os procedimentos recomendados desencorajam essa acção.

**O que faz a actualização?**
A actualização elimina a vulnerabilidade, alterando a forma como o Visual Basic for Applications analisa a função, antes de transmitir a mensagem para a memória intermédia atribuída.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Sim. O relatório inicial foi fornecido através de divulgação responsável, mas a vulnerabilidade foi divulgada publicamente mais tarde. Este boletim de segurança resolve a vulnerabilidade divulgada publicamente e outras questões descobertas através de investigações internas.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido informações sobre a exploração desta vulnerabilidade?**
Sim. Quando o boletim de segurança foi publicado, a Microsoft já tinha recebido informações de que esta vulnerabilidade estava a ser explorada.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica do software afectado, clique na ligação adequada:

#### Office XP

#### Pré-requisitos e Detalhes de Actualização Adicionais

**Importante:** Antes de instalar esta actualização, certifique-se de que foram satisfeitos os seguintes requisitos:

-   O Microsoft Windows Installer 2.0 deve estar instalado. O Microsoft Windows Server 2003, o Windows XP e o Microsoft Windows 2000 Service Pack 3 (SP3) incluem o Windows Installer 2.0 ou uma versão posterior. Para instalar a mais recente versão do Windows Installer, visite um dos seguintes Web sites da Microsoft:

[Windows Installer 2.0 para Windows 95, Windows 98, Windows 98 SE e Windows Millennium Edition](http://go.microsoft.com/fwlink/?linkid=33337)

[Windows Installer 2.0 para Windows 2000 e Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338)

-   Se tiver o Office XP instalado, o Office XP Service Pack 3 (SP3) tem de estar instalado. Antes de instalar esta actualização, instale o [Office XP SP3](http://www.microsoft.com/downloads/details.aspx?familyid=85af7bfd-6f69-4289-8bd1-eb966bcdfb5e). Para obter mais informações sobre como instalar o Office XP SP3, consulte o Artigo 832671 da Base de Dados de Conhecimento da Microsoft.
-   Se tiver o Project 2002 instalado, o [Project 2002 Service Pack 1 (SP1)](http://www.microsoft.com/downloads/details.aspx?familyid=d64ea65b-9519-4061-9b3a-32af1a9bf888) tem de estar instalado. Antes de instalar esta actualização, instale o Project 2002 SP1. Para mais informações sobre como instalar o Project 2002 SP1, consulte o Artigo 830241 da Base de Dados de Conhecimento da Microsoft.
-   Se tiver o Visio 2002 instalado, o [Visio 2002 Service Pack 2 (SP2)](http://www.microsoft.com/downloads/details.aspx?familyid=00b9dfe4-ed08-4328-b355-4bc63d6267b2) tem de estar instalado. Antes de instalar esta actualização, instale o Visio 2002 SP2. Para mais informações sobre como instalar o Project 2002 SP1, consulte o [Artigo 830242 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/?kbid=830242).

Para mais informações sobre como determinar qual a versão do Office XP instalada no seu computador, consulte o [Artigo 291331 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/291331). Para obter mais informações sobre a informação de versão apresentada na caixa de diálogo **Acerca**, consulte o [Artigo 328294 da Base de Dados de Conhecimento](http://support.microsoft.com/kb/328294).

**Inclusão em Service Packs Futuros**

Nenhum. O Service Pack 3 é o service pack mais recente para o Office XP; o Service Pack 1 é o mais recente para o Project 2002 e o Service Pack 2 é o mais recente para o Visio 2002.

**Requisito de reinício**

Para ajudar a reduzir a hipótese de ser necessário reiniciar o computador, interrompa todos os serviços afectados e feche todas as aplicações que possam usar os ficheiros afectados antes de instalar a actualização de segurança. Para mais informações sobre por que razão pode ser solicitada a sua confirmação para o reinício, consulte o [Artigo 887012 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/887012).

**Informações de Remoção**

Para Office XP Service Pack 3, Project 2002 Service Pack 1 e Visio Service Pack 2: Após instalar a actualização, não poderá removê-la. Para reverter para uma instalação antes de a actualização ter sido instalada, terá de remover a aplicação e reinstalá-la em seguida a partir do CD-ROM original.

#### Informações de Instalação Automática de Cliente

**Web site Microsoft Update**

Esta actualização estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt). O Microsoft Update concentra actualizações fornecidas pelo Windows Update e Office Update num único local e permite-lhe optar pela entrega e instalação automáticas de actualizações de segurança e de elevada prioridade. Recomendamos que instale esta actualização utilizando o Web site do Microsoft Update. O Web site do Microsoft Update detecta qual a instalação em particular do utilizador e indica exactamente quais as actualizações que têm de ser instaladas para garantir que a instalação do utilizador está totalmente actualizada.

Para que o Web site do Microsoft Update detecte as actualizações necessárias que terão de ser instaladas no computador, visite o Web site do Microsoft Update. Ser-lhe-á apresentada a possibilidade de escolher entre **Express (Recomendada)** ou **Custom (Personalizada).** Após a detecção estar concluída, ser-lhe-á apresentada uma lista de actualizações recomendadas para aprovação. Clique em **Install Updates** (Instalar actualizações) ou **Review and Install Updates** (Rever e instalar actualizações) para concluir o processo.

#### Informações de Instalação Manual de Cliente

Para obter informações detalhadas sobre como instalar manualmente esta actualização, consulte a secção abaixo.

**Informações de Instalação**

A actualização de segurança suporta os seguintes parâmetros de configuração.

| Parâmetro   | Descrição                                                                                                                    |
|-------------|------------------------------------------------------------------------------------------------------------------------------|
| **/q**      | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.                                 |
| **/q:u**    | Especifica o modo silencioso de utilizador, que apresenta algumas caixas de diálogo ao utilizador.                           |
| **/q:a**    | Especifica o modo silencioso de administrador, que não apresenta qualquer caixa de diálogo ao utilizador.                    |
| **/t:path** | Especifica a pasta de destino para a extracção de ficheiros.                                                                 |
| **/c**      | Extrai os ficheiros sem os instalar. Se **/t:path** não for especificado, ser-lhe-á pedida uma pasta de destino.             |
| **/c:path** | Substitui o comando de instalação definido pelo autor. Especifica o caminho e nome do ficheiro Setup.inf ou .exe.            |
| **/r:n**    | Nunca reinicia o computador após a instalação.                                                                               |
| **/r:I**    | Solicita ao utilizador que reinicie o computador, se for necessário, excepto quando este parâmetro é utilizado com **/q:a**. |
| **/r:a**    | Reinicia sempre o computador após a instalação.                                                                              |
| **/r:s**    | Reinicia o computador após a instalação sem solicitar a confirmação do utilizador.                                           |
| **/n:v**    | Sem verificação da versão - Instalar o programa sobre qualquer versão anterior.                                              |

**Nota** Estes parâmetros não funcionam necessariamente com todas as actualizações. Se um parâmetro não estiver disponível, essa funcionalidade é necessária para a instalação correcta da actualização. Além disso, a utilização do parâmetro **/n:v** não é suportada e poderá fazer com que o sistema não arranque. Se a instalação não tiver êxito, contacte um técnico de suporte para compreender por que não foi possível instalar.

Para obter mais informações sobre os parâmetros de configuração suportados, consulte [o Artigo 197147 da Base de Dados de Conhecimento.](http://support.microsoft.com/kb/197147)

**Nota** A actualização de todos os ficheiros do Office destina-se tanto a instalações como cliente como a implementações de administrador.

**Informações de Implementação de Cliente**

1.  Transferir a actualização de segurança para: Office XP Service Pack 3 e/ou Project 2002 Service Pack 1 e/ou Visio 2002 Service Pack 2.
2.  Clique em **Guardar o programa no disco** e clique em **OK**.
3.  Clique em **Guardar**.
4.  Utilizando o Explorador do Windows, procure a pasta que contém o ficheiro guardado e faça duplo clique no mesmo.
5.  Se lhe for solicitado que instale a actualização, clique em **Sim**.
6.  Clique em **Sim** para aceitar o Contrato de Licença.
7.  Introduza o CD-ROM de origem quando tal lhe for solicitado e clique em **OK**.
8.  Quando receber uma mensagem que indica que a instalação teve êxito, clique em **OK**.

**Nota** Se a actualização de segurança já estiver instalada no computador, será apresentada a seguinte mensagem de erro: **Esta actualização já foi aplicada ou está incluída numa actualização já aplicada**.

**Informações de Ficheiro de Instalação de Cliente**

A versão inglesa desta actualização tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Office XP Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Project 2002 Service Pack 1:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Visio 2002 Service Pack 2:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

#### Informações de Instalação Administrativa

Se a aplicação tiver sido instalada a partir de uma localização no servidor, o administrador do servidor terá de actualizar a localização do servidor com a actualização administrativa e implementar essa actualização no computador do utilizador.

**Informações de Instalação**

Os parâmetros de configuração que se seguem são relevantes para as instalações administrativas, pois permitem que um administrador personalize a forma de extracção dos ficheiros a partir da actualização de segurança.

| Parâmetro   | Descrição                                                                                                         |
|-------------|-------------------------------------------------------------------------------------------------------------------|
| **/?**      | Apresenta as opções da linha de comandos.                                                                         |
| **/q**      | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.                      |
| **/t:path** | Especifica a pasta de destino para a extracção de ficheiros.                                                      |
| **/c**      | Extrai os ficheiros sem os instalar. Se **/t:path** não for especificado, ser-lhe-á pedida uma pasta de destino.  |
| **/c:path** | Substitui o comando de instalação definido pelo autor. Especifica o caminho e nome do ficheiro Setup.inf ou .exe. |

Para obter mais informações sobre os parâmetros de configuração suportados, consulte [o Artigo 197147 da Base de Dados de Conhecimento.](http://support.microsoft.com/kb/197147)

**Informações de Implementação Administrativa**

Para actualizar a sua instalação administrativa, siga estes passos:

1.  Transferir a actualização de segurança para: Office XP Service Pack 3 e/ou
    Project 2002 Service Pack 1 e/ou Visio 2002 Service Pack 2.
2.  Clique em **Guardar o programa no disco** e clique em **OK**.
3.  Clique em **Guardar**.
4.  Ao utilizar o Windows Explorer, localize a pasta que contém o ficheiro guardado. Clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK** para extrair o ficheiro .msp:
    **\[path\\name of EXE file\] /c /t:C:\\AdminUpdate**
    **Nota** Fazer duplo clique no ficheiro .exe não extrai o ficheiro .msp; aplica a actualização ao computador actual. Para actualizar uma imagem administrativa, deve primeiro extrair o ficheiro .msp.
5.  Clique em **Sim** para aceitar o Contrato de Licença.
6.  Clique em **Sim** quando lhe for solicitado que crie a pasta.
7.  Se estiver familiarizado com o procedimento de actualização administrativa, clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK**:
    **msiexec /a** *Admin Path***\\**MSI File **/p C:\\adminUpdate\\***MSP File* **SHORTFILENAMES=TRUE**
    **Nota** *Admin Path* é o caminho para o ponto de instalação administrativa da aplicação (por exemplo, C:\\OfficeXp), *MSI File* é o pacote de base de dados .msi da aplicação (por exemplo, Data1.msi) e *MSP File* é o nome da actualização administrativa (por exemplo, SHAREDff.msp).
    **Nota** Pode acrescentar /**qb+** à linha de comandos para que as caixas de diálogo **Instalação Administrativa** e **Contrato de Licença do Utilizador Final** não sejam apresentadas.
8.  Clique em **Seguinte** na caixa de diálogo apresentada. Não altere a Chave do CD, a localização da instalação nem o nome da empresa na caixa de diálogo apresentada.
9.  Clique em **Aceito os termos do contrato de licença** e clique em **Instalar**.

Nesta altura, o ponto de instalação administrativa está actualizado. Em seguida, terá de actualizar as configurações da estação de trabalho que foram instaladas originalmente a partir desta instalação administrativa. Para tal, consulte a secção "Implementação de Estações de Trabalho". Qualquer nova instalação que seja executada a partir deste ponto de instalação administrativa incluirá a actualização.

**Aviso** Qualquer estação de trabalho que tenha sido instalada originalmente a partir desta instalação administrativa, antes de a actualização ser instalada, não poderá utilizar esta instalação administrativa para acções como reparar o Office, ou adicionar novas funcionalidades, até que sejam concluídos os passos indicados na secção de "Implementação de Estações de Trabalho" relativamente a esta estação de trabalho.

**Informações de Implementação de Estações de Trabalho**

Para implementar a actualização nas estações de trabalho cliente, clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK**:

**msiexec /I** *Admin Path***\\**MSI File **/qb REINSTALL=**Feature List **REINSTALLMODE=vomu**

**Nota***Admin Path* é o caminho para o ponto de instalação administrativa da aplicação (por exemplo, C:\\OfficeXP), *MSI File* é o pacote de base de dados .msi para a aplicação (por exemplo, Data1.msi) e *Feature List* é a lista de nomes de funcionalidades (sensíveis a maiúsculas e minúsculas) que têm de ser reinstaladas para a actualização.

Para instalar todas as funcionalidades, pode utilizar **REINSTALL=ALL**, ou pode instalar as seguintes funcionalidades.

| Produto      | Funcionalidade |
|--------------|----------------|
| Office XP    | VBAFiles       |
| Visio 2002   | VBA            |
| Project 2002 | VBAFiles       |

**Nota** Os administradores que trabalhem em ambientes com gestão de sistema podem encontrar todos os recursos para implementar actualizações do Office numa organização recorrendo ao [Office Admin Update Center](http://office.microsoft.com/en-us/fx011511561033.aspx). Na página principal desse site, consulte a secção **Estratégias de Actualização** para conhecer a versão do software que está a actualizar. A [Documentação do Windows Installer](http://go.microsoft.com/fwlink/?linkid=21685) também fornece informações adicionais acerca dos parâmetros suportados pelo Windows Installer.

**Informações de Ficheiro de Instalação Administrativa**

A versão inglesa desta actualização tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Office XP Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Project 2002 Service Pack 1:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Visio 2002 Service Pack 2:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

**Nota** O MBSA 1.2.1 utiliza uma versão integrada da ferramenta Office Detection Tool (ODT) que não suporta análises remotas desta questão. Para mais informações sobre o MBSA, visite o Web site do MBSA. Para mais informações sobre o suporte do MBSA, visite o [Web site Microsoft Baseline Security Analyzer 1.2 Q&A](http://go.microsoft.com/fwlink/?linkid=33332).

-   **Verificação das Versões dos Ficheiros**

**Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
    **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
    **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

#### Office 2000

#### Pré-requisitos e Detalhes de Actualização Adicionais

**Importante:** Antes de instalar esta actualização, certifique-se de que foram satisfeitos os seguintes requisitos:

-   O Microsoft Windows Installer 2.0 deve estar instalado. O Microsoft Windows Server 2003, o Windows XP e o Microsoft Windows 2000 Service Pack 3 (SP3) incluem o Windows Installer 2.0 ou uma versão posterior. Para instalar a mais recente versão do Windows Installer, visite um dos seguintes Web sites da Microsoft:

[Windows Installer 2.0 para Windows 95, Windows 98, Windows 98 SE e Windows Millennium Edition](http://go.microsoft.com/fwlink/?linkid=33337)

[Windows Installer 2.0 para Windows 2000 e Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338)

-   Se tiver o Office 2000 instalado, o Office 2000 Service Pack 3 (SP3) tem de estar instalado. Antes de instalar esta actualização, instale o [Office 2000 SP3](http://www.microsoft.com/downloads/details.aspx?familyid=5c011c70-47d0-4306-9fa4-8e92d36332fe&displaylang=en%20_blank). Para mais informações sobre como instalar o Office 2000 SP3, consulte o [artigo 326585 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/default.aspx?scid=kb;%5bln%5d;326585).
-   Se tiver o Project 2000 instalado, o Project 2000 Service Release 1 (SR1) tem de estar instalado. Antes de instalar esta actualização, instale o Project 2000 SR1. Para mais informações sobre como instalar o Project 2000 SR1, consulte o Artigo 288953 da Base de Dados de Conhecimento da Microsoft.

Para mais informações sobre como determinar que versão do Office 2000 está instalada no computador, consulte o [Artigo 255275 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/255275).

**Inclusão em Service Packs Futuros**

Nenhum. O Service Pack 3 é o service pack mais recente para o Office 2000; o Service Release 1 é o mais recente para o Project 2000.

**Requisito de reinício**

Para ajudar a reduzir a hipótese de ser necessário reiniciar o computador, interrompa todos os serviços afectados e feche todas as aplicações que possam usar os ficheiros afectados antes de instalar a actualização de segurança. Para mais informações sobre por que razão pode ser solicitada a sua confirmação para o reinício, consulte o [Artigo 887012 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/887012).

**Informações de Remoção**

Após instalar a actualização, não poderá removê-la. Para reverter para uma instalação antes de a actualização ter sido instalada, terá de remover a aplicação e reinstalá-la em seguida a partir do CD-ROM original.

#### Informações de Instalação Automática de Cliente

**Web Site do Office Update**

Recomendamos que instale as actualizações de cliente do Microsoft Office 2000 recorrendo ao [Web site do Office Update](http://go.microsoft.com/fwlink/?linkid=21135). O Web site do Office Update detecta qual a instalação de que dispõe e indica exactamente quais as actualizações que têm de ser instaladas para garantir que a instalação do utilizador está totalmente actualizada.

Para que o [Web site do Office Update](http://go.microsoft.com/fwlink/?linkid=21135) detecte as actualizações que terão de ser instaladas no computador, visite o Web site do Office Update e seleccione **Verificar Existência de Actualizações**. Após a detecção estar concluída, ser-lhe-á apresentada uma lista de actualizações recomendadas para aprovação. Clique em **Concordar e Instalar** para completar o processo.

#### Informações de Instalação Manual de Cliente

Para obter informações detalhadas sobre como instalar manualmente esta actualização, consulte a secção abaixo.

**Informações de Instalação**

A actualização de segurança suporta os seguintes parâmetros de configuração.

| Parâmetro   | Descrição                                                                                                                    |
|-------------|------------------------------------------------------------------------------------------------------------------------------|
| **/q**      | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.                                 |
| **/q:u**    | Especifica o modo silencioso de utilizador, que apresenta algumas caixas de diálogo ao utilizador.                           |
| **/q:a**    | Especifica o modo silencioso de administrador, que não apresenta qualquer caixa de diálogo ao utilizador.                    |
| **/t:path** | Especifica a pasta de destino para a extracção de ficheiros.                                                                 |
| **/c**      | Extrai os ficheiros sem os instalar. Se **/t:path** não for especificado, ser-lhe-á pedida uma pasta de destino.             |
| **/c:path** | Substitui o comando de instalação definido pelo autor. Especifica o caminho e nome do ficheiro Setup.inf ou .exe.            |
| **/r:n**    | Nunca reinicia o computador após a instalação.                                                                               |
| **/r:I**    | Solicita ao utilizador que reinicie o computador, se for necessário, excepto quando este parâmetro é utilizado com **/q:a**. |
| **/r:a**    | Reinicia sempre o computador após a instalação.                                                                              |
| **/r:s**    | Reinicia o computador após a instalação sem solicitar a confirmação do utilizador.                                           |
| **/n:v**    | Sem verificação da versão - Instalar o programa sobre qualquer versão anterior.                                              |

**Nota** Estes parâmetros não funcionam necessariamente com todas as actualizações. Se um parâmetro não estiver disponível, essa funcionalidade é necessária para a instalação correcta da actualização. Além disso, a utilização do parâmetro **/n:v** não é suportada e poderá fazer com que o sistema não arranque. Se a instalação não tiver êxito, contacte um técnico de suporte para compreender por que não foi possível instalar.

Para obter mais informações sobre os parâmetros de configuração suportados, consulte [o Artigo 197147 da Base de Dados de Conhecimento.](http://support.microsoft.com/kb/197147)

**Nota** A actualização de todos os ficheiros do Office destina-se tanto a instalações como cliente como a implementações de administrador.

**Informações de Implementação de Cliente**

1.  Transferir a actualização de segurança para: Office 2000 Service Pack 3 e/ou Access 2000 Runtime Service Pack 3 e/ou Project 2000 Service Release 1.
2.  Clique em **Guardar o programa no disco** e clique em **OK**.
3.  Clique em **Guardar**.
4.  Utilizando o Explorador do Windows, procure a pasta que contém o ficheiro guardado e faça duplo clique no mesmo.
5.  Se lhe for solicitado que instale a actualização, clique em **Sim**.
6.  Clique em **Sim** para aceitar o Contrato de Licença.
7.  Introduza o CD-ROM de origem quando tal lhe for solicitado e clique em **OK**.
8.  Quando receber uma mensagem que indica que a instalação teve êxito, clique em **OK**.

**Nota** Se a actualização de segurança já estiver instalada no computador, será apresentada a seguinte mensagem de erro: **Esta actualização já foi aplicada ou está incluída numa actualização já aplicada**.

**Informações de Ficheiro de Instalação de Cliente**

A versão inglesa desta actualização tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Office 2000 Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Project 2000 Service Release 1:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Access 2000 Runtime Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

**Nota** O MBSA 1.2.1 utiliza uma versão integrada da ferramenta Office Detection Tool (ODT) que não suporta análises remotas desta questão. Para mais informações sobre o MBSA, visite o Web site do MBSA. Para mais informações sobre o suporte do MBSA, visite o [Web site Microsoft Baseline Security Analyzer 1.2 Q&A](http://go.microsoft.com/fwlink/?linkid=33332).

-   **Verificação das Versões dos Ficheiros**

**Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
    **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
    **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

#### Informações de Instalação Administrativa

Se a aplicação tiver sido instalada a partir de uma localização no servidor, o administrador do servidor terá de actualizar a localização do servidor com a actualização administrativa e implementar essa actualização no computador do utilizador.

**Informações de Instalação**

Os parâmetros de configuração que se seguem são relevantes para as instalações administrativas, pois permitem que um administrador personalize a forma de extracção dos ficheiros a partir da actualização de segurança.

| Parâmetro   | Descrição                                                                                                         |
|-------------|-------------------------------------------------------------------------------------------------------------------|
| **/?**      | Apresenta as opções da linha de comandos.                                                                         |
| **/q**      | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.                      |
| **/t:path** | Especifica a pasta de destino para a extracção de ficheiros.                                                      |
| **/c**      | Extrai os ficheiros sem os instalar. Se **/t:path** não for especificado, ser-lhe-á pedida uma pasta de destino.  |
| **/c:path** | Substitui o comando de instalação definido pelo autor. Especifica o caminho e nome do ficheiro Setup.inf ou .exe. |

Para obter mais informações sobre os parâmetros de configuração suportados, consulte [o Artigo 197147 da Base de Dados de Conhecimento.](http://support.microsoft.com/kb/197147)

**Informações de Implementação Administrativa**

Para actualizar a sua instalação administrativa, siga estes passos:

1.  Transferir a actualização de segurança para: Office 2000 Service Pack 3 e/ou
    Access 2000 Runtime Service Pack 3 e/ou Project 2000 Service Release 1.
2.  Clique em **Guardar o programa no disco** e clique em **OK**.
3.  Clique em **Guardar**.
4.  Ao utilizar o Windows Explorer, localize a pasta que contém o ficheiro guardado. Clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK** para extrair o ficheiro .msp:
    **\[path\\name of EXE file\] /c /t:C:\\AdminUpdate**
    **Nota** Fazer duplo clique no ficheiro .exe não extrai o ficheiro .msp; aplica a actualização ao computador actual. Para actualizar uma imagem administrativa, deve primeiro extrair o ficheiro .msp.
5.  Clique em **Sim** para aceitar o Contrato de Licença.
6.  Clique em **Sim** quando lhe for solicitado que crie a pasta.
7.  Se estiver familiarizado com o procedimento de actualização administrativa, clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK**:
    **msiexec /a** *Admin Path***\\**MSI File **/p C:\\AdminUpdate\\***MSP File* **SHORTFILENAMES=TRUE**
    **Nota** *Admin Path* é o caminho para o ponto de instalação administrativa da aplicação (por exemplo, C:\\Office2000), *MSI File* é o pacote de base de dados .msi da aplicação (por exemplo, Data1.msi) e *MSP File* é o nome da actualização administrativa (por exemplo, SHAREDff.msp).
    **Nota** Pode acrescentar /**qb+** à linha de comandos, para que as caixas de diálogo **Instalação Administrativa** e **Contrato de Licença de Utilizador Final** não sejam apresentadas.
8.  Clique em **Seguinte** na caixa de diálogo apresentada. Não altere a Chave do CD, a localização da instalação nem o nome da empresa na caixa de diálogo apresentada.
9.  Clique em **Aceito os termos do contrato de licença** e clique em **Instalar**.

Nesta altura, o ponto de instalação administrativa está actualizado. Em seguida, terá de actualizar as configurações das estações de trabalho que foram instaladas originalmente a partir desta instalação administrativa. Para tal, consulte a secção "Implementação de Estações de Trabalho". Qualquer nova instalação que seja executada a partir deste ponto de instalação administrativa incluirá a actualização.

**Aviso** Qualquer estação de trabalho que tenha sido instalada originalmente a partir desta instalação administrativa, antes de a actualização ser instalada, não poderá utilizar esta instalação administrativa para acções como reparar o Office, ou adicionar novas funcionalidades, até que sejam concluídos os passos indicados na secção de "Implementação de Estações de Trabalho" relativamente a esta estação de trabalho.

**Informações de Implementação de Estações de Trabalho**

Para implementar a actualização nas estações de trabalho cliente, clique em **Iniciar**, clique em **Executar**, escreva o seguinte comando e depois clique em **OK**:

**msiexec /I** *Admin Path***\\**MSI File **/qb REINSTALL=**Feature List **REINSTALLMODE=vomu**

**Nota***Admin Path* é o caminho para o ponto de instalação administrativa da aplicação (por exemplo, C:\\Office2000), *MSI File* é o pacote de base de dados .msi para a aplicação (por exemplo, Data1.msi) e *Feature List* é a lista de nomes de funcionalidades (sensíveis a maiúsculas e minúsculas) que têm de ser reinstaladas para a actualização.

Para instalar todas as funcionalidades, pode utilizar **REINSTALL=ALL**, ou pode instalar as seguintes funcionalidades.

| Produto             | Funcionalidade                           |
|---------------------|------------------------------------------|
| Office 2000         | ProductNonBootFiles, AccessRuntimeMaster |
| Project 2000        | ProductNonBootFiles                      |
| Access 2000 Runtime | AccessRuntimeMaster                      |

**Nota** Os administradores que trabalhem em ambientes com gestão de sistema podem encontrar todos os recursos para implementar actualizações do Office numa organização recorrendo ao Office Admin Update Center. Nesse site, desça até à secção **Recursos para Actualizações** e procure aí a versão do software que está a actualizar. A [Documentação do Windows Installer](http://go.microsoft.com/fwlink/?linkid=21685) também fornece informações adicionais acerca dos parâmetros suportados pelo Windows Installer.

**Informações de Ficheiro de Instalação Administrativa**

A versão inglesa desta actualização tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Office 2000 Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Project 2000 Service Release 1:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Access 2000 Runtime Service Pack 3:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

**Nota** O MBSA 1.2.1 utiliza uma versão integrada da ferramenta Office Detection Tool (ODT) que não suporta análises remotas desta actualização de segurança. Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

**Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
    **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
    **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

#### Microsoft Visual Basic for Applications

**Pré-requisitos**
Esta actualização de segurança requer o Microsoft Visual Basic for Applications.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/q /c:”install.exe /q”**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso, ou elimina os avisos. Note que o /c e as aspas devem ser usados tal como apresentado.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/r:n**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos:

**VBA64-KB923167-x86-ENU.exe /q /c:”install.exe /q”**

**Nota** A utilização do parâmetro **/q /c:”install.exe /q** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/q /c:”install.exe /q**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB923167.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem forçar o sistema a reiniciar, utilize o seguinte comando na linha de comandos:

**VBA64-KB923167-x86-ENU.exe /r:n**

Para mais informações sobre como implementar esta actualização de segurança com o Software Update Services, visite o [Web site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Requisito de reinício**
Esta actualização não requer um reinício. O programa de instalação pára os serviços necessários, aplica a actualização e, em seguida, reinicia os serviços. Contudo, se não for possível interromper os serviços necessários por qualquer motivo, ou se os ficheiros necessários estiverem a ser utilizados, esta actualização vai requerer o reinício do computador. Se for esse o caso, será apresentada uma mensagem aconselhando-o a reiniciar.

Para ajudar a reduzir a hipótese de ser necessário reiniciar o computador, interrompa todos os serviços afectados e feche todas as aplicações que possam usar os ficheiros afectados antes de instalar a actualização de segurança. Para mais informações sobre por que razão pode ser solicitada a sua confirmação para o reinício do seu computador, consulte o [Artigo 887012 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/887012).

**Informações de Remoção**
Para remover esta actualização, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

**Informações de Ficheiros**
A versão inglesa desta actualização contém os atributos de ficheiro listados na tabela abaixo (ou posteriores). As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Microsoft Visual Basic for Applications

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Microsoft Visual Basic for Applications no Windows Server, 2003 Enterprise Edition para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados em Itanium e Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados em Itanium:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

Microsoft Visual Basic for Applications no Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; Windows Server 2003, Datacenter x64 Edition; Windows Server 2003 R2, Standard x64 Edition; Windows Server 2003 R2, Enterprise x64 Edition e Windows Server 2003 R2, Datacenter x64 Edition:

| Nome do Ficheiro | Versão    | Data        | Hora  | Tamanho   |
|------------------|-----------|-------------|-------|-----------|
| Vbe6.dll         | 6.4.99.72 | 05-Jul-2006 | 18:16 | 2,489,096 |

**Verificação da Instalação da Actualização**

**Informação sobre a versão do ficheiro**

**Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
2.  No **painel Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
    **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a instalação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Ka Chun Leung, da [Symantec](http://symantec.com/), por fornecer informações sobre a Vulnerabilidade no Visual Basic for Applications - [CVE-2006-3649](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3649).

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outros problemas de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166).
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Utilizando o Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scanning Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (8 de Agosto de 2006): Boletim publicado.
-   V1.1 (15 de Agosto de 2006): Actualização do boletim na secção “Informações de Implementação” para “Microsoft Visual Basic for Applications” em “Informações de Actualização de Segurança”.

*Built at 2014-04-18T01:50:00Z-07:00*
