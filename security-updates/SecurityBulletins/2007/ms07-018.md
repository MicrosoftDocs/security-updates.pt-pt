---
TOCTitle: 'MS07-018'
Title: 'Microsoft Security Bulletin MS07-018 - Crítica'
ms:assetid: 'ms07-018'
ms:contentKeyID: 61234271
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms07-018(v=Security.10)'
author: SharonSears
ms.author: SharonSears
---

Security Bulletin

Microsoft Security Bulletin MS07-018 - Crítica
==============================================

Vulnerabilidades no Microsoft Content Management Server poderiam permitir Execução Remota de Código (925939)
------------------------------------------------------------------------------------------------------------

Data de publicação: 10 de abril de 2007 | Updated: 12 de junho de 2007

**actualizada:** 2.0

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o Microsoft Content Management Server

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes deverão aplicar de imediato a actualização

**Substituição de Actualizações de Segurança:** Nenhum

**Avisos:** O [Artigo 924429 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/924429) documenta as questões actualmente conhecidas que os clientes podem experimentar quando instalam esta actualização de segurança. O artigo também documenta soluções recomendadas para estas questões. Para obter mais informações, consulte o [Artigo 924429 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/924429).

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   Microsoft Content Management Server 2001 Service Pack 1 — [Transferir a actualização (KB924430)](http://www.microsoft.com/downloads/details.aspx?familyid=0aac923d-a6b8-4023-9977-aea6782dc1c7)
-   Microsoft Content Management Server 2002 Service Pack 2 — [Transferir a actualização (KB924429)](http://www.microsoft.com/downloads/details.aspx?familyid=41d53931-bcf8-43d9-9d16-592ebfb0ac04)

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve duas vulnerabilidades recentemente descobertas e comunicadas de forma privada. Cada vulnerabilidade está documentada na secção "Detalhes sobre a Vulnerabilidade" deste boletim.

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                                                      | Impacto da Vulnerabilidade                         | Microsoft Content Management Server 2001 Service Pack 1 | Microsoft Content Management Server 2002 Service Pack 2 |
|---------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|---------------------------------------------------------|---------------------------------------------------------|
| Vulnerabilidade de Corrupção de Memória CMS - [CVE-2007-0938](http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0938)                              | Execução Remota de Código                          | Crítica                                                 | Crítica                                                 |
| Vulnerabilidade de Execução de Scripts entre Sites e de Ocultação no CMS - [CVE-2007-0939](http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0939) | Divulgação de Informações e Ocultação de Conteúdos | Importante                                              | Importante                                              |
| **Gravidade Agregada de Todas as Vulnerabilidades**                                                                                                     |                                                    | **Crítica**                                             | **Crítica**                                             |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Por que razão decidiu a Microsoft voltar a publicar este boletim em 12 de Junho de 2007?**
Este boletim foi publicado novamente para resolver as questões identificadas no [Artigo 924429 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/924429). Anteriormente, a actualização de segurança não tinha em conta as instalações de CMS 2002 efectuadas numa localização que não correspondesse à localização do caminho predefinido. Os clientes que instalaram a versão original da actualização de segurança também necessitam de seguir as orientações indicadas no [Artigo 924429 da Base de Dados de Conhecimento](http://support.microsoft.com/kb/924429) para recuperar a funcionalidade normal.

**Que actualizações são substituídas por esta edição?**
Esta actualização não substitui qualquer actualização de segurança anterior. Se estiver a executar o Content Management Server 2001, recomendamos que instale o MS03-002 antes de instalar esta actualização.

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Produto                                                 | MBSA 1.2.1 | MBSA 2.0.1 |
|---------------------------------------------------------|------------|------------|
| Microsoft Content Management Server 2001 Service Pack 1 | Sim        | Não        |
| Microsoft Content Management Server 2002 Service Pack 2 | Sim        | Sim        |

**Nota** O MBSA 1.2.1 utiliza uma versão integrada da ferramenta Office Detection Tool (ODT) que não suporta análises remotas desta actualização de segurança. Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para mais informações sobre programas que o Microsoft Update e o MBSA 2.0.1 não detectam actualmente, consulte o [artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723/pt): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Produto                                                 | SMS 2.0 | SMS 2003 |
|---------------------------------------------------------|---------|----------|
| Microsoft Content Management Server 2001 Service Pack 1 | Sim     | Não      |
| Microsoft Content Management Server 2002 Service Pack 2 | Sim     | Sim      |

Os utilizadores do SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem utilizar o MBSA 1.2.1 para detecção e, por isso, têm a mesma limitação listada anteriormente neste boletim, relacionada com programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool (SUIT), pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre o SUIT, visite o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/pt). Para mais informações sobre as limitações do SUIT, consulte [o artigo 306460 da base de dados de conhecimento da Microsoft](http://support.microsoft.com/kb/306460/pt). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para mais informações sobre o SMS 2003 ITMU, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723/pt): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade de Corrupção de Memória CMS - CVE-2007-0938:

Existe uma vulnerabilidade de execução remota de código no Content Management Server devido à forma como este processa pedidos HTTP especialmente concebidos para o efeito.

Um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter o controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

#### Factores atenuantes para a Vulnerabilidade de Corrupção de Memória CMS - CVE-2007-0938:

-   No Microsoft Internet Information Service 6.0, o processo de trabalho do W3WP.exe por predefinição é de privilégio limitado quando executado como a conta do Serviço de Rede incorporada.
    **Nota** – Apenas se aplica ao Content Management Server 2002.
-   Os clientes que configuraram Web sites do Microsoft Content Management Server (MCMS) na própria zona da aplicação para os isolar de outros Web sites poderiam limitar o impacto de um ataque.

#### Soluções alternativas para a Vulnerabilidade de Corrupção de Memória CMS - CVE-2007-0938:

Não identificámos quaisquer soluções alternativas para esta vulnerabilidade.

#### Perguntas mais frequentes sobre a Vulnerabilidade de Corrupção de Memória CMS - CVE-2007-0938:

**Qual é a abrangência desta vulnerabilidade? **
Existe uma vulnerabilidade de execução remota de código no Content Management Server devido à forma como este processa pedidos HTTP especialmente concebidos para o efeito. Um intruso que conseguisse tirar partido da vulnerabilidade poderia obter o controlo total de um sistema afectado remotamente. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**O que provoca a vulnerabilidade? **
A vulnerabilidade de execução remota de código resulta da forma como o Microsoft Content Management Server processa caracteres inesperados num pedido HTTP.

**O que é o Microsoft Content Management Server? **
O [Microsoft Content Management Server](http://www.microsoft.com/cmserver/default.mspx) (MCMS) permite que os clientes construam, implementem e mantenham web sites. Utilizando o MCMS, os clientes podem criar, publicar e gerir conteúdos Web, além de gerir recursos de servidor disponíveis para o site.

**Estou a executar o Microsoft Content Management Server 2001 e personalizei o ficheiro ManualLogin.asp. Tenho de efectuar algum procedimento? **
Esta actualização de segurança não actualiza o ManualLogin.asp. Quaisquer personalizações efectuadas nesta página permanecerão depois desta actualização ter sido aplicada. Ainda assim, recomendamos que sejam criadas cópias de segurança para as páginas ASP antes de ser efectuada manutenção em qualquer Web site.

**Como poderia um intruso utilizar a vulnerabilidade? **
Um intruso que tirasse partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Como poderia um intruso explorar a vulnerabilidade? **
Um intruso poderia tentar explorar a vulnerabilidade construindo um URL especialmente concebido para o efeito e enviando um pedido HTTP GET para o sistema CMS.

**Quais são os sistemas mais susceptíveis a esta vulnerabilidade? **
Os Web sites que continuam a utilizar as versões afectadas do Microsoft Content Management Server.

**O que faz a actualização? **
A actualização remove a vulnerabilidade modificando a forma como o Content Management Server valida um pedido HTTP.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente? **
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável. A Microsoft ainda não tinha recebido informações que indicassem que esta vulnerabilidade tivesse sido divulgada publicamente, quando este boletim de segurança foi publicado pela primeira vez.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada? **
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

#### Vulnerabilidade de execução de scripts entre sites e de ocultação no CMS - CVE-2007-0939:

Existe uma vulnerabilidade de execução de scripts entre sites e de ocultação no Microsoft Content Management Server (MCMS) que poderia permitir que um intruso convencesse um utilizador a executar um script malicioso. Se esse script mal intencionado for executado, será executado no contexto de segurança do utilizador. As tentativas de exploração desta vulnerabilidade requerem interacção com o utilizador. Esta vulnerabilidade poderia permitir que um intruso acedesse a quaisquer dados nos sistemas afectados que fossem acessíveis ao utilizador individual.

Também poderia ser possível que um intruso explorasse esta vulnerabilidade para efectuar alterações nas caches do browser da Web e de servidores proxy intermédios e colocar conteúdos ocultos nessas caches.

#### Factores atenuantes para a Vulnerabilidade de execução de scripts entre sites e de ocultação no CMS - CVE-2007-0939:

-   A vulnerabilidade não pode ser automaticamente explorada através de correio electrónico. Para um ataque poder ser bem sucedido, é necessário que um utilizador clique numa hiperligação que é enviada numa mensagem de correio electrónico.
-   Um ataque só teria sucesso se o utilizador que tivesse sido levado a clicar num URL do intruso especialmente concebido para o efeito e tivesse acesso ao servidor Web do CMS.
-   Um intruso que explorasse o aspecto da execução de scripts entre sites desta vulnerabilidade apenas poderia obter as mesmas autorizações que o utilizador.
-   Clientes que tenham activado a opção avançada do Internet Explorer Não guardar páginas encriptadas no disco, não estariam susceptíveis a qualquer tentativa de colocação de conteúdo oculto na cache do cliente se acedessem ao seu Web site através do protocolo SSL (Secure Sockets Layer).
-   Os clientes que usam ligações protegidas por SSL para aceder a Web sites afectados não estariam vulneráveis a tentativas de colocação de conteúdos ocultos nas caches de servidores proxy intermédios. Isto porque os dados da sessão SSL são encriptados e não são colocados na cache dos servidores de proxy intermédios.
-   Se o conteúdo fraudulento for colocado com êxito numa cache de servidor proxy intermédio, poderia ser difícil para um intruso prever quais os utilizadores a quem seria servido o conteúdo fraudulento colocado na cache.

#### Soluções alternativas para a Vulnerabilidade de execução de scripts entre sites e de ocultação no CMS - CVE-2007-0939:

A Microsoft testou a seguinte solução alternativa. Embora esta solução alternativa não corrija a vulnerabilidade subjacente, ela ajuda a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Configurar um site MCMS para Sim-Apenas de Leitura desactivará a autorização de conteúdos e o acesso a esse ponto de entrada no servidor MCMS a partir da Gestão de Sites**
    Configurar um site MCMS para **Sim-Apenas de Leitura** desactivará a autorização de conteúdos e o acesso a esse ponto de entrada no servidor MCMS a partir da Gestão de Sites, mas não remove quaisquer ficheiros do sistema de ficheiros. Se quiser utilizar a ferramenta Gestão de Sites para modificar configurações num site MCMS apenas de leitura, primeiro tem de permitir a leitura-gravação do site na ferramenta Web Server Configuration.
    Configurar um site MCMS para apenas de leitura significa que não pode usar o SDAPI (ou Gestão de Sites) no lado do cliente para implementar conteúdos. Num site apenas de leitura, tem de utilizar o SDAPI no lado do servidor para implementação de conteúdos API, excepto se dispuser de um ponto de entrada Web leitura-gravação independente.

    **Para modificar o site MCMS para Sim-Apenas de Leitura, siga estes passos:**

    1.  Clique em **Iniciar**, clique em **Programas** e seleccione **Microsoft Content Management Server**.
    2.  Clique em **Aplicação de Configuração do Servidor**.
    3.  Clique no separador **Web** e seleccione **Configurar**.
    4.  Na caixa de diálogo para o Web site do MCMS que deseja configurar, seleccione **Sim – Apenas de Leitura**.
    5.  Clique em **OK** para guardar as alterações.

    **Impacto da solução alternativa:** Os utilizadores deixarão de poder criar conteúdos através do MCMS Web Author (não pode iniciar sessão com direitos de edição num Servidor MCMS) nem através da Gestão de Sites.

#### Perguntas mais frequentes sobre a Vulnerabilidade de execução de scripts entre sites e de ocultação no Microsoft Content Management Server - CVE-2007-0939:

**Qual é a abrangência desta vulnerabilidade? **
Existe uma vulnerabilidade de execução de scripts entre sites e de ocultação no Microsoft Content Management Server (MCMS). A vulnerabilidade poderia permitir a introdução de um script no lado do cliente no browser do utilizador. Num cenário de ataque baseado na Web, um Web site comprometido poderia aceitar ou alojar conteúdos fornecidos pelo utilizador ou anúncios que poderiam conter conteúdos especialmente concebidos que pudessem explorar esta vulnerabilidade.

O script conseguiria executar qualquer acção em lugar do utilizador que o Web site estivesse autorizado a executar. Isto poderia incluir controlar a sessão na Web e encaminhar a informação de controlo para outro utilizador, executando outro código no sistema do utilizador, ou ler e registar cookies.

**O que provoca a vulnerabilidade? **
A vulnerabilidade de execução de scripts entre sites (XSS) é provocada pelo facto de o Microsoft Content Management Server não validar completamente a entrada fornecida numa consulta de redireccionamento HTML antes de a enviar para o browser.

**O que é o Microsoft Content Management Server? **
O [Microsoft Content Management Server](http://www.microsoft.com/cmserver/default.mspx) (MCMS) permite que os clientes construam, implementem e mantenham web sites. Utilizando o MCMS, os clientes podem criar, publicar e gerir conteúdos Web, além de gerir recursos de servidor disponíveis para o site.

**O que é a execução de scripts entre sites? **
A execução de scripts entre sites (XSS) é uma classe de vulnerabilidades de segurança que pode permitir que um intruso "injecte" scripts numa sessão de um utilizador com um Web site. A vulnerabilidade pode afectar servidores Web que geram dinamicamente páginas HTML. Se estes servidores incorporarem dados do browser nas páginas dinâmicas que enviam para o browser, podem ser manipulados para incluir conteúdos fornecidos maliciosamente nas páginas dinâmicas. Isto pode permitir que sejam executados scripts maliciosos. Os browsers da Web poderiam perpetuar este problema, baseados no princípio de que se tratam de sites "fidedignos" e na forma como utilizam os cookies para manter um estado persistente com os Web sites que frequentam. Um ataque XSS não modifica os conteúdos do Web site. Pelo contrário, insere scripts novos e maliciosos que podem ser executados no browser, no contexto que está associado a um servidor fidedigno.

**Como funciona a execução de scripts entre sites? **
As páginas Web contêm texto e marcadores HTML. O texto e os marcadores HTML são gerados pelo servidor e são interpretados pelo cliente. Se for introduzido conteúdo não fidedigno numa página dinâmica, nem o servidor nem o cliente possuem informações suficientes para reconhecer que esta introdução teve lugar e para tomar medidas de protecção.

**Estou a executar o Microsoft Content Management Server 2001 e personalizei o ficheiro ManualLogin.asp. Tenho de efectuar algum procedimento? **
Esta actualização de segurança não actualiza o ManualLogin.asp. Quaisquer personalizações efectuadas nesta página permanecerão depois desta actualização ter sido aplicada. Ainda assim, recomendamos que sejam criadas cópias de segurança para as páginas ASP antes de ser efectuada manutenção em qualquer Web site.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que explorasse esta vulnerabilidade com êxito poderia introduzir um script no lado do cliente no browser do utilizador. O script poderia ter conteúdos ocultos, divulgar informações, ou executar qualquer acção que o utilizador pudesse executar no Web site afectado. As tentativas de exploração desta vulnerabilidade requereriam interacção com o utilizador. Também seria possível explorar a vulnerabilidade de forma a manipular as caches do browser da Web e do servidor proxy intermédio e colocando conteúdos ocultos nas mesmas.

**Como poderia um intruso explorar a vulnerabilidade? **
Num cenário de ataque através de correio electrónico, um intruso poderia tentar explorar a vulnerabilidade enviando uma mensagem de correio electrónico especialmente concebida para o efeito a um utilizador ou a um servidor que estivesse a executar uma aplicação de software afectada. O intruso poderia então convencer o utilizador a clicar na hiperligação na mensagem de correio electrónico.

Num cenário de ataque baseado na Web, um intruso poderia introduzir um script cliente no browser do utilizador. O script poderia ter conteúdos ocultos, divulgar informações, ou executar qualquer acção que o utilizador pudesse executar no Web site afectado. As tentativas de exploração desta vulnerabilidade requereriam interacção com o utilizador.

Também poderia ser possível explorar a vulnerabilidade efectuando alterações nas caches do browser da Web e de servidores proxy intermédios e para colocar conteúdos ocultos nessas caches.

**Quais são os sistemas mais susceptíveis a esta vulnerabilidade? **
Os Web sites que continuam a utilizar as versões afectadas do Microsoft Content Management Server.

**A vulnerabilidade poderia ser explorada a partir da Internet? **
Sim. Um intruso pode tentar explorar esta vulnerabilidade através da Internet. Um intruso teria de conhecer o nome completo do servidor CMS a que se destina o ataque.

**O que faz a actualização? **
A actualização remove a vulnerabilidade modificando a forma como o Content Management Server valida pedidos de redireccionamento HTTP.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente? **
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável. A Microsoft ainda não tinha recebido informações que indicassem que esta vulnerabilidade tivesse sido divulgada publicamente, quando este boletim de segurança foi publicado pela primeira vez. Este boletim de segurança resolve a vulnerabilidade divulgada em meios privados e outras questões descobertas através de investigações internas.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada? **
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica para o software afectado, consulte a secção adequada:

#### Content Management Server

#### Pré-requisitos e Detalhes de Actualização Adicionais

**Importante:** Antes de instalar esta actualização, certifique-se de que foram satisfeitos os seguintes requisitos:

-   Para instalar o Content Management Server 2001, o Service Pack 1 tem de estar instalado. Antes de instalar esta actualização, instale o [Content Management Server 2001 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=bf03c4cd-17b1-4a6f-8ded-e401909b4791).
-   Para instalar o Content Management Server 2002, o Service Pack 2 tem de estar instalado. Antes de instalar esta actualização, instale o [Content Management Server 2002 Service Pack 2](http://www.microsoft.com/downloads/details.aspx?familyid=3de1e8f0-d660-4a2b-8b14-0fce961e56fb).
-   Recomendamos que todos os utilizadores do Content Management Server 2001 Service Pack 1 instalem o [MS03-002](http://technet.microsoft.com/security/bulletin/ms03-002) antes de instalarem esta actualização.

**Inclusão em Service Packs Futuros**

Não estão planeados Service Packs para o Content Management Server 2001 ou o Content Management Server 2002, sendo o Service Pack 2 o mais recente.

**Requisito de reinício**

Para ajudar a reduzir a hipótese de ser necessário reiniciar o computador, interrompa todos os serviços afectados e feche todas as aplicações que possam usar os ficheiros afectados antes de instalar a actualização de segurança. Para mais informações sobre por que razão pode ser solicitada a sua confirmação para o reinício do seu computador, consulte o [Artigo 887012 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/887012/pt).

**Informações de Remoção**

Após instalar a actualização, não poderá removê-la. Para reverter para uma instalação antes de a actualização ter sido instalada, terá de remover a aplicação e reinstalá-la em seguida a partir do CD-ROM original.

#### Informações de Instalação Automática

**Web site Microsoft Update**

Esta actualização estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt). O Microsoft Update concentra actualizações fornecidas pelo Windows Update e Office Update num único local e permite-lhe optar pela entrega e instalação automáticas de actualizações de segurança e de elevada prioridade. Recomendamos que instale esta actualização utilizando o Web site do Microsoft Update. O Web site do Microsoft Update detecta qual a instalação em particular do utilizador e indica exactamente quais as actualizações que têm de ser instaladas para garantir que a instalação do utilizador está totalmente actualizada.

Para que o Web site do Microsoft Update detecte as actualizações necessárias que terão de ser instaladas no computador, visite o Web site do Microsoft Update. Ser-lhe-á apresentada a possibilidade de escolher entre **Express (Recomendada)** ou **Custom (Personalizada).** Após a detecção estar concluída, ser-lhe-á apresentada uma lista de actualizações recomendadas para aprovação. Clique em **Install Updates** (Instalar actualizações) ou **Review and Install Updates** (Rever e instalar actualizações) para concluir o processo.

#### Informações de Instalação

Se a aplicação tiver sido instalada a partir de uma localização no servidor, o administrador do servidor terá de actualizar a localização do servidor com a actualização administrativa e implementar essa actualização no computador do utilizador.

**Informações de Instalação**

Os parâmetros de configuração que se seguem são relevantes para as instalações administrativas, pois permitem que um administrador personalize a forma de extracção dos ficheiros a partir da actualização de segurança.

A actualização de segurança suporta os seguintes parâmetros de configuração para o Content Management Server 2001 Service Pack 1:

| Parâmetro | Descrição                                                                                    |
|-----------|----------------------------------------------------------------------------------------------|
| **/q**    | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos. |

A actualização de segurança suporta os seguintes parâmetros de configuração para o Content Management Server 2002 Service Pack 1:

| Parâmetro   | Descrição                                                                                                                    |
|-------------|------------------------------------------------------------------------------------------------------------------------------|
| **/q**      | Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.                                 |
| **/q:u**    | Especifica o modo silencioso de utilizador, que apresenta algumas caixas de diálogo ao utilizador.                           |
| **/q:a**    | Especifica o modo silencioso de administrador, que não apresenta qualquer caixa de diálogo ao utilizador.                    |
| **/t:path** | Especifica a pasta de destino para a extracção de ficheiros.                                                                 |
| **/c**      | Extrai os ficheiros sem os instalar. Se **/t:path** não for especificado, ser-lhe-á pedida uma pasta de destino.             |
| **/c:path** | Substitui o comando de instalação definido pelo autor. Especifica o caminho e nome do ficheiro Setup.inf ou .exe.            |
| **/r:n**    | Nunca reinicia o computador após a instalação.                                                                               |
| **/r:I**    | Solicita ao utilizador que reinicie o computador, se for necessário, excepto quando este parâmetro é utilizado com **/q:a**. |
| **/r:a**    | Reinicia sempre o computador após a instalação.                                                                              |
| **/r:s**    | Reinicia o computador após a instalação sem solicitar a confirmação do utilizador.                                           |
| **/n:v**    | Sem verificação da versão - Instalar o programa sobre qualquer versão anterior.                                              |

**Nota** Estes parâmetros não funcionam necessariamente com todas as actualizações. Se um parâmetro não estiver disponível, essa funcionalidade é necessária para a instalação correcta da actualização. Além disso, a utilização do parâmetro **/n:v** não é suportada e poderá fazer com que o sistema não arranque. Se a instalação não tiver êxito, contacte um técnico de suporte para compreender por que não foi possível instalar.

Para obter mais informações sobre os parâmetros de configuração suportados, consulte [o Artigo 197147 da Base de Dados de Conhecimento.](http://support.microsoft.com/kb/197147)

**Informações de implementação**

1.  Transfira esta actualização de segurança para o Content Management Server 2001 Service Pack 1 ou o Content Management Server 2002 Service Pack 2.
2.  Clique em **Guardar o programa no disco** e clique em **OK**.
3.  Clique em **Guardar**.
4.  Utilizando o Explorador do Windows, procure a pasta que contém o ficheiro guardado e faça duplo clique no mesmo.
5.  Se lhe for solicitado que instale a actualização, clique em **Sim**.
6.  Clique em **Sim** para aceitar o Contrato de Licença.
7.  Introduza o CD-ROM de origem quando tal lhe for solicitado e clique em **OK**.
8.  Quando receber uma mensagem que indica que a instalação teve êxito, clique em **OK**.

**Informações do ficheiro de instalação**

A versão inglesa desta actualização tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Content Management Server 2001 Service Pack 1:

| Nome do Ficheiro           | Versão      | Data        | Hora  | Tamanho   |
|----------------------------|-------------|-------------|-------|-----------|
| Aesecurityclient.dll       | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 124,704   |
| Aesecurityservice.exe      | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 154,400   |
| Aeserverobject.dll         | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 1,157,400 |
| Ncaspextensions.dll        | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 117,536   |
| Nrmsgres.dll               | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 160,016   |
| Reauthfilt.dll             | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 50,448    |
| Resolutionobjectmodel.dll  | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 1,133,352 |
| Serverconfigurationapi.dll | 4.10.1157.0 | 09-Nov-2006 | 00:30 | 641,320   |

Content Management Server 2002 Service Pack 2:

| Nome do Ficheiro                                            | Versão     | Data        | Hora  | Tamanho   |
|-------------------------------------------------------------|------------|-------------|-------|-----------|
| Activexediting.vbs                                          |            | 30-Jan-2007 | 20:47 | 17,857    |
| Aejavaproxy.dll                                             | 5.0.4484.0 | 24-Out-2003 | 10:33 | 1,994,752 |
| Aeserverobject.dll                                          | 5.0.5317.0 | 30-Jan-2007 | 21:14 | 1,193,472 |
| Authformclientie.js                                         |            | 30-Jan-2007 | 20:47 | 7,422     |
| Cms2002.xml                                                 |            | 26-Fev-2007 | 21:39 | 7,972     |
| Console.js                                                  |            | 30-Jan-2007 | 20:47 | 9,501     |
| Emitterthineditie\_activex.inc                              |            | 30-Jan-2007 | 23:05 | 24,371    |
| Hlink.js                                                    |            | 30-Jan-2007 | 20:47 | 5,204     |
| Microsoft.contentmanagement.common.dll                      | 5.0.5317.0 | 30-Jan-2007 | 21:13 | 57,344    |
| Microsoft.contentmanagement.developertools.visualstudio.dll | 5.0.5317.0 | 30-Jan-2007 | 21:17 | 126,976   |
| Microsoft.contentmanagement.webauthor.dll                   | 5.0.5317.0 | 30-Jan-2007 | 21:15 | 397,312   |
| Microsoft.contentmanagement.webcontrols.dll                 | 5.0.5317.0 | 30-Jan-2007 | 21:15 | 204,800   |
| Ncaspextensions.dll                                         | 5.0.5317.0 | 30-Jan-2007 | 21:13 | 164,864   |
| Ncbmprdr.dll                                                | 5.0.5317.0 | 30-Jan-2007 | 21:13 | 149,504   |
| Nrdcapplication.exe                                         | 5.0.0.5317 | 30-Jan-2007 | 21:18 | 2.240.608 |
| Nrdhtml.cab                                                 |            | 30-Jan-2007 | 21:30 | 233,743   |
| Nrsitedeployclient.dll                                      | 5.0.5317.0 | 30-Jan-2007 | 21:15 | 588,800   |
| Nrsitedeployserver.dll                                      | 5.0.5317.0 | 30-Jan-2007 | 21:15 | 2,051,072 |
| Resolutionobjectmodel.dll                                   | 5.0.5317.0 | 30-Jan-2007 | 21:14 | 1,485,312 |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a pergunta frequente, “Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?” na secção de Perguntas mais frequentes relativas a esta actualização de segurança, publicada neste boletim.

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Martyn Tovey, da [Netcraft](http://news.netcraft.com/), por fornecer informações sobre a Vulnerabilidade de execução de scripts entre sites e de ocultação no Microsoft Content Management Server – (CVE-2007-0939)

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outras questões de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Centro de Gestão de Actualizações TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166/pt).
-   [Office Update](http://office.microsoft.com/pt-pt/downloads/default.aspx)

**Software Update Services:**

Utilizando os Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scan Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (10 de Abril de 2007): Boletim publicado.
-   V1.1 (1 de Maio de 2007): Boletim actualizado. Avisos identificados no [Artigo 924429 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/924429), que documenta os problemas actualmente conhecidos que os clientes poderão experimentar quando instalam esta actualização de segurança.
-   V2.0 (12 de Junho de 2007): Boletim actualizado: Este boletim foi publicado novamente para resolver questões identificadas no [Artigo 924429 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/924429).

*Built at 2014-04-18T01:50:00Z-07:00*
