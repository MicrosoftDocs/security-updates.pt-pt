---
TOCTitle: 'MS07-028'
Title: 'Microsoft Security Bulletin MS07-028 - Crítica'
ms:assetid: 'ms07-028'
ms:contentKeyID: 61234281
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms07-028(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS07-028 - Crítica
==============================================

Vulnerabilidade no CAPICOM poderia permitir Execução Remota de Código (931906)
------------------------------------------------------------------------------

Data de publicação: 8 de maio de 2007

**actualizada:** 1.0

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o CAPICOM ou o BizTalk 2004

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes deverão aplicar de imediato a actualização

**Substituição de Actualizações de Segurança:** Nenhum

**Avisos:** Nenhum

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   CAPICOM — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   Platform SDK Redistributable: CAPICOM — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 1 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 2 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)

**Software Não Afectado:**

-   BizTalk Server 2000
-   BizTalk Server 2002
-   BizTalk Server 2006

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões são antigas ou ultrapassaram o respectivo ciclo de vida de suporte ou não são afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve uma vulnerabilidade recentemente descoberta e comunicada de forma privada. A vulnerabilidade está documentada neste boletim na respectiva subsecção, em "Detalhes sobre a Vulnerabilidade".

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                         | Impacto da Vulnerabilidade | CAPICOM | Microsoft BizTalk Server 2004 |
|----------------------------------------------------------------------------------------------------------------------------|----------------------------|---------|-------------------------------|
| Vulnerabilidade no CAPICOM.Certificates - [CVE-2007-0940](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0940) | Execução Remota de Código  | Crítica | Crítica                       |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Que actualizações são substituídas por esta edição?**
Esta actualização de segurança não substitui qualquer actualização de segurança anterior.

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Produto             | MBSA 1.2.1 | EST | MBSA 2.0.1 |
|---------------------|------------|-----|------------|
| CAPICOM             | Não        | Sim | Sim        |
| Biztalk Server 2004 | Não        | Sim | Sim        |

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). Para mais informações sobre software que o Microsoft Update e o MBSA 2.0 não detectam actualmente, consulte o [Artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723/pt): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.

**O que é a ferramenta** **Enterprise** **Update Scan Tool (EST)?**
Como parte do compromisso permanente de fornecimento de ferramentas de detecção para actualizações de segurança registadas nos boletins, a Microsoft lança uma ferramenta de detecção independente sempre que o Microsoft Baseline Security Analyzer 1.2.1 e a ferramenta Office Detection Tool (ODT) não conseguem detectar se a actualização é necessária para um ciclo de publicação MSRC. Esta ferramenta independente é denominada Enterprise Update Scan Tool (EST) e é concebida para administradores de sistemas empresariais. Quando é criada uma versão da Enterprise Update Scan Tool para um boletim específico, os clientes podem executar a ferramenta a partir de uma interface de linha de comando (CLI) e ver os resultados do ficheiro de saída XML. Para ajudar os clientes a utilizar melhor a ferramenta, será fornecida documentação detalhada juntamente com a ferramenta. Existe também uma versão da ferramenta que oferece uma experiência integrada para administradores SMS.

**Posso usar uma versão da ferramenta** **Enterprise** **Update Scan Tool (EST) para determinar se esta actualização é necessária?**
Sim. A Microsoft criou uma versão da EST que irá determinar se tem de aplicar esta actualização. Para ligações de transferências e para obter mais informações sobre a versão da EST que será lançada este mês, consulte o [artigo 894193 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/894193/pt). Os clientes com o SMS devem consultar a pergunta "Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?" na secção Perguntas mais frequentes, para mais informações sobre o SMS e a EST.

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Produto             | SMS 2.0         | SMS 2003 |
|---------------------|-----------------|----------|
| CAPICOM             | Sim (com a EST) | Sim      |
| Biztalk Server 2004 | Sim (com a EST) | Sim      |

Os utilizadores do SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem utilizar o MBSA 1.2.1 para detecção e, por isso, têm a mesma limitação listada anteriormente neste boletim, relacionada com programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool (SUIT), pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre o SUIT, visite o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/pt). Para mais informações sobre as limitações do SUIT, consulte [o artigo 306460 da base de dados de conhecimento da Microsoft](http://support.microsoft.com/kb/306460/pt). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para mais informações sobre o SMS 2003 ITMU, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723/pt): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.

**Posso utilizar o SMS para determinar se outros programas instalados têm de ser actualizados?**
Sim. O SMS pode ajudar a detectar se existem outros programas instalados que poderão ter instalado uma versão do componente vulnerável. O SMS pode procurar se existe o ficheiro CAPICOM.dll. Actualize todas as versões do CAPICOM.dll que são anteriores à versão 2.1.0.2.

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade no CAPICOM.Certificates - CVE-2007-0940:

Existe uma vulnerabilidade de execução remota de código no CAPICOM (Cryptographic API Component Object Model - Modelo de Objectos de Componentes API Criptográficos) que poderia permitir que um intruso que tivesse explorado esta vulnerabilidade com sucesso obtivesse controlo total sobre o sistema afectado.

#### Factores atenuantes para a Vulnerabilidade no CAPICOM.Certificates - CVE-2007-0940:

-   Num cenário de ataque com base na Web, um intruso teria de alojar um Web site contendo uma página Web que fosse utilizada para tirar partido desta vulnerabilidade. Um intruso não conseguiria obrigar os utilizadores a visitarem um Web site especialmente concebido para o efeito. Em vez disso, um intruso teria de convencê-los a visitar o Web site, levando-os normalmente a clicar numa hiperligação que os levasse ao Web site do intruso. Depois de clicarem numa ligação, ser-lhes-ia solicitado que executassem várias acções. Um ataque só poderia ocorrer depois de terem executado estas acções.
-   Um intruso que explorasse com sucesso esta vulnerabilidade poderia obter os mesmos privilégios que o utilizador local. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.
-   Como pré-definição, todas as versões suportadas do Microsoft Outlook e do Microsoft Outlook Express abrem mensagens de correio electrónico em HTML na zona de Sites restritos. A zona de Sites restritos ajuda a reduzir a quantidade de ataques que tentem explorar esta vulnerabilidade com sucesso, ao impedir a utilização de Scripts Activos e Controlos ActiveX durante a leitura de correio electrónico em HTML. Contudo, se um utilizador clicar numa hiperligação numa mensagem de correio electrónico, poderá continuar vulnerável a este problema através de um cenário de ataque baseado na Web.
-   Por predefinição, o Internet Explorer do Windows Server 2003 é executado no modo restrito, conhecido como a [Configuração de Segurança Avançada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo define o nível de segurança para a zona da Internet como Elevado. Este é um factor atenuante para Web sites que não foram adicionados à Zona de sites fidedignos do Internet Explorer. Consulte a subsecção de Perguntas mais frequentes desta secção da vulnerabilidade para obter mais informações acerca da Configuração de Segurança Avançada do Internet Explorer.
-   Por predefinição, este controlo ActiveX não está incluído na lista de permissões predefinida para controlos ActiveX no Internet Explorer 7. Apenas os clientes que tenham aprovado explicitamente este controlo utilizando a funcionalidade para permitir ActiveX correm o risco de tentativas de exploração desta vulnerabilidade. Contudo, se um cliente tiver usado este controlo ActiveX numa versão anterior do Internet Explorer, este controlo ActiveX está activo no Internet Explorer 7, mesmo que o cliente não tenha aprovado explicitamente a sua utilização na funcionalidade para permitir ActiveX.

#### Soluções alternativas para a Vulnerabilidade no CAPICOM.Certificates - CVE-2007-0940:

A Microsoft testou as seguintes soluções alternativas. Embora estas soluções alternativas não corrijam a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Desactivar tentativas de instanciar o controlo CAPICOM no Internet Explorer**

    Pode desactivar tentativas de instanciar este controlo ActiveX definindo o kill bit para o controlo no registo.

    **Aviso** Se utilizar o Editor de Registo incorrectamente, pode causar problemas sérios que podem vir a obrigar à reinstalação do seu sistema operativo. A Microsoft não pode garantir que consiga resolver problemas que resultam da utilização incorrecta do Editor de Registo. A utilização do Editor de Registo é da sua responsabilidade.

    Para obter informações detalhadas sobre o que pode usar para impedir que um controlo seja executado no Internet Explorer, consulte o [Artigo 240797 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/240797/pt). Siga os passos apresentados neste artigo para criar um valor Compatibility Flags no registo para impedir que o objecto COM seja instanciado no Internet Explorer.

    Para definir o kill bit para os CLSIDs com o valor de:

    -   {17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}
    -   {FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}

    Cole o texto seguinte num editor de texto como o Notepad. Depois, guarde o ficheiro com a extensão de nome de ficheiro .reg.

    Editor de registo do Windows versão 5.00
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}\]

    "Compatibility Flags"=dword:00000400

    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}\]

    "Compatibility Flags"=dword:00000400

    Pode aplicar este ficheiro .reg a sistemas individuais ao clicar duas vezes sobre ele. Pode ainda aplicá-lo através de domínios usando uma Política de Grupo. Para mais informações sobre as Políticas de Grupos, consulte os seguintes Web sites da Microsoft:

    [Conjunto de Política de Grupos](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd.mspx)

    [O que é o Editor de Objectos da Política de Grupos?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

    [Ferramentas e definições da Política de Grupos Central](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/e926577a-5619-4912-b5d9-e73d4bdc9491.mspx)

    **Nota:** Tem de reiniciar o Internet Explorer para que as alterações tenham efeito.

    **Impacto da solução alternativa**: O controlo CAPICOM poderá deixar de ser apresentado ou de funcionar correctamente.

-   **Configure o Internet Explorer de forma a que seja pedida uma confirmação antes de executar controlos ActiveX, ou desactive-os nas zonas de segurança de Intranet Local e Internet.**

    Pode ajudar a proteger-se contra esta vulnerabilidade alterando as definições do Internet Explorer para pedir confirmação antes de executar controlos ActiveX. Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique no separador **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Personalizar Nível**.
    4.  Em **Definições**, na secção **Controlos e extensões ActiveX**, em **Executar controlos e extensões ActiveX**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK.**
    5.  Clique em **Intranet Local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Definições**, na secção **Controlos e extensões ActiveX**, em **Executar controlos e extensões ActiveX**, clique em **Pedir** ou **Desactivar** e, em seguida, clique em **OK.**
    7.  Clique duas vezes em **OK** para voltar ao Internet Explorer.

    **Impacto da solução alternativa:** Existem efeitos secundários da confirmação antes de executar controlos ActiveX. Muitos Web sites na Internet ou numa intranet utilizam o ActiveX para fornecer funcionalidades adicionais. Por exemplo, um site de comércio electrónico online ou sites de operações bancárias podem utilizar controlos ActiveX para fornecer menus, formulários de encomenda ou mesmo extractos bancários. A solicitação de confirmação antes de executar controlos ActiveX é uma definição global que afecta todos os sites da Internet e intranet. Ser-lhe-á pedida frequentemente a confirmação quando activar esta solução alternativa. Para cada pedido, se achar que pode confiar no site que está a visitar, clique em **Sim** para executar os controlos ActiveX. Se não quiser que lhe seja pedida a confirmação para todos estes sites, efectue os passos indicados em "Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer”.

    **Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer**

    Depois de definir o Internet Explorer para requerer solicitação antes de executar controlos ActiveX e Scripts Activos nas zonas da Internet e da Intranet Local, pode adicionar sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer. Isto irá permitir que continue a utilizar os Web sites fidedignos da mesma forma que actualmente, enquanto ajuda a proteger-se contra este ataque a sites não fidedignos. A Microsoft recomenda que adicione à Zona de sites fidedignos unicamente sites que considere fidedignos.

    Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique no separador **Segurança**.
    2.  Na caixa **Seleccione uma zona de conteúdo da Web para especificar as respectivas definições de segurança**, clique em **Sites Fidedignos** e, em seguida, clique em **Sites**.
    3.  Se quiser adicionar sites que não precisam de um canal encriptado, desmarque a caixa de verificação **Pedir verificação de servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este Web site à zona**, escreva o URL de um site que considere fidedigno e, em seguida, clique em **Adicionar**.
    5.  Repita estes passos para cada site que pretenda adicionar à zona.
    6.  Clique duas vezes em **OK** para aceitar as alterações e voltar ao Internet Explorer.

    **Nota** Adicione sites que considera fidedignos de não provocarem acções maliciosas no seu computador. Há dois em particular que pode querer adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem aspas). Estes são os sites que alojam a actualização e requerem a utilização de um Controlo ActiveX para instalar a actualização.

-   **Configure as definições das zonas de segurança de Intranet Local e Internet para “Alta”, para que seja pedida a confirmação antes de executar Controlos ActiveX e Scripts Activos nestas zonas.**

    Pode ajudar a proteger-se contra esta vulnerabilidade alterando as definições da zona de segurança da Internet para pedir confirmação antes de executar controlos ActiveX. Pode contribuir para isso definindo a segurança do seu browser para **Alta**.

    Para subir o nível de segurança do browser no Microsoft Internet Explorer, siga estes passos:

    1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.
    2.  Na caixa de diálogo **Opções da Internet**, clique no separador **Segurança** e, em seguida, clique no ícone **Internet**.
    3.  Em **Nível de segurança para esta zona**, mova o cursor para **Alta**. Isso define o nível de segurança para **Alto** para todos os Web sites que visita.

    **Nota** Se não vir nenhum cursor, clique em **Nível predefinido** e, em seguida, mova o cursor para **Alto**.

    **Nota** Definir o nível para **Alto** pode fazer com que alguns Web sites funcionem incorrectamente. Se tiver dificuldade em usar o Web site depois de alterar esta definição e tiver a certeza de que o site é seguro, pode adicionar esse site à sua lista de sites fidedignos. Isto permitirá que o site funcione correctamente, mesmo com a definição de segurança configurada para **Alta**.

    **Impacto da solução alternativa:** Existem efeitos secundários da confirmação antes de executar controlos ActiveX. Muitos Web sites na Internet ou numa intranet utilizam o ActiveX para fornecer funcionalidades adicionais. Por exemplo, um site de comércio electrónico online ou sites de operações bancárias podem utilizar controlos ActiveX para fornecer menus, formulários de encomenda ou mesmo extractos bancários. A solicitação de confirmação antes de executar controlos ActiveX é uma definição global que afecta todos os sites da Internet e intranet. Ser-lhe-á pedida frequentemente a confirmação quando activar esta solução alternativa. Para cada pedido, se achar que pode confiar no site que está a visitar, clique em **Sim** para executar os controlos ActiveX. Se não quiser que lhe seja pedida a confirmação para todos estes sites, efectue os passos indicados em "Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer”.

    **Adicione sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer**

    Depois de definir o Internet Explorer para requerer solicitação antes de executar controlos ActiveX e Scripts Activos nas zonas da Internet e da Intranet Local, pode adicionar sites que considere fidedignos à Zona de sites fidedignos do Internet Explorer. Isto irá permitir que continue a utilizar os Web sites fidedignos da mesma forma que actualmente, enquanto ajuda a proteger-se contra este ataque a sites não fidedignos. A Microsoft recomenda que adicione à Zona de sites fidedignos unicamente sites que considere fidedignos.

    Para isso, siga estes passos:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique no separador **Segurança**.
    2.  Na caixa **Seleccione uma zona de conteúdo da Web para especificar as respectivas definições de segurança**, clique em **Sites Fidedignos** e, em seguida, clique em **Sites**.
    3.  Se quiser adicionar sites que não precisam de um canal encriptado, desmarque a caixa de verificação **Pedir verificação de servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este Web site à zona**, escreva o URL de um site que considere fidedigno e, em seguida, clique em **Adicionar**.
    5.  Repita estes passos para cada site que pretenda adicionar à zona.
    6.  Clique duas vezes em **OK** para aceitar as alterações e voltar ao Internet Explorer.

    **Nota** Adicione sites que considera fidedignos de não provocarem acções maliciosas no seu computador. Há dois em particular que pode querer adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem aspas). Estes são os sites que alojam a actualização e requerem a utilização de um Controlo ActiveX para instalar a actualização.

#### Perguntas mais frequentes sobre a Vulnerabilidade nos CAPICOM.Certificates - CVE-2007-0940:

**Qual é a abrangência desta vulnerabilidade? **
Esta é uma vulnerabilidade de execução remota de código. Um intruso que conseguisse tirar partido da vulnerabilidade poderia obter o controlo total de um sistema afectado remotamente. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.

**O que provoca a vulnerabilidade? **
A vulnerabilidade é provocada pela forma como a classe CAPICOM Certificates processa algumas entradas. O controlo ActiveX poderia falhar de um modo que poderia permitir a execução remota de código se fossem transmitidos dados inesperados.

**O que é o CAPICOM.Certificates? **
O CAPICOM.Certificates é um controlo ActiveX que fornece scripters (VBS, ASP, ASP.NET, etc.) através de um método de encriptação de dados com base na funcionalidade segura subjacente do Windows CryptoAPI. O CAPICOM Suite também está disponível para transferência como [Platform SDK Redistributable: CAPICOM](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6) e também faz parte do Windows Platform SDK e do Windows Driver Kit.

**O que acontece se eu desenvolver aplicações ou software e redistribuir o CAPICOM? **
Tem de transferir a versão mais recente do [Platform SDK Redistributable: CAPICOM](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6). Esta versão nova contém o CAPICOM.dll actualizado associado a esta actualização de segurança.

**Como posso saber se tenho o controlo CAPICOM.Certificates instalado e registado? **
Pode verificar se tem o CAPICOM instalado procurando o controlo CAPICOM.dll no sistema. Se tiver a versão 2.1.01 ou anterior, deve actualizar o seu sistema.

Pode verificar se tem qualquer combinação das seguintes chaves de registo e verificar se tem uma versão vulnerável do controlo ActiveX CAPICOM.Certificates registada no seu sistema:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.1\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.2\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.3\\CLSID

**Como poderia um intruso utilizar a vulnerabilidade? **
Um intruso que tirasse partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios. Os utilizadores cujas contas estão configuradas com menos direitos de utilização no sistema podem correr menos riscos do que os utilizadores que trabalham com direitos de utilização de administrador.

**Por que razão a versão mais antiga do CAPICOM.dll ainda está no sistema depois de ter instalado esta actualização de segurança? **
Os utilizadores podem ter instalado o CAPICOM.dll a partir de uma fonte que não a Microsoft. O CAPICOM.dll pode ter sido instalado por um produto que não seja da Microsoft. Uma vez que a actualização de segurança não pode determinar a origem da versão do CAPICOM.dll anterior, este é deixado no sistema para efeitos de compatibilidade da aplicação. A versão anterior não deixa o sistema susceptível a esta vulnerabilidade.

**Quem poderia explorar a vulnerabilidade? **
No cenário de um ataque baseado na Web, um intruso teria de alojar um Web site contendo uma página Web que fosse utilizada na tentativa de exploração desta vulnerabilidade. Um intruso não conseguiria obrigar os utilizadores a visitarem um Web site especialmente concebido para o efeito. Em vez disso, um intruso teria de persuadi-los a visitar o Web site, normalmente conseguindo que clicassem numa ligação que os levasse ao site do intruso.

**Quais são os sistemas mais susceptíveis face a esta vulnerabilidade? **
Esta vulnerabilidade exige que um utilizador tenha sessão iniciada e que visite um Web site para que ocorra qualquer acção nociva. Deste modo, qualquer sistema que tenha o CAPICOM.Certificates instalado e registado e em que o Internet Explorer seja frequentemente utilizado, como por exemplo estações de trabalho ou servidores de terminais, está mais susceptível a esta vulnerabilidade.

**Utilizo o Internet Explorer 7. Isso atenua esta vulnerabilidade? **
Sim. Os clientes que utilizam o Internet Explorer 7 com as suas configurações pré-definidas não são afectados, desde que o controlo CAPICOM.Certificates não tenha sido activado através da funcionalidade para permitir controlos ActiveX na zona da Internet. Contudo, se um cliente tiver usado este controlo ActiveX numa versão anterior do Internet Explorer, este controlo ActiveX está activo no Internet Explorer 7, mesmo que o cliente não tenha aprovado explicitamente a sua utilização na funcionalidade para permitir ActiveX.

**O que é a funcionalidade para permitir ActiveX no Internet Explorer 7? **
O Internet Explorer 7 inclui uma funcionalidade para permitir ActiveX, o que significa que quase todos os controlos ActiveX pré-instalados estão desactivados por predefinição. A Barra de Informações avisa os utilizadores antes que possam aceder a um controlo ActiveX previamente instalado e que ainda não tenha sido utilizado na Internet. Assim, um utilizador pode permitir ou negar o acesso de forma selectiva para cada controlo. Para mais informações sobre esta e outras novas funcionalidades, visite a [página de funcionalidades do Windows Internet Explorer 7](http://www.microsoft.com/portugal/windows/ie/ie7/about/features/default.mspx).

**Tenho o Internet Explorer no Windows Server 2003. Isso atenua esta vulnerabilidade? **
Sim. Por predefinição, o Internet Explorer do Windows Server 2003 é executado no modo restrito, conhecido como a [Configuração de Segurança Avançada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo define o nível de segurança para a zona da Internet como Elevado. Este é um factor atenuante para Web sites que não foram adicionados à Zona de sites fidedignos do Internet Explorer. Consulte a secção de Perguntas mais frequentes sobre esta actualização de segurança para obter mais informações acerca da Configuração de Segurança Avançada do Internet Explorer.

**O que é a Configuração de Segurança Avançada do Internet Explorer? **
A Configuração de Segurança Avançada do Internet Explorer é um grupo de definições pré-configuradas do Internet Explorer que reduz a probabilidade de um utilizador ou de um administrador transferir e executar conteúdos da Web maliciosos num servidor. A Configuração de Segurança Avançada do Internet Explorer reduz esta ameaça modificando inúmeras configurações relacionadas com segurança, incluindo configurações dos separadores Segurança e Avançadas nas Opções da Internet. Algumas das modificações importantes incluem:

-   O nível de segurança para a zona da Internet está definido como **Elevado**. Esta definição desactiva scripts, componentes ActiveX, Microsoft Virtual Machine (Microsoft VM), conteúdo HTML e transferências de ficheiros.
-   A detecção automática de sites da intranet está desactivada. Esta definição atribui todos os Web sites da intranet e todos os caminhos da Convenção de Nomenclatura Universal (UNC, Universal Naming Convention), que não estejam listados explicitamente na zona da Intranet Local, para a zona da Internet.
-   A instalação a pedido e as extensões do browser que não sejam da Microsoft estão desactivados. Esta definição impede as páginas Web de instalarem automaticamente componentes e impede a execução de extensões que não sejam da Microsoft.
-   O conteúdo multimédia está desactivado. Esta definição impede a execução de música, animação e reprodução de vídeo.

Para mais informações sobre a Configuração de Segurança Avançada do Internet Explorer, consulte o guia de Gestão da configuração de segurança avançada do Internet Explorer, disponível no seguinte [Web site](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en).

**O que faz a actualização? **
A actualização elimina a vulnerabilidade modificando a forma como o controlo ActiveX CAPICOM.Certificates executa a validação de parâmetros. Também resolve outras questões descobertas através de investigações internas.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente? **
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada? **
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica para o software afectado, consulte a secção adequada:

#### CAPICOM e BizTalk Server 2004

**Pré-requisitos**
Esta actualização de segurança requer que o controlo CAPICOM Certificates esteja instalado e registado. O BizTalk Server 2004 instala o CAPICOM Certificates. Esta actualização funcionará com instalações autónomas e do BizTalk Server 2004. Os produtos que não são da Microsoft podem redistribuir e instalar o CAPICOM.dll. Consulte a Pergunta frequente “**Como posso saber se tenho o controlo CAPICOM.Certificates instalado e registado?”** para obter mais detalhes.

**Inclusão em Service Packs Futuros**
A actualização para esta questão poderá ser incluída num service pack ou num conjunto de actualizações futuros para o Microsoft BizTalk Server 2004.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso ou suprime mensagens quando os ficheiros estão a ser extraídos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q:u**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso de utilizador, que apresenta algumas caixas de diálogo ao utilizador.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/q:a**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso de administrador, que não apresenta qualquer caixa de diálogo ao utilizador.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/t:**&lt;full path&gt;
</td>
<td style="border:1px solid black;">
Especifica a pasta de destino para a extracção de ficheiros.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/c**
</td>
<td style="border:1px solid black;">
Extrai os ficheiros sem os instalar. Se o caminho /T: não for especificado, será pedida ao utilizador uma pasta de destino.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/c:**&lt;Cmd&gt;
</td>
<td style="border:1px solid black;">
Substitui o Comando de Instalação definido pelo autor. Especifica o caminho e o nome do ficheiro de configuração .inf ou .exe.
</td>
</tr>
</table>
 
**Nota** Estes parâmetros não funcionam necessariamente com todas as actualizações. Se um parâmetro não estiver disponível, essa funcionalidade é necessária para a instalação correcta da actualização. Se a instalação não tiver êxito, deverá consultar um técnico de suporte para compreender o motivo da falha.

Para mais informações sobre os parâmetros de configuração suportados, consulte o [Artigo 197147 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/197147).

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos:

**CAPICOM-KB931906-v2102 /q:a**

Para obter informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

Esta actualização não requer um reinício.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

| Nome do Ficheiro | Versão  | Data        | Hora  | Tamanho |
|------------------|---------|-------------|-------|---------|
| License.mht      | NA      | 26-Fev-2007 | 23:16 | 142,534 |
| License.rtf      | NA      | 26-Fev-2007 | 23:16 | 134,577 |
| CAPICOM.dll      | 2.1.0.2 | 11-Abr-2007 | 18:11 | 511,328 |

**Verificar se a Actualização foi aplicada**

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.4\\CLSID

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Chris Ries, da [VigilantMinds Inc.](http://www.vigilantminds.com/), por fornecer informações sobre a Vulnerabilidade no CAPICOM.Certificates (CVE-2007-0940)

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outras questões de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Centro de Gestão de Actualizações TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166/pt).
-   [Office Update](http://office.microsoft.com/pt-pt/downloads/default.aspx)

**Software Update Services:**

Utilizando os Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scan Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (8 de Maio de 2007): Boletim publicado.

*Built at 2014-04-18T01:50:00Z-07:00*
