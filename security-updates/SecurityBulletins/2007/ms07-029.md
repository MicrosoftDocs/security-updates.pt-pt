---
TOCTitle: 'MS07-029'
Title: 'Microsoft Security Bulletin MS07-029 - Crítica'
ms:assetid: 'ms07-029'
ms:contentKeyID: 61234282
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms07-029(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS07-029 - Crítica
==============================================

Vulnerabilidade na Interface RPC do DNS do Windows poderia permitir a Execução Remota de Código (935966)
--------------------------------------------------------------------------------------------------------

Data de publicação: 8 de maio de 2007 | Updated: 6 de junho de 2007

**actualizada:** 1.2

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o Microsoft Windows

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes deverão aplicar de imediato a actualização

**Substituição de Actualizações de Segurança:** Nenhum

**Avisos:** Nenhum

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   Microsoft Windows 2000 Server Service Pack 4 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=d9de0480-5fa9-4974-a82f-5d89056484c4)
-   Microsoft Windows Server 2003 Service Pack 1 e Microsoft Windows Server 2003 Service Pack 2 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=dfb5eaca-788b-475c-9817-491f0b7cf295)
-   Microsoft Windows Server 2003 com SP1 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com SP2 para sistemas baseados em Itanium — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=d4ce0aa8-46ac-446c-b1e3-ff76f1311610)
-   Microsoft Windows Server 2003 x64 Edition e Microsoft Windows Server 2003 x64 Edition Service Pack 2 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=e7a7b46b-775d-4912-8119-3ab9a95d775a)

**Software Não Afectado:**

-   Microsoft Windows 2000 Professional Service Pack 4
-   Microsoft Windows XP Service Pack 2
-   Microsoft Windows XP Professional x64 Edition e Microsoft Windows XP Professional x64 Edition Service Pack 2
-   Windows Vista
-   Windows Vista x64 Edition

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões são antigas ou ultrapassaram o respectivo ciclo de vida de suporte ou não são afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve uma vulnerabilidade divulgada publicamente. A vulnerabilidade está documentada neste boletim na respectiva subsecção, em "Detalhes sobre a Vulnerabilidade".

Um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter o controlo total de um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                         | Impacto da Vulnerabilidade | Windows 2000 Server Service Pack 4 | Windows Server 2003 Service Pack 1 e Windows Server 2003 Service Pack 2 | Windows Server 2003 com SP1 para sistemas baseados em Itanium e Windows Server 2003 com SP2 para sistemas baseados em Itanium | Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2 |
|----------------------------------------------------------------------------------------------------------------------------|----------------------------|------------------------------------|-------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| Vulnerabilidade na Gestão de RPC no DNS - [CVE-2007-1748](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1748) | Execução Remota de Código  | Crítica                            | Crítica                                                                 | Crítica                                                                                                                       | Crítica                                                                          |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

**Nota** O serviço de servidor DNS poderá não estar activado por predefinição em algumas configurações de função do servidor. Nas configurações do servidor em que não esteja activado por predefinição, o boletim de segurança é considerado importante. A classificação e gravidade Crítica dos boletins refere-se às configurações do controlador de domínio com funcionalidade de servidor DNS, servidor DNS, Microsoft Small Business Server e função do servidor em que o serviço de servidor DNS esteja activado por predefinição.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Estou a usar uma versão anterior do software discutido neste boletim de segurança - o que devo fazer? **
O software afectado incluído neste boletim foi testado para determinar se as respectivas versões são afectadas. As outras versões ultrapassaram o respectivo ciclo de vida de suporte. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

Os utilizadores que tenham versões anteriores do software deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o [Web site do Ciclo de Vida do Suporte da Microsoft](http://support.microsoft.com/lifecycle/). Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o [Web site de Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que necessitem de suporte personalizado para software anterior devem contactar o seu representante de equipa de contas da Microsoft, o seu Gestor Técnico de Contas ou o parceiro ou representante Microsoft adequado para mais informações sobre opções de suporte personalizado. Os clientes que não disponham de um Contrato Alliance, Premier ou Autorizado podem contactar a subsidiária local da Microsoft. Para obter informações de contacto, visite o [Web site Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), seleccione o país e, em seguida, clique em **Go** para ver uma lista de números de telefone. Quando telefonar, peça para falar com o Gestor de Vendas de Suporte Premier local. Para mais informações, consulte as [Perguntas mais frequentes de suporte sobre o ciclo de vida de produto, relativas aos sistemas operativos Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária? **
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Produto                                                                                                                                           | MBSA 1.2.1 | MBSA 2.0.1 |
|---------------------------------------------------------------------------------------------------------------------------------------------------|------------|------------|
| Microsoft Windows 2000 Server Service Pack 4                                                                                                      | Sim        | Sim        |
| Microsoft Windows Server 2003 Service Pack 1 e Microsoft Windows Server 2003 Service Pack 2                                                       | Sim        | Sim        |
| Microsoft Windows Server 2003 com SP1 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com SP2 para sistemas baseados em Itanium | Não        | Sim        |
| Microsoft Windows Server 2003 x64 Edition e Microsoft Windows Server 2003 x64 Edition Service Pack 2                                              | Não        | Sim        |

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para mais informações sobre software que o Microsoft Update e o MBSA 2.0 não detectam actualmente, consulte o [Artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660).

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Produto                                                                                                                                           | SMS 2.0 | SMS 2003 |
|---------------------------------------------------------------------------------------------------------------------------------------------------|---------|----------|
| Microsoft Windows 2000 Server Service Pack 4                                                                                                      | Sim     | Sim      |
| Microsoft Windows Server 2003, Microsoft Windows Server 2003 Service Pack 1 e Microsoft Windows Server 2003 Service Pack 2                        | Sim     | Sim      |
| Microsoft Windows Server 2003 com SP1 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com SP2 para sistemas baseados em Itanium | Não     | Sim      |
| Microsoft Windows Server 2003 x64 Edition e Microsoft Windows Server 2003 x64 Edition Service Pack 2                                              | Não     | Sim      |

Os utilizadores do SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem utilizar o MBSA 1.2.1 para detecção e, por isso, têm a mesma limitação listada anteriormente neste boletim, relacionada com programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool (SUIT), pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre o SUIT, visite o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/pt). Para mais informações sobre as limitações do SUIT, consulte [o artigo 306460 da base de dados de conhecimento da Microsoft](http://support.microsoft.com/kb/306460/pt). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para mais informações sobre o SMS 2003 ITMU, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

Para obter informações mais detalhadas, consulte o [Artigo 910723 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/910723/pt): Lista de resumo de artigos mensais sobre orientações de detecção e implementação.

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade na Gestão de RPC no DNS - CVE-2007-1748:

Existe uma vulnerabilidade de execução remota de código no serviço de servidor DNS (Domain Name System) em todas as versões do servidor suportadas pelo Windows, que poderia permitir que um intruso que explorasse esta vulnerabilidade com sucesso assumisse o controlo total do sistema afectado.

#### Factores atenuantes para a Vulnerabilidade na Gestão de RPC no DNS - CVE-2007-1478:

O serviço de servidor DNS poderá não estar activado por predefinição em algumas configurações de função do servidor. Nas configurações do controlador de domínio com funcionalidade de servidor DNS, servidor DNS e Microsoft Small Business Server o serviço de servidor DNS está activado por predefinição.

#### Soluções alternativas para a Vulnerabilidade na Gestão de RPC no DNS - CVE-2007-1748:

A Microsoft testou as seguintes soluções alternativas. Apesar de a solução alternativa não corrigir a vulnerabilidade subjacente, ela ajuda a bloquear vectores de ataque conhecidos. Especificamente, todas estas soluções alternativas foram testadas e demonstraram bloquear tentativas de explorar a vulnerabilidade através de tráfego RPC, bem como das portas 139 e 445. Em seguida identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Desactivar a gestão remota através de capacidade RPC para servidores DNS através da definição da chave de registo.**

    **Nota** A utilização incorrecta do Editor de Registo pode provocar problemas graves que poderão conduzir à reinstalação do sistema operativo. A Microsoft não pode garantir que os problemas resultantes da utilização incorrecta do Editor de Registo possam ser resolvidos. A utilização do Editor de Registo é da sua responsabilidade.

    Para obter informações sobre como editar o registo, deve consultar o tópico de Ajuda "Alterar Chaves e Valores" do Editor de Registo (Regedit.exe) ou os tópicos de Ajuda "Adicionar e Eliminar Informações do Registo" e "Editar Dados do Registo" do regedit.exe.

    **Nota** Recomendamos a realização de uma cópia de segurança do registo antes de o editar.

    1.  No menu Iniciar, clique em **'Executar'**, escreva **'Regedit'** e prima ENTER.
    2.  Navegue para a seguinte localização de registo:
        “HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters”.
    3.  No menu **'Editar'** seleccione **'Novo'** e clique em **'Valor DWORD'.**
    4.  Onde estiver realçado **'Novo Valor \#1'**, escreva **'RpcProtocol'** para o nome do valor e, em seguida, prima ENTER.
    5.  Clique duas vezes no valor acabado de criar e altere os dados do valor para **'4'** (sem as aspas).
    6.  Reinicie o serviço DNS para que a alteração tenha efeito.

-   **Gestão de script de implementação**

    Pode ser utilizado o seguinte script de registo exemplificativo para activar esta definição de registo:

    Editor de registo do Windows versão 5.00
    \[HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters\]
    "RpcProtocol"=dword:00000004

    O script de registo acima pode ser guardado num ficheiro com extensão .REG, podendo ser implementado silenciosamente como parte de um script de implementação automática com utilização do regedit.exe e do parâmetro de linha de comando /s.

    O serviço DNS tem de ser reiniciado para que esta alteração tenha efeito.

    Para obter ajuda sobre a utilização do regedit.exe para implementar scripts de registo, consulte o [Artigo Q82821 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/q82821): Parâmetros de linhas de comando do editor de registo de informação (REGEDIT).

    **Como anular esta solução alternativa:** Para anular a solução alternativa, siga os seguintes passos:

    1.  No menu Iniciar, clique em **'Executar'**, escreva **'Regedit'** e prima ENTER.
    2.  Navegue para a seguinte localização de registo:
        “HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters”.
    3.  Seleccione a chave de registo **RpcProtocol**.
    4.  Clique com o botão direito sobre a chave RpcProtocol e seleccione **Eliminar**.
    5.  Reinicie o serviço DNS para que a alteração tenha efeito.

    **Valores de chaves de registo RpcProtocol**

    O valor ‘4’ utilizado acima restringe a interface RPC do DNS apenas para chamadas de procedimento local (LPC). Isto só permite a gestão local.

    Os valores seguintes estão disponíveis para a entrada de registo RpcProtocol: 

-   0x1 - Este valor corresponde a uma configuração de DNS\_RPC\_USE\_TCPIP \#define DNS\_RPC\_USE\_NAMED\_PIPE0x2
-   0x2 - Este valor corresponde a uma configuração de DNS\_RPC\_USE\_NAMED\_PIPE
-   0x4 - Este valor corresponde a uma configuração de DNS\_RPC\_USE\_LPC
-   **Desactivar a capacidade para gestão remota através de RPC**

    Pode configurar novamente a interface de gestão de servidor DNS para aceitar apenas LPC, definindo um valor no registo. Outras chaves de registo modificarão ou desactivarão a comunicação RPC de modos diferentes. Para mais informações sobre a chave de registo RpcProtocol, consulte o seguinte [artigo TechNet](http://technet2.microsoft.com/windowsserver/en/library/f9b959ae-345e-4639-813d-1c1064d94c901033.mspx?mfr=true).

    -   Definir o valor para 4 irá atenuar uma tentativa remota de explorar a vulnerabilidade.
    -   Definir o valor para 0 irá desactivar toda a funcionalidade RPC de DNS e irá proteger contra tentativas locais e remotas de explorar a vulnerabilidade.

    **Impacto da solução alternativa:** Definir o valor de registo para 4 irá desactivar a funcionalidade de gestão e configuração remota do servidor DNS utilizando RPC ou o WMI. As ferramentas de gestão DNS não poderão trabalhar de forma remota. A gestão local e remota através de serviços de terminal pode continuar a ser utilizada para gerir a configuração do seu servidor DNS.

    Poderá continuar a utilizar o snap-in MMC de gestão DNS, o DNSCMD.exe e o fornecedor de WMI de DNS se forem executados localmente a partir do servidor.

    Definir o valor de registo para 0 irá desactivar todas as capacidades de gestão RPC de DNS, incluindo administração e configuração local.

    A administração e configuração local do servidor DNS podem não funcionar se o servidor a ser gerido tiver um nome do computador com 15 caracteres e se for seleccionado pelo seu nome de computador. Para evitar esta questão, utilize o nome de domínio totalmente qualificado (FQDN) do computador que está a ser gerido nas ferramentas administrativas de DNS.

-   **Bloquear os seguintes elementos na firewall:**

    Bloquear a TCP e as portas UDP 445 e 139, bem como todo o tráfego de entrada não solicitado nas portas com um número superior a 1024.

    A interface RPC do DNS do Windows encontra-se numa porta superior à 1024. Enquanto que a maioria das ligações de portas RPC ocorre entre a gama 1024 e 5000, é possível que a interface RPC se possa ligar a números de portas superiores não reservados. O bloqueio destas portas na firewall ajuda a impedir que os sistemas protegidos por essa firewall sejam atacados por tentativas de explorar esta vulnerabilidade. Recomendamos que bloqueie todas as comunicações de entrada não solicitadas a partir da Internet, para ajudar a impedir ataques que possam utilizar outras portas. Para mais informações sobre as portas utilizadas pelo RPC, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=21312). Para bloquear todos os pedidos de RPC não solicitados preservando a funcionalidade de gestão DNS, consulte o [Artigo 555381 da Base de Dados de Conhecimento da Microsoft.](http://support.microsoft.com/kb/555381)

    **Nota**Um intruso teria de se autenticar utilizando um nome de utilizador e palavra-passe válidos para explorar a vulnerabilidade usando as portas 139 ou 445.

    **Impacto da solução alternativa:** A funcionalidade de gestão remota do servidor DNS utilizando RPC será desactivada. As ferramentas de gestão DNS não poderão trabalhar de forma remota. A gestão local e remota através de serviços de terminal pode continuar a ser utilizada para gerir a configuração do seu servidor DNS.

    Isto inclui o snap-in MMC de gestão DNS, o DNSCMD.exe e o fornecedor de WMI de DNS. A funcionalidade de gestão e controlo adicional poderá ser perdida para aplicações ou componentes que utilizam as portas afectadas.

    Bloquear a porta 445 impedirá que os computadores liguem ao servidor através de SMB e impedirá que os servidores acedam a pastas de rede partilhadas. As ferramentas administrativas que dependem de SMB para estabelecerem uma ligação não poderão ligar-se ao servidor.

-   **Activar a filtragem TCP/IP avançada em sistemas**

    É possível activar a filtragem TCP/IP avançada para bloquear todo o tráfego de entrada não solicitado. Para obter informações adicionais sobre como configurar a filtragem TCP/IP, consulte o [artigo 309798 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/309798/pt).

-   **Bloquear a TCP e as portas UDP 445 e 139, bem como as portas com número superior a 1024 afectadas, utilizando IPsec nos sistemas afectados**

    Utilize a funcionalidade de segurança de Protocolo Internet (IPsec) para ajudar a proteger as comunicações de rede. Estão disponíveis informações detalhadas sobre o protocolo IPSec e o modo de aplicação de filtros nos artigos [313190](http://support.microsoft.com/kb/313190) e [813878](http://support.microsoft.com/kb/813878) da Base de Dados de Conhecimento da Microsoft.

    **Nota** Um intruso terá de se autenticar utilizando um nome de utilizador e palavra-passe válidos para explorar a vulnerabilidade usando as portas 139 ou 445.

    **Impacto da solução alternativa:** A funcionalidade de gestão remota do servidor DNS utilizando RPC será desactivada. As ferramentas de gestão DNS não poderão trabalhar de forma remota. A gestão local e remota através de serviços de terminal pode continuar a ser utilizada para gerir a configuração do seu servidor DNS.

    Isto inclui o snap-in MMC de gestão DNS, o DNSCMD.exe e o fornecedor de WMI de DNS. A funcionalidade de gestão e controlo adicional poderá ser perdida para aplicações ou componentes que utilizam as portas afectadas.

    Bloquear a porta 445 evitará que os computadores se liguem ao servidor através de SMB e o servidor não poderá aceder a pastas partilhadas na rede. As ferramentas administrativas que dependem de SMB para estabelecerem uma ligação não poderão ligar-se ao servidor.

#### Perguntas mais frequentes sobre a Vulnerabilidade na Gestão de RPC no DNS - CVE-2007-1748:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de execução remota de código. Um intruso que conseguisse tirar partido da vulnerabilidade poderia obter o controlo total de um sistema afectado remotamente. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**O que provoca a vulnerabilidade?**
Existe uma sobrecarga da memória intermédia baseada em pilha na Interface de Gestão RPC (Remote Procedure Call) no serviço DNS (Domain Name System) do Windows.

**O que é a Chamada de Procedimento Remoto (RPC)?**  
A Chamada de Procedimento Remoto (RPC) é um protocolo que pode ser utilizado por um programa para requerer um serviço de um programa localizado noutro computador numa rede. A RPC ajuda na interoperabilidade, uma vez que um programa que utiliza RPC não necessita de compreender os protocolos de rede que suportam a comunicação. Na RPC, o programa que pede é o cliente e o programa que fornece o serviço é o servidor.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que tirasse partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Como poderia um intruso explorar a vulnerabilidade?**
Nos servidores que executam o serviço de servidor DNS em todas as versões do servidor suportadas pelo Windows, um intruso poderia tentar explorar a vulnerabilidade enviando um pacote RPC especialmente concebido para o efeito a um sistema afectado. A vulnerabilidade poderia permitir que um intruso executasse código no contexto de segurança do serviço de servidor DNS que, por predefinição, é executado como SISTEMA Local.

**Quais os sistemas mais susceptíveis a esta vulnerabilidade?**
Os servidores DNS, os controladores de domínio e as várias versões do Small Business Server estão mais susceptíveis. Estes sistemas podem estar mais susceptíveis se estiverem instalados em redes inseguras nas quais seja permitido tráfego de gestão de PRC não solicitado. Contudo, os procedimentos recomendados em relação à utilização de firewalls desaconselham vivamente esta situação.

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Sim. Um intruso pode tentar explorar esta vulnerabilidade através da Internet. Os procedimentos recomendados em relação à utilização de firewalls e as predefinições padrão de uma firewall podem ajudar a proteger os sistemas contra ataques provenientes da Internet.

**O que faz a actualização?**
A actualização elimina a vulnerabilidade, alterando a forma como o RPC valida o comprimento de uma mensagem, antes de passar a mensagem para a memória intermédia atribuída.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Sim. Esta vulnerabilidade foi divulgada publicamente. Foi-lhe atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2007-1748](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1748).

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido relatórios de que esta vulnerabilidade estava a ser explorada?**
Sim. Quando o boletim de segurança foi publicado, a Microsoft já tinha recebido informações de que esta vulnerabilidade estava a ser explorada.

**Esta actualização remove ou anula qualquer das medidas de atenuação indicadas no Aviso de Segurança da Microsoft (935964)?**
Não. Esta actualização de segurança não remove nem anula qualquer das medidas de atenuação recomendadas no [Aviso de Segurança Microsoft (935964) "](http://technet.microsoft.com/security/advisory/935964)Vulnerabilidade no RPC no servidor DNS do Windows poderia permitir Execução Remota de Código". Se alguma das medidas de atenuação tiver sido implementada de acordo com as recomendações do Aviso, os utilizadores podem removê-la manualmente depois de terem instalado a actualização de segurança com sucesso.

**A aplicação desta actualização de segurança ajuda a proteger os clientes contra o código que foi divulgado publicamente e que tenta explorar esta vulnerabilidade?**
Sim. Esta actualização de segurança corrige a vulnerabilidade actualmente explorada. À vulnerabilidade que foi corrigida foi atribuído o número de Vulnerabilidade e Exposição Comum [CVE-2007-1748](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1748).

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica do software afectado, clique na ligação adequada:

#### Windows 2000 (todas as versões)

**Pré-requisitos**
Para o Windows 2000, esta actualização de segurança requer o Service Pack 4 (SP4). Para o Small Business Server 2000, esta actualização de segurança requer o Small Business Server 2000 Service Pack 1a (SP1a) ou o Small Business Server 2000 executado no Windows 2000 Server Service Pack 4 (SP4). Esta actualização de segurança também requer que o sistema seja um servidor DNS ou que utilize a funcionalidade de servidor DNS.

O software listado foi testado de forma a determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://support.microsoft.com/lifecycle/).

Para mais informações sobre como obter o Service Pack mais recente, consulte o [Artigo 260910 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/260910/pt).

**Inclusão em Service Packs Futuros**
Não existem mais service packs planeados para este sistema operativo. A actualização para esta questão poderá ser incluída num conjunto de actualizações futuro.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841/pt). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684/pt).

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos do Windows 2000 Service Pack 4:

**Windows2000-kb935966-x86-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB935966.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows 2000 Service Pack 4:

**Windows2000-kb935966-x86-enu /norestart**

Para mais informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

Esta actualização requer um reinício.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB935966$\\Spuninst.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows 2000 Service Pack 4 e Small Business Server 2000:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | Pasta |
|------------------|---------------|-------------|-------|---------|-------|
| dns.exe          | 5.0.2195.7135 | 13-Abr-2007 | 15:18 | 327,952 | .     |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a pergunta frequente, “Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?” na secção de Perguntas mais frequentes relativas a esta actualização de segurança, publicada neste boletim.

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB935966\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 935966 aos ficheiros de origem de instalação do Windows.

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**
Esta actualização de segurança requer o Windows Server 2003 Service Pack 1, Windows Server 2003 Service Pack 2, Windows Server 2003 para sistemas baseados em Itanium, Windows Server 2003 com SP1 para sistemas baseados em Itanium, Windows Server 2003 com SP2 para sistemas baseados em Itanium, Windows Server 2003 x64 Edition ou Windows Server 2003 x64 Edition Service Pack 2. Esta actualização de segurança também requer que o sistema seja um servidor DNS ou que utilize a funcionalidade de servidor DNS.

**Inclusão em Service Packs Futuros**
A actualização para esta questão será incluída num service pack ou num conjunto de actualizações futuros.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros no mesmo comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta muitos dos parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841/pt). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de Implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb935966-x86-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB935966.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb935966-x86-enu /norestart**

Para obter informações sobre como implementar esta actualização de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

Esta actualização de segurança não suporta HotPatching. Para obter mais informações sobre HotPatching, consulte o [Artigo 897341 da Base de Dados de Conhecimento da Microsoft.](http://support.microsoft.com/kb/897341)

**Nota** Nem todas as actualizações de segurança suportam HotPatching e algumas que o suportam poderão obrigar ao reinício do servidor depois da instalação da actualização de segurança. O HotPatching só é suportado se os ficheiros que serão substituídos pela actualização de segurança forem do tipo General Distribution Release (GDR). O HotPatching não é suportado se tiver instalado um hotfix anteriormente para actualizar um dos ficheiros incluídos na actualização de segurança. Para mais informações sobre este comportamento, consulte o [Artigo 897341 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/897341) e o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft.](http://support.microsoft.com/kb/824994/pt)

**Informações de Remoção**

Para remover esta actualização, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB935966$\\Spuninst.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Datacenter Edition; Windows Server 2003, Enterprise Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Small Business Server 2003 com SP1; Windows Server 2003 R2, Web Edition; Windows Server 2003 R2, Standard Edition; Windows Server 2003 R2, Datacenter Edition; Windows Server 2003 R2, Enterprise Edition; Windows Small Business Server 2003 R2; Windows Server 2003, Web Edition com SP2; Windows Server 2003, Standard Edition com SP2; Windows Server 2003, Enterprise Edition com SP2; Windows Server 2003, Datacenter Edition com SP2; Windows Server 2003 R2, Web Edition com SP2; Windows Server 2003 R2, Standard Edition com SP2; Windows Server 2003 R2, Datacenter Edition com SP2; Windows Server 2003 R2, Enterprise Edition com SP2 e Windows Small Business Server 2003 R2 com SP2:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | Pasta  |
|------------------|---------------|-------------|-------|---------|--------|
| dns.exe          | 5.2.3790.2915 | 12-Abr-2007 | 12:57 | 442,880 | SP1GDR |
| dns.exe          | 5.2.3790.2915 | 12-Abr-2007 | 12:56 | 443,392 | SP1QFE |
| w03a2409.dll     | 5.2.3790.2925 | 26-Abr-2007 | 10:54 | 27,648  | SP1QFE |
| dns.exe          | 5.2.3790.4059 | 12-Abr-2007 | 13:40 | 443,392 | SP2GDR |
| dns.exe          | 5.2.3790.4059 | 12-Abr-2007 | 13:27 | 443,392 | SP2QFE |
| w03a2409.dll     | 5.2.3790.4069 | 26-Abr-2007 | 18:02 | 453,632 | SP2QFE |

Windows Server 2003, Enterprise Edition para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP2 para sistemas baseados em Itanium e Windows Server 2003, Datacenter Edition com SP2 para sistemas baseados em Itanium:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho   | CPU   | Pasta       |
|------------------|---------------|-------------|-------|-----------|-------|-------------|
| dns.exe          | 5.2.3790.2915 | 27-Abr-2007 | 13:13 | 1,122,816 | IA-64 | SP1GDR      |
| wdns.exe         | 5.2.3790.2915 | 27-Abr-2007 | 13:13 | 442,880   | X86   | SP1GDR\\wow |
| dns.exe          | 5.2.3790.2915 | 27-Abr-2007 | 13:13 | 1,124,864 | IA-64 | SP1QFE      |
| w03a2409.dll     | 5.2.3790.2925 | 27-Abr-2007 | 13:13 | 26,624    | IA-64 | SP1QFE      |
| wdns.exe         | 5.2.3790.2915 | 27-Abr-2007 | 13:13 | 443,392   | X86   | SP1QFE\\wow |
| ww03a2409.dll    | 5.2.3790.2925 | 27-Abr-2007 | 13:13 | 27,648    | X86   | SP1QFE\\wow |
| dns.exe          | 5.2.3790.4059 | 27-Abr-2007 | 13:17 | 1,124,864 | IA-64 | SP2GDR      |
| dns.exe          | 5.2.3790.4059 | 27-Abr-2007 | 13:12 | 1,125,376 | IA-64 | SP2QFE      |
| w03a2409.dll     | 5.2.3790.4069 | 27-Abr-2007 | 13:12 | 452,608   | IA-64 | SP2QFE      |
| ww03a2409.dll    | 5.2.3790.4069 | 27-Abr-2007 | 13:12 | 453,632   | X86   | SP2QFE\\wow |

Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; Windows Server 2003, Datacenter x64 Edition; Windows Server 2003 R2, Standard x64 Edition; Windows Server 2003 R2, Enterprise x64 Edition; Windows Server 2003 R2, Datacenter x64 Edition; Windows Server 2003 com SP2, Standard x64 Edition; Windows Server 2003 com SP2, Enterprise x64 Edition; Windows Server 2003 com SP2, Datacenter x64 Edition; Windows Server 2003 R2, Standard x64 Edition com SP2; Windows Server 2003 R2, Enterprise x64 Edition com SP2 e Windows Server 2003 R2, Datacenter x64 Edition com SP2:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | CPU | Pasta       |
|------------------|---------------|-------------|-------|---------|-----|-------------|
| dns.exe          | 5.2.3790.2915 | 27-Abr-2007 | 13:11 | 758,272 | x64 | SP1GDR      |
| wdns.exe         | 5.2.3790.2915 | 27-Abr-2007 | 13:11 | 442,880 | X86 | SP1GDR\\wow |
| dns.exe          | 5.2.3790.2915 | 27-Abr-2007 | 13:12 | 760,832 | x64 | SP1QFE      |
| w03a2409.dll     | 5.2.3790.2925 | 27-Abr-2007 | 13:12 | 28,160  | x64 | SP1QFE      |
| wdns.exe         | 5.2.3790.2915 | 27-Abr-2007 | 13:12 | 443,392 | X86 | SP1QFE\\wow |
| ww03a2409.dll    | 5.2.3790.2925 | 27-Abr-2007 | 13:12 | 27,648  | X86 | SP1QFE\\wow |
| dns.exe          | 5.2.3790.4069 | 27-Abr-2007 | 13:16 | 759,808 | x64 | SP2GDR      |
| dns.exe          | 5.2.3790.4069 | 27-Abr-2007 | 13:11 | 760,832 | x64 | SP2QFE      |
| w03a2409.dll     | 5.2.3790.4069 | 27-Abr-2007 | 13:11 | 454,144 | x64 | SP2QFE      |
| ww03a2409.dll    | 5.2.3790.4069 | 27-Abr-2007 | 13:11 | 453,632 | X86 | SP2QFE\\wow |

**Notas** Quando instala estas actualizações de segurança, o programa de instalação verifica se um ou mais ficheiros que estão a ser actualizados no seu sistema foram alvo de uma actualização anterior através de um hotfix da Microsoft.

Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994/pt).

Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994/pt).

Para mais informações sobre o programa de instalação Update.exe, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684/pt).

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). Consulte a pergunta frequente, “Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?” na secção de Perguntas mais frequentes relativas a esta actualização de segurança, publicada neste boletim.

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, clique com o botão direito do rato no nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Propriedades**.
        **Nota** Dependendo da versão do sistema operativo, ou dos programas instalados, alguns dos ficheiros incluídos na tabela de informações de ficheiro poderão não estar instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança, bastando para tal rever as seguintes chaves do registo.

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Enterprise Edition para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados em Itanium; Windows Server 2003 R2, Web Edition; Windows Server 2003 R2, Standard Edition; Windows Server 2003 R2, Datacenter Edition; Windows Server 2003 R2, Enterprise Edition e Windows Small Business Server 2003 R2:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB935966\\Filelist

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Small Business Server 2003 com SP1; Windows Server 2003, Enterprise Edition para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados em Itanium; Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; Windows Server 2003, Datacenter x64 Edition; Windows Server 2003, Web Edition com SP2; Windows Server 2003, Standard Edition com SP2; Windows Server 2003, Enterprise Edition com SP2; Windows Server 2003, Datacenter Edition com SP2 e Windows Small Business Server 2003 R2 com SP2:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP3\\KB935966\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 935966 aos ficheiros de origem de instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Mark Hofman, da [SANS ISC Handlers](http://isc.sans.org/), por trabalhar connosco na Vulnerabilidade na Gestão de RPC no DNS – (CVE-2007-1748).
-   Bill O'Malley, com o [Departamento de Segurança Informática da Universidade Carnegie Mellon](http://www.cmu.edu/iso/), por trabalhar connosco na Vulnerabilidade na Gestão de RPC no DNS – (CVE-2007-1748).

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outras questões de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Centro de Gestão de Actualizações TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166/pt).
-   [Office Update](http://office.microsoft.com/pt-pt/downloads/default.aspx)

**Software Update Services:**

Utilizando os Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

Em resposta aos comentários enviados pelos clientes e para dar mais tempo aos clientes para procederem à migração do Software Update Services (SUS) 1.0, a Microsoft anunciou o alargamento da data limite de suporte até terça-feira, 10 de Julho de 2007. O Windows Server Update Services, (WSUS), o sucessor do SUS, suporta actualizações para um conjunto mais amplo de produtos Microsoft e fornece funcionalidades robustas de gestão e criação de relatórios. Os clientes podem transferir o WSUS a partir do [Windows Server Update Services (WSUS)](http://www.microsoft.com/windowsserversystem/updateservices/default.mspx).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://www.microsoft.com/portugal/smserver/default.mspx).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scan Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (8 de Maio de 2007): Boletim publicado.
-   V1.1 (31 de Maio de 2007): Boletim revisto. Informações de ficheiros actualizada para o Windows Server 2003. Foi adicionada clarificação adicional no boletim sobre configurações do servidor que possam requerer a instalação da funcionalidade DNS como um pré-requisito para a instalação da actualização de segurança.
-   V1.2 (6 de Junho de 2007): Boletim revisto. Remoção da informação “Service Pack 1” em todas as ocorrências de “Windows Server 2003 x64 Edition Service Pack 1” no boletim.

*Built at 2014-04-18T01:50:00Z-07:00*
