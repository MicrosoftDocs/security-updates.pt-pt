---
TOCTitle: 'MS06-035'
Title: 'Microsoft Security Bulletin MS06-035 - Crítica'
ms:assetid: 'ms06-035'
ms:contentKeyID: 61234111
ms:mtpsurl: 'https://technet.microsoft.com/pt-PT/library/ms06-035(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS06-035 - Crítica
==============================================

Vulnerabilidade no Serviço de Servidor poderia permitir a Execução Remota de Código (917159)
--------------------------------------------------------------------------------------------

Data de publicação: 11 de julho de 2006 | Updated: 12 de julho de 2006

**actualizada:** 1.1

#### Resumo

**Quem deve ler este documento:** Clientes que utilizam o Microsoft Windows

**Impacto da Vulnerabilidade:** Execução Remota de Código

**Classificação de Gravidade Máxima:** Crítica

**Recomendação:** Os clientes deverão aplicar de imediato a actualização

**Substituição de Actualizações de Segurança:** Este boletim substitui uma actualização de segurança anterior. Consulte a secção de Perguntas mais frequentes deste boletim para obter a lista completa.

**Avisos:** Nenhuma

**Localizações de Transferência de Actualizações de Segurança e Software Testado:**

**Software Afectado:**

-   Microsoft Windows 2000 Service Pack 4 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=b207020d-90f7-4c41-8304-06af0ded6467)
-   Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=2592a44c-82fb-4ccd-82a6-fcac7ca33172)
-   Microsoft Windows XP Professional x64 Edition — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=b0f67167-7ede-4355-af6f-50c6615f6bbd)
-   Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1 — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=48f03ad7-38f9-48f4-bbfc-14c52e9c942a)
-   Microsoft Windows Server 2003 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com SP1 para sistemas baseados em Itanium — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=41a4a07f-bea3-48d6-b8d2-d7a5600d7179)
-   Microsoft Windows Server 2003 x64 Edition — [Transferir a actualização](http://www.microsoft.com/downloads/details.aspx?familyid=dfbf3fa6-9e11-48b4-894d-5436693d17f7)

**Software Não Afectado:**

-   Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE) e Microsoft Windows Millennium Edition (Me)

O software referido nesta lista foi testado para determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

**Nota** As actualizações de segurança para o Microsoft Windows Server 2003, Windows Server 2003 Service Pack 1 e Windows Server 2003 x64 Edition também se aplicam ao Windows Server 2003 R2.

### Informações Gerais

Resumo Executivo
----------------

<span></span>
**Resumo Executivo:**

Esta actualização resolve várias vulnerabilidades recentemente descobertas e comunicadas de forma privada. Cada vulnerabilidade está documentada neste boletim na respectiva secção "Detalhes sobre a Vulnerabilidade".

A Microsoft recomenda que os clientes apliquem de imediato a actualização.

**Classificações da Gravidade e Identificadores da Vulnerabilidade:**

| Identificadores da Vulnerabilidade                                                                                                             | Impacto da Vulnerabilidade | Windows 2000 | Windows XP Service Pack 1 | Windows XP Service Pack 2 | Windows Server 2003 | Windows Server 2003 Service Pack 1 |
|------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|--------------|---------------------------|---------------------------|---------------------|------------------------------------|
| Vulnerabilidade de Sobrecarga de Heap na Mailslot - [CVE-2006-1314](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-1314)           | Execução Remota de Código  | Crítica      | Crítica                   | Crítica                   | Crítica             | Crítica                            |
| Vulnerabilidade de Divulgação de Informações através de SMB - [CVE-2006-1315](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-1315) | Divulgação de Informações  | Baixa        | Baixa                     | Baixa                     | Baixa               | Baixa                              |
| **Gravidade Agregada de Todas as Vulnerabilidades**                                                                                            | ** **                      | **Crítica**  | **Crítica**               | **Crítica**               | **Crítica**         | **Crítica**                        |

Esta [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas que são afectados pela vulnerabilidade, nos respectivos padrões típicos de implementação e no efeito que a exploração da vulnerabilidade teria sobre os mesmos.

**Nota** As actualizações de segurança para o Microsoft Windows Server 2003, Windows Server 2003 Service Pack 1 e Windows Server 2003 x64 Edition também se aplicam ao Windows Server 2003 R2.

**Nota** As classificações de gravidade para versões de sistema operativo não x86 estão mapeadas para as versões do sistema operativo x86 da seguinte forma:

-   A classificação de gravidade para o Microsoft Windows XP Professional x64 Edition é a mesma que para o Windows Server 2003 Service Pack 1.
-   A classificação de gravidade para o Microsoft Windows Server 2003 para Sistemas baseados em Itanium é a mesma que para o Windows Server 2003.
-   A classificação de gravidade para o Microsoft Windows Server 2003 com SP1 para Sistemas baseados em Itanium é a mesma que para o Windows Server 2003 Service Pack 1.
-   A classificação de gravidade para o Microsoft Windows Server 2003 x64 Edition é a mesma que para o Windows Server 2003 Service Pack 1.

Perguntas mais frequentes relativas a esta actualização de segurança
--------------------------------------------------------------------

<span></span>
**Por que razão esta actualização resolve diversas vulnerabilidades de segurança comunicadas?**
Esta actualização contém suporte para diversas vulnerabilidades, porque as modificações necessárias para resolver estas questões estão incluídas nos ficheiros relacionados. Assim, em vez de instalarem diversas actualizações quase iguais, os clientes podem instalar apenas esta actualização.

**Que actualizações são substituídas por esta edição?**
Esta actualização de segurança substitui uma anterior. O ID do boletim de segurança e os sistemas operativos afectados encontram-se listados na seguinte tabela.

| Identificação do Boletim | Windows NT 4.0  | Windows 2000    | Windows XP  | Windows Server 2003 |
|--------------------------|-----------------|-----------------|-------------|---------------------|
| **MS05-027**             | Não Substituído | Não Substituído | Substituído | Substituído         |

**O suporte alargado a actualizações de segurança para o Microsoft Windows NT Workstation 4.0 Service Pack 6a e Windows 2000 Service Pack 2 terminou a 30 de Junho de 2004. O suporte alargado a actualizações de segurança para o Microsoft Windows NT Server 4.0 Service Pack 6a terminou a 31 de Dezembro de 2004. O suporte alargado a actualizações de segurança para o Microsoft Windows 2000 Service Pack 3 terminou a 30 de Junho de 2005. Ainda utilizo um destes sistemas operativos - o que devo fazer?**

O Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a e Windows 2000 Service Pack 2 e Windows 2000 Service Pack 3 chegaram ao fim dos respectivos ciclos de vida. Os utilizadores que tenham estas versões do sistema operativo deviam considerar a migração para versões suportadas como uma prioridade, de modo a poderem proteger os seus sistemas contra a potencial exposição a vulnerabilidades. Para mais informações sobre o Ciclo de Vida dos Produtos Windows, visite o [Web site do Ciclo de Vida do Suporte da Microsoft](http://go.microsoft.com/fwlink/?linkid=21742). Para mais informações sobre o período de suporte alargado a actualizações de segurança para estas versões do sistema operativo, visite o [Web site de Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que necessitem de suporte personalizado para estes produtos devem contactar o seu representante de equipa de contas da Microsoft, o seu Gestor Técnico de Contas ou o parceiro ou representante Microsoft adequado para mais informações sobre opções de suporte personalizado. Os clientes que não disponham de um Contrato Alliance, Premier ou Autorizado podem contactar a subsidiária local da Microsoft. Para obter informações de contacto, visite o [Web site Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), seleccione o país e, em seguida, clique em **Go** para ver uma lista de números de telefone. Quando telefonar, peça para falar com o Gestor de Vendas de Suporte Premier local. Para mais informações, consulte as [Perguntas mais frequentes de Suporte Sobre o Ciclo de Vida de Produto, relativas aos Sistemas Operativos Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Posso utilizar o Microsoft Baseline Security Analyzer (MBSA) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do MBSA para esta actualização de segurança.

| Software                                                                                                                                             | MBSA 1.2.1 | MBSA 2.0 |
|------------------------------------------------------------------------------------------------------------------------------------------------------|------------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                | Sim        | Sim      |
| Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2                                                                            | Sim        | Sim      |
| Microsoft Windows XP Professional x64 Edition                                                                                                        | Não        | Sim      |
| Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1                                                                         | Sim        | Sim      |
| Microsoft Windows Server 2003 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com Service Pack 1 para sistemas baseados em Itanium | Não        | Sim      |
| Família do Microsoft Windows Server 2003 x64                                                                                                         | Não        | Sim      |

Para mais informações sobre o MBSA, visite o [Web site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).
Para mais informações sobre software que o Microsoft Update e o MBSA 2.0 não detectam actualmente, consulte o [artigo 895660 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/895660)

**Posso utilizar o Systems Management Server (SMS) para determinar se esta actualização é necessária?**
A tabela seguinte fornece o resumo de detecções do SMS para esta actualização de segurança.

| Software                                                                                                                                             | SMS 2.0 | SMS 2003 |
|------------------------------------------------------------------------------------------------------------------------------------------------------|---------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                | Sim     | Sim      |
| Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2                                                                            | Sim     | Sim      |
| Microsoft Windows XP Professional x64 Edition                                                                                                        | Não     | Sim      |
| Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1                                                                         | Sim     | Sim      |
| Microsoft Windows Server 2003 para sistemas baseados em Itanium e Microsoft Windows Server 2003 com Service Pack 1 para sistemas baseados em Itanium | Não     | Sim      |
| Família do Microsoft Windows Server 2003 x64                                                                                                         | Não     | Sim      |

O SMS utiliza o MBSA para fins de detecção. Por conseguinte, o SMS tem as mesmas limitações listadas anteriormente neste boletim relacionadas com software que o MBSA não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool, pode ser usado pelo SMS para detectar actualizações de segurança. O SMS SUIT utiliza o motor MBSA 1.2.1 para detecção. Para mais informações sobre a ferramenta Security Update Inventory Tool, consulte o seguinte [Web site da Microsoft](http://support.microsoft.com/kb/894154/). Para mais informações sobre as limitações da ferramenta Security Update Inventory Tool, consulte o [artigo 306460 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Microsoft Office Inventory Tool para detectar actualizações necessárias para aplicações do Microsoft Office.

Para o SMS 2003, a ferramenta SMS 2003 Inventory Tool para actualizações de software Microsoft pode ser usada pelo SMS para detectar actualizações de segurança que foram oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt) e que são suportadas pelos [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obter mais informações sobre a ferramenta SMS 2003 Inventory Tool for Microsoft Updates, visite o seguinte [Web site da Microsoft](http://go.microsoft.com/fwlink/?linkid=50757). O SMS 2003 também pode utilizar a ferramenta Microsoft Office Inventory Tool para detectar as actualizações necessárias para aplicações do Microsoft Office.

Para mais informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Detalhes Sobre a Vulnerabilidade
--------------------------------

<span></span>
#### Vulnerabilidade de Sobrecarga de Heap na Mailslot - CVE-2006-1314:

Existe uma vulnerabilidade de execução remota de código no controlador do Servidor que poderia permitir que um intruso que explorasse esta vulnerabilidade com sucesso obtivesse controlo total sobre o sistema afectado.

#### Factores atenuantes para a Vulnerabilidade de Sobrecarga de Heap na Mailslot - CVE-2006-1314:

-   Os procedimentos recomendados de firewall e as configurações de firewall padrão predefinidas podem ajudar a proteger as redes de ataques provenientes do exterior do perímetro da empresa. É recomendado que os sistemas ligados à Internet tenham um número mínimo de portas exposto.
-   O Microsoft Windows XP Service Pack 2 e o Microsoft Windows Server 2003 Service Pack 1 não têm serviços de listening em Mailslots nas configurações predefinidas.
-   Tentativas de explorar esta vulnerabilidade iriam muito provavelmente resultar numa condição de Negação de Serviço causada por um reinício inesperado do sistema afectado, em vez de execução remota de código.

#### Soluções alternativas para a Vulnerabilidade de Sobrecarga de Heap na Mailslot - CVE-2006-1314:

A Microsoft testou as seguintes soluções alternativas. Embora estas soluções alternativas não corrijam a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

-   **Bloqueie a porta TCP 445 na firewall:**

    Esta porta é usada para iniciar uma ligação com o componente afectado. O bloqueio da porta TCP 445 na firewall ajudará a impedir que os sistemas protegidos por essa firewall sejam atacados por tentativas de explorar esta vulnerabilidade. Recomendamos que bloqueie todas as comunicações de entrada não solicitadas a partir da Internet, para ajudar a impedir ataques que possam utilizar outras portas. Para mais informações sobre as portas, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=21312).

-   **Para ajudar a proteger contra tentativas baseadas em rede de explorar essa vulnerabilidade, utilize uma firewall pessoal, tal como a** [**Firewall de Ligação à Internet**](http://go.microsoft.com/fwlink/?linkid=33335)**, incluída no Windows XP e no Windows Server 2003.**

    Por predefinição, a Firewall de Ligação à Internet no Windows XP e no Windows Server 2003 ajuda a proteger a sua ligação à Internet, bloqueando a recepção de tráfego não solicitado. Recomendamos que bloqueie todas as comunicações de entrada não solicitadas da Internet. No Windows XP Service Pack 2, esta funcionalidade chama-se Firewall do Windows.

    Para activar a funcionalidade Firewall de Ligação à Internet utilizando o Assistente de Configuração de Rede, siga estes passos:

    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**.
    2.  Na vista por categoria predefinida, clique em **Ligações de Rede e de Internet** e, em seguida, clique em **Configurar ou alterar rede de pequeno escritório ou doméstica**. A funcionalidade Firewall de Ligação à Internet é activada quando selecciona uma configuração no Assistente de Configuração de Rede que indique que o sistema está ligado directamente à Internet.

    Para configurar a Firewall de Ligação à Internet manualmente para uma ligação, siga estes passos:

    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**.
    2.  Na vista por categoria predefinida, clique em **Ligações de Rede e de Internet** e, em seguida, clique em **Ligações de Rede**.
    3.  Clique com o botão direito do rato na ligação na qual pretende activar a Firewall de Ligação à Internet e, em seguida, clique em **Propriedades**.
    4.  Clique no separador **Avançadas**.
    5.  Clique para seleccionar a caixa de verificação **Proteger o meu computador e a rede limitando ou impedindo o acesso a este computador a partir da Internet** e, em seguida, clique em **OK**.

    **Nota** Se pretender activar a utilização de determinados programas e serviços para que comuniquem através da firewall, clique em **Definições** no separador **Avançadas** e, em seguida, seleccione os programas, protocolos e serviços necessários.

-   **Para ajudar a proteger o seu sistema contra tentativas de exploração dessa vulnerabilidade com base na rede, active a filtragem avançada TCP/IP em sistemas que suportem essa funcionalidade.**

    É possível activar a filtragem TCP/IP avançada para bloquear todo o tráfego de entrada não solicitado. Para obter informações adicionais sobre como configurar a filtragem TCP/IP, consulte o [artigo 309798 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/309798).

-   **Para ajudar a proteger contra tentativas de exploração dessa vulnerabilidade com base na rede, bloqueie as portas respectivas utilizando a funcionalidade IPSec nos sistemas afectados.**

    Utilize a funcionalidade de segurança de Protocolo Internet (IPSec) para ajudar a proteger as comunicações de rede. Estão disponíveis informações detalhadas sobre o protocolo IPSec e o modo de aplicação de filtros nos artigos [313190](http://support.microsoft.com/kb/313190) e [813878](http://support.microsoft.com/kb/813878) da Base de Dados de Conhecimento da Microsoft.

#### Perguntas mais frequentes sobre a Vulnerabilidade de Sobrecarga de Heap na Mailslot - CVE-2006-1314:

**Qual é a abrangência desta vulnerabilidade?**
Esta é uma vulnerabilidade de execução remota de código. Um intruso que conseguisse tirar partido desta vulnerabilidade poderia obter remotamente o controlo total sobre um sistema afectado. Um intruso poderia então instalar programas; ver, alterar ou eliminar dados; ou ainda criar novas contas com todos os privilégios.

**O que provoca a vulnerabilidade?**
Uma memória intermédia não verificada no serviço de Servidor.

**O que é uma Mailslot?**
Uma Mailslot é um mecanismo temporário utilizado por aplicações e processos para facilitar a transferência unidireccional de dados. Para mais informações sobre Mailslots, visite o seguinte [Web site](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/ipc/base/writing_to_a_mailslot.asp).

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que conseguisse tirar partido desta vulnerabilidade com êxito poderia controlar totalmente o sistema afectado.

**Quem poderia explorar a vulnerabilidade?**
Qualquer utilizador anónimo que pudesse entregar um pacote de rede especialmente concebido para o efeito ao sistema afectado poderia tentar explorar esta vulnerabilidade.

**Como poderia um intruso explorar a vulnerabilidade?**
Um intruso poderia tentar explorar a vulnerabilidade criando e enviando um pacote de rede especialmente concebido para o efeito para o sistema afectado. O pacote de rede poderia, então, fazer com que o sistema afectado executasse código.

**Quais os sistemas mais susceptíveis a esta vulnerabilidade?**
Tanto as estações de trabalho como os servidores estão susceptíveis a esta vulnerabilidade. As Mailslots pode ser utilizadas por diversas aplicações e programas de terceiros. Os serviços Messenger e Alerter utilizam a funcionalidade Mailslot. Qualquer sistema que utiliza estes serviços num estado activo está vulnerável. Estes serviços não estão configurados para iniciar automaticamente por predefinição no Windows XP Service Pack 2 e Windows Server 2003 Service Pack 2

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Sim. Um intruso pode tentar explorar esta vulnerabilidade através da Internet. Os procedimentos recomendados em relação à utilização de firewalls e as predefinições padrão de uma firewall podem ajudar a proteger os sistemas contra ataques provenientes da Internet. A Microsoft disponibilizou informações sobre como pode ajudar a proteger o seu computador. Os utilizadores finais podem visitar o [Web site Proteja o Seu PC](http://go.microsoft.com/fwlink/?linkid=21169). Os profissionais de informática podem visitar o [Web site do Security Guidance Center](http://go.microsoft.com/fwlink/?linkid=21171).

**O que faz a actualização?**
A actualização elimina a vulnerabilidade, alterando a forma como o controlador de Servidor valida o comprimento de uma mensagem antes de a transmitir para a memória intermédia atribuída.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido informações sobre a exploração desta vulnerabilidade?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

#### Vulnerabilidade de Divulgação de Informações através de SMB - CVE-2006-1315:

Existe uma vulnerabilidade de divulgação no serviço de Servidor que poderia permitir que um intruso visualizasse fragmentos da memória usada para armazenar tráfego SMB durante o transporte.

#### Factores atenuantes para a Vulnerabilidade de Divulgação de Informações através de SMB - CVE-2006-1315:

-   Os procedimentos recomendados de firewall e as configurações de firewall padrão predefinidas podem ajudar a proteger as redes de ataques provenientes do exterior do perímetro da empresa. É recomendado que os sistemas ligados à Internet tenham um número mínimo de portas exposto.
-   Para os clientes que necessitam do componente afectado, os procedimentos recomendados e as predefinições padrão para firewalls podem ajudar a proteger as redes contra ataques que têm origem fora do perímetro da empresa. É recomendado que os sistemas ligados à Internet tenham um número mínimo de portas exposto.
-   No Windows 2000, Windows XP e Windows Server 2003, um intruso teria de ter credenciais de início de sessão válidas para explorar esta vulnerabilidade. A vulnerabilidade não pode ser explorada por utilizadores anónimos. Contudo, o componente afectado está disponível remotamente para os utilizadores que têm contas de utilizador normais. Em determinadas configurações, utilizadores anónimos poderiam autenticar-se como uma conta de Convidado. Para obter mais informações, consulte o [Aviso de Segurança da Microsoft 906574](http://technet.microsoft.com/security/advisory/906574).
-   Os procedimentos recomendados de firewall e as configurações de firewall padrão predefinidas podem ajudar a proteger as redes de ataques provenientes do exterior do perímetro da empresa. É recomendado que os sistemas ligados à Internet tenham um número mínimo de portas exposto.

#### Soluções alternativas para a Vulnerabilidade de Divulgação de Informações através de SMB - CVE-2006-1315:

A Microsoft testou as seguintes soluções alternativas. Embora estas soluções alternativas não corrijam a vulnerabilidade subjacente, elas ajudam a bloquear vectores de ataque conhecidos. Na secção seguinte identificam-se os casos em que uma solução alternativa reduz a funcionalidade.

**Nota** Outros protocolos, como o Internetwork Packet Exchange (IPX) e o Sequenced Packet Exchange (SPX), poderiam estar vulneráveis a esta questão. Se os protocolos vulneráveis, como o IPX e o SPX, estiverem a ser usados, é importante bloquear as portas adequadas também para esse protocolos. Para mais informações sobre o IPX e o SPX, visite o seguinte [Web site da Microsoft](http://www.microsoft.com/resources/documentation/windows/xp/all/reskit/en-us/prch_cnn_goue.asp).

-   **Bloqueio das portas TCP 139 e 445 na firewall:**

    Estas portas são utilizadas para iniciar uma ligação com o protocolo afectado. O bloqueio destas portas na firewall, a nível de recepção e envio, ajuda a impedir que os sistemas protegidos por essa firewall sejam atacados por tentativas de explorar esta vulnerabilidade. Recomendamos que bloqueie todas as comunicações de entrada não solicitadas a partir da Internet, para ajudar a impedir ataques que possam utilizar outras portas. Para mais informações sobre as portas, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=21312).

-   **Para ajudar a proteger contra tentativas baseadas em rede de explorar essa vulnerabilidade, utilize uma firewall pessoal, tal como a** [**Firewall de Ligação à Internet**](http://go.microsoft.com/fwlink/?linkid=33335)**, incluída no Windows XP e no Windows Server 2003.**

    Por predefinição, a Firewall de Ligação à Internet no Windows XP e no Windows Server 2003 ajuda a proteger a sua ligação à Internet, bloqueando a recepção de tráfego não solicitado. Recomendamos que bloqueie todas as comunicações de entrada não solicitadas da Internet.

    Para activar a funcionalidade Firewall de Ligação à Internet utilizando o Assistente de Configuração de Rede, siga estes passos:

    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**.
    2.  Na vista por categoria predefinida, clique em **Ligações de Rede e de Internet** e, em seguida, clique em **Configurar ou alterar rede de pequeno escritório ou doméstica**. A funcionalidade Firewall de Ligação à Internet é activada quando selecciona uma configuração no Assistente de Configuração de Rede que indique que o sistema está ligado directamente à Internet.

    Para configurar a Firewall de Ligação à Internet manualmente para uma ligação, siga estes passos:

    1.  Clique em **Iniciar** e, em seguida, clique em **Painel de Controlo**.
    2.  Na vista por categoria predefinida, clique em **Ligações de Rede e de Internet** e, em seguida, clique em **Ligações de Rede**.
    3.  Clique com o botão direito do rato na ligação na qual pretende activar a Firewall de Ligação à Internet e, em seguida, clique em **Propriedades**.
    4.  Clique no separador **Avançadas**.
    5.  Clique para seleccionar a caixa de verificação **Proteger o meu computador e a rede limitando ou impedindo o acesso a este computador a partir da Internet** e, em seguida, clique em **OK**.

    **Nota** Se pretender activar a utilização de determinados programas e serviços para que comuniquem através da firewall, clique em **Definições** no separador **Avançadas** e, em seguida, seleccione os programas, protocolos e serviços necessários.

-   **Para ajudar a proteger o seu sistema contra tentativas de exploração dessa vulnerabilidade com base na rede, active a filtragem avançada TCP/IP em sistemas que suportem essa funcionalidade.**

    É possível activar a filtragem TCP/IP avançada para bloquear todo o tráfego de entrada não solicitado. Para obter informações adicionais sobre como configurar a filtragem TCP/IP, consulte o [artigo 309798 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/309798).

-   **Para ajudar a proteger contra tentativas de exploração dessa vulnerabilidade com base na rede, bloqueie as portas respectivas utilizando a funcionalidade IPSec nos sistemas afectados.**

    Utilize a funcionalidade de segurança de Protocolo Internet (IPSec) para ajudar a proteger as comunicações de rede. Estão disponíveis informações detalhadas sobre o protocolo IPSec e o modo de aplicação de filtros nos artigos [313190](http://support.microsoft.com/kb/313190) e [813878](http://support.microsoft.com/kb/813878) da Base de Dados de Conhecimento da Microsoft.

#### Perguntas mais frequentes sobre a Vulnerabilidade de Divulgação de Informações através de SMB - CVE-2006-1315:

**Qual é a abrangência desta vulnerabilidade?**
Trata-se de uma vulnerabilidade ao nível da divulgação de informações. Um intruso que explorasse esta vulnerabilidade com sucesso poderia ler remotamente informações armazenadas em memórias intermédias de tráfego de Bloco de Mensagens de Servidor. Tenha em atenção que esta vulnerabilidade não permitiria que um intruso executasse o código ou elevasse os seus direitos de utilizador directamente. Poderia ser usada para produzir informações úteis para tentar comprometer ainda mais o sistema afectado.

**O que provoca a vulnerabilidade?**
Uma memória intermédia não iniciada no controlo do protocolo de Servidor.

**O que é o SMB?**
O Bloco de Mensagens de Servidor (SMB - Server Message Block), e o respectivo sucessor, o [Sistema de Ficheiros Comuns da Internet](http://www.microsoft.com/mind/1196/cifs.asp) (CIFS - Common Internet File System), é o Protocolo Padrão da Internet que o Windows utiliza para partilhar ficheiros, impressoras, portas de série e igualmente para comunicação entre computadores. Para isto, o SMB utiliza encaminhamentos com nome (named pipes) e processadores de mensagens. Num ambiente de rede, os servidores disponibilizam sistemas de ficheiros e recursos aos clientes. Os clientes fazem pedidos SMB para recursos. Os servidores criam respostas SMB. Isto é descrito como um, protocolo de pedido-resposta numa relação cliente-servidor.

**Esta vulnerabilidade afecta igualmente o CIFS?**
O Sistema de Ficheiros Comuns da Internet (CIFS) é um Protocolo Padrão da Internet. A vulnerabilidade aqui descrita reside especificamente na implementação do protocolo por parte da Microsoft e não no próprio protocolo.

**Como poderia um intruso utilizar a vulnerabilidade?**
Um intruso que explorasse esta vulnerabilidade com sucesso poderia visualizar remotamente os conteúdos de memórias intermédias de SMB.

**Quem poderia explorar a vulnerabilidade?**
Qualquer utilizador anónimo que pudesse entregar uma mensagem especialmente concebida para o efeito ao sistema afectado poderia tentar explorar esta vulnerabilidade.

**Como poderia um intruso explorar a vulnerabilidade?**
Um intruso poderia tentar explorar a vulnerabilidade criando uma mensagem especialmente concebida para o efeito e enviando a mensagem ao sistema afectado. Então, o intruso poderia recuperar informações existente nas memórias intermédias de SMB.

**Quais os sistemas mais susceptíveis a esta vulnerabilidade?**
Tanto as estações de trabalho como os servidores estão susceptíveis. Os servidores poderiam estar mais susceptíveis, sobretudo se suportarem uma grande quantidade de tráfego SMB.

**A vulnerabilidade poderia ser explorada a partir da Internet?**
Sim. Um intruso pode tentar explorar esta vulnerabilidade através da Internet. Os procedimentos recomendados em relação à utilização de firewalls e as predefinições padrão de uma firewall podem ajudar a proteger os sistemas contra ataques provenientes da Internet. A Microsoft disponibilizou informações sobre como pode ajudar a proteger o seu computador. Os utilizadores finais podem visitar o [Web site Proteja o Seu PC](http://go.microsoft.com/fwlink/?linkid=21169). Os profissionais de informática podem visitar o [Web site do Security Guidance Center](http://go.microsoft.com/fwlink/?linkid=21171).

**O que faz a actualização?**
A actualização remove a vulnerabilidade iniciando a memória intermédia antes de responder a um pedido do cliente.

**Quando este boletim de segurança foi publicado, esta vulnerabilidade já tinha sido divulgada publicamente?**
Não. A Microsoft recebeu informações sobre esta vulnerabilidade através de divulgação responsável.

**Quando este boletim de segurança foi publicado, a Microsoft já tinha recebido informações sobre a exploração desta vulnerabilidade?**
Não. A Microsoft não tinha recebido quaisquer informações que indicassem que esta vulnerabilidade tivesse sido utilizada publicamente para atacar clientes e não tinha conhecimento de exemplos publicados de código para prova de conceito quando este boletim de segurança foi criado pela primeira vez.

Informações da Actualização de Segurança
----------------------------------------

<span></span>
**Software Afectado:**

Para obter mais informações sobre a actualização de segurança específica do software afectado, clique na ligação adequada:

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**
Esta actualização de segurança requer o Windows Server 2003 ou o Windows Server 2003 Service Pack 1.

**Nota** As actualizações de segurança para o Microsoft Windows Server 2003 e o Microsoft Windows Server 2003 Service Pack 1 também se aplicam ao Microsoft Windows Server 2003 R2.

**Inclusão em Service Packs Futuros:**
A actualização para esta questão será incluída num Service Pack ou num Conjunto de Actualizações futuros.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta muitos dos parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb917159-x86-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB917159.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows Server 2003:

**Windowsserver2003-kb917159-x86-enu /norestart**

Para obter informações sobre como implementar esta actualização de segurança com o Software Update Services, visite o [Web site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.
Esta actualização de segurança suporta HotPatching em sistemas que disponham de uma versão de ficheiro Srv.sys de 5.2.3790.2437. Se usar HotPatching, pode instalar actualizações de segurança em sistemas que estejam a executar o Microsoft Windows Server 2003 Service Pack 1 sem reiniciar os servidores. Para mais informações sobre HotPatching e sobre como implementar a actualização de segurança usando HotPatching, consulte o [Artigo 897341 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/897341).

A actualização de segurança que está disponível no Windows Update, Microsoft Update e Actualizações Automáticas fazem uso do HotPatching e não requer o reinício do seu servidor.

**Informações de Remoção**

Para remover esta actualização, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB917159$\\Spuninst.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Datacenter Edition; Windows Server 2003, Enterprise Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Server 2003 R2, Web Edition; Windows Server 2003 R2, Standard Edition; Windows Server 2003 R2, Datacenter Edition; Windows Server 2003 R2, Enterprise Edition; Windows Small Business Server 2003 R2:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | CPU | Pasta  |
|------------------|---------------|-------------|-------|---------|-----|--------|
| Srv.sys          | 5.2.3790.526  | 27-Abr-2006 | 00:49 | 340,992 | x86 | RTMGDR |
| Srv.sys          | 5.2.3790.526  | 27-Abr-2006 | 01:11 | 342,016 | x86 | RTMQFE |
| Srv.hp.sys       | 5.2.3790.2691 | 27-Abr-2006 | 21:17 | 22,528  | x86 | SP1GDR |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:17 | 392,192 | x86 | SP1GDR |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 02:41 | 360,448 | x86 | SP1QFE |

Windows Server, 2003 Enterprise Edition para Sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para Sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP1 para Sistemas baseados em Itanium e Windows Server 2003, Datacenter Edition com SP1 para Sistemas baseados em Itanium:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho   | CPU   | Pasta  |
|------------------|---------------|-------------|-------|-----------|-------|--------|
| Srv.sys          | 5.2.3790.526  | 27-Abr-2006 | 21:42 | 991,232   | IA-64 | RTMGDR |
| Srv.sys          | 5.2.3790.526  | 27-Abr-2006 | 21:44 | 994,816   | IA-64 | RTMQFE |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:45 | 1,105,408 | IA-64 | SP1GDR |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:43 | 1,108,992 | IA-64 | SP1QFE |

Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; e Windows Server 2003, Datacenter x64 Edition; Windows Server 2003 R2, Standard x64 Edition; Windows Server 2003 R2, Enterprise x64 Edition; e Windows Server 2003 R2, Datacenter x64 Edition:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | CPU | Pasta  |
|------------------|---------------|-------------|-------|---------|-----|--------|
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:42 | 671,232 | x64 | SP1GDR |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:39 | 672,768 | x64 | SP1QFE |

**Notas** Quando instala estas actualizações de segurança, o programa de instalação verifica se um ou mais dos ficheiros que estão a ser actualizados no sistema foi alvo de uma actualização anterior, através de um hotfix da Microsoft.
Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o seu sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre o programa de instalação Update.exe, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). A ferramenta MBSA permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
        **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança, bastando para tal rever as seguintes chaves do registo.

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Server 2003, Enterprise Edition para Sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition para Sistemas baseados em Itanium; Windows Server 2003, Enterprise Edition com SP1 para Sistemas baseados em Itanium; Windows Server 2003, Datacenter Edition com SP1 para Sistemas baseados em Itanium; Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition e Windows Server 2003, Datacenter x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP2\\KB917159\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 917159 aos ficheiros de origem de instalação do Windows.

#### Windows XP (todas as versões)

**Pré-requisitos**
Esta actualização de segurança requer o Microsoft Windows XP Service Pack 1 ou uma versão posterior. Para obter mais informações, consulte o [Artigo 322389 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/322389).

**Inclusão em Service Packs Futuros:**
A actualização para esta questão será incluída num Service Pack ou num Conjunto de Actualizações futuros.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos do Microsoft Windows XP:

**Windowsxp-kb917159-x86-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB917159.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows XP:

**Windowsxp-kb917159-x86-enu /norestart**

Para obter informações sobre como implementar esta actualização de segurança com o Software Update Services, visite o [Web site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB917159$\\Spuninst.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | CPU | Pasta  |
|------------------|---------------|-------------|-------|---------|-----|--------|
| Srv.sys          | 5.1.2600.1832 | 21-Abr-2006 | 05:24 | 321,536 | x86 | SP1QFE |
| Srv.sys          | 5.1.2600.2893 | 21-Abr-2006 | 06:12 | 332,800 | x86 | SP2GDR |
| Srv.sys          | 5.1.2600.2893 | 21-Abr-2006 | 06:46 | 332,800 | x86 | SP2QFE |

Windows XP Professional x64:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho | CPU | Pasta  |
|------------------|---------------|-------------|-------|---------|-----|--------|
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:42 | 671,232 | x64 | SP1GDR |
| Srv.sys          | 5.2.3790.2691 | 27-Abr-2006 | 21:39 | 672,768 | x64 | SP1QFE |

**Notas** Quando instala estas actualizações de segurança, o programa de instalação verifica se um ou mais dos ficheiros que estão a ser actualizados no sistema foi alvo de uma actualização anterior, através de um hotfix da Microsoft.
Caso tenha instalado anteriormente um hotfix para actualizar um destes ficheiros, o programa de instalação copia os ficheiros RTMQFE, SP1QFE ou SP2QFE para o seu sistema. Caso contrário, o programa de instalação copia os ficheiros RTMGDR, SP1GDR ou SP2GDR para o sistema. As actualizações de segurança podem não conter todas as variantes destes ficheiros. Para mais informações sobre este comportamento, consulte o [Artigo 824994 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824994).

Para mais informações sobre o programa de instalação Update.exe, visite o [Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

O Arpidfix.exe é utilizado pelo programa de instalação da actualização de segurança para resolver uma questão documentada no [Artigo 904630 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/904630). Este ficheiro não é instalado no sistema afectado.

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). A ferramenta MBSA permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
        **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança, bastando para tal rever as seguintes chaves do registo.

    Para o Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB917159\\Filelist

    Para Windows XP Professional x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP2\\KB917159\\Filelist

    **Nota** Estas chaves de registo poderão não conter uma lista completa dos ficheiros instalados. Além disso, estas chaves de registo poderão não ser criadas correctamente se um administrador ou um OEM integrar ou associar a actualização de segurança 917159 aos ficheiros de origem de instalação do Windows.

#### Windows 2000 (todas as versões)

**Pré-requisitos**
Para o Windows 2000, esta actualização de segurança requer o Service Pack 4 (SP4). Para o Small Business Server 2000, esta actualização de segurança requer o Small Business Server 2000 Service Pack 1a (SP1a) ou Small Business Server 2000 executado no Windows 2000 Server Service Pack 4 (SP4).

O software listado foi testado de forma a determinar se todas as suas versões são afectadas. As outras versões ou não são abrangidas pelo suporte de actualizações de segurança ou podem não ser afectadas. Para determinar o ciclo de vida do suporte do seu produto e versão visite o [Web site do Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

Para mais informações sobre como obter o Service Pack mais recente, consulte o [Artigo 260910 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/260910).

**Inclusão em Service Packs Futuros:**
A actualização para esta questão poderá ser incluída num Conjunto de Actualizações futuro.

**Informações de Instalação**

Esta actualização de segurança suporta os seguintes parâmetros de configuração.

<table class="dataTable">
<caption>
Parâmetros de Instalação de Actualizações de Segurança Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Substitui ficheiros OEM sem aviso.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz cópias de segurança dos ficheiros necessários para desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
Integra a actualização nos ficheiros de origem do Windows. Estes ficheiros estão localizados no caminho que é especificado no parâmetro.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
Extrai ficheiros sem iniciar o programa de Configuração.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Activa o fornecimento de informações sobre erros alargados.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Activa registo com informações detalhadas. Durante a instalação, cria %Windir%\\CabBuild.log. Este registo especifica os ficheiros que são copiados. Usar este parâmetro pode fazer com que a instalação decorra mais lentamente.
</td>
</tr>
</table>
 
**Nota** É possível combinar estes parâmetros num único comando. Para efeitos de retro-compatibilidade, a actualização de segurança também suporta os parâmetros de configuração que são utilizados pelas versões anteriores do Programa de Configuração. Para obter mais informações sobre os parâmetros de instalação suportados, consulte o [Artigo 262841 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o programa de instalação Update.exe, visite [o Web site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para mais informações sobre a terminologia que é usada neste boletim, tal como *hotfix*, consulte o [Artigo 824684 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/824684).

**Informações de implementação**

Para instalar a actualização de segurança sem qualquer intervenção por parte do utilizador, utilize o seguinte comando numa linha de comandos do Windows 2000 Service Pack 4:

**Windows2000-kb917159-x86-enu /quiet**

**Nota** A utilização do parâmetro **/quiet** irá suprimir todas as mensagens. Isto inclui a supressão de mensagens de falha. Quando utilizam o parâmetro **/quiet**, os administradores devem usar um dos métodos suportados para verificar se a instalação foi bem sucedida. Os administradores também devem consultar o ficheiro KB917159.log para verificar a existência de quaisquer mensagens de falha quando utilizam este parâmetro.

Para instalar a actualização de segurança sem obrigar o sistema a reiniciar, utilize o seguinte comando numa linha de comandos do Windows 2000 Service Pack 4:

**Windows2000-kb917159-x86-enu /norestart**

Para mais informações sobre como implementar esta actualização de segurança com o Software Update Services, visite o [Web site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para mais informações sobre como implementar esta actualização de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualização de segurança também estará disponível através do [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Requisito de Reinício**

É necessário reiniciar o sistema depois de aplicar esta actualização de segurança.

**Informações de Remoção**

Para remover esta actualização de segurança, utilize a ferramenta Adicionar ou Remover Programas no Painel de Controlo.

Os administradores de sistema podem também utilizar o utilitário Spuninst.exe para remover esta actualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB917159$\\Spuninst.

<table class="dataTable">
<caption>
Parâmetros Spuninst.exe Suportados
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parâmetro
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Apresenta as opções da linha de comandos.
</td>
</tr>
<tr>
<th colspan="2">
Modos de Configuração
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de Configuração Automático. Não é necessária qualquer intervenção por parte do utilizador, mas é apresentado o estado da instalação. Se for necessário um reinício no final da configuração, será mostrada ao utilizador uma caixa de diálogo com um temporizador, avisando que o computador irá reiniciar passados 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. É o mesmo que o modo automático, mas não são apresentadas mensagens de estado ou de erro.
</td>
</tr>
<tr>
<th colspan="2">
Opções de Reinício
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação estiver concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador depois da instalação e força as outras aplicações a fechar durante o processo de encerramento, sem antes gravar os ficheiros abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um temporizador avisando o utilizador de que o computador irá reiniciar dentro de *x* segundos. (A predefinição é de 30 segundos.) Destinado a ser usado com os parâmetros **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo pedindo ao utilizador local que autorize o reinício.
</td>
</tr>
<tr>
<th colspan="2">
Opções Especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força outros programas a fechar quando o computador é encerrado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
Permite o redireccionamento de ficheiros de registo de instalação.
</td>
</tr>
</table>
 
**Informações de Ficheiros**

A versão inglesa desta actualização de segurança tem os atributos de ficheiro listados na tabela seguinte. As datas e horas destes ficheiros estão listadas em formato de hora universal coordenada (UTC). Quando vê as informações dos ficheiros, estas são convertidas para a hora local. Para determinar a diferença entre a hora UTC e a hora local, utilize o separador **Fuso Horário** na ferramenta Data e Hora no Painel de Controlo.

Windows 2000 Service Pack 4 e Small Business Server 2000:

| Nome do Ficheiro | Versão        | Data        | Hora  | Tamanho |
|------------------|---------------|-------------|-------|---------|
| Srv.sys          | 5.0.2195.7087 | 21-Abr-2006 | 05:24 | 239,280 |

**Verificar se a Actualização foi aplicada**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma actualização de segurança foi aplicada num sistema afectado, poderá utilizar a ferramenta Microsoft Baseline Security Analyzer (MBSA). A ferramenta MBSA permite aos administradores procurarem actualizações de segurança em falta e comuns erros de configuração de segurança em sistemas locais e remotos. Para mais informações acerca do MBSA, visite o [Web site do Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Verificação das Versões dos Ficheiros**

    **Nota** Dado existirem várias versões do Microsoft Windows, os passos que se seguem podem ser diferentes no seu computador. Caso efectivamente o sejam, consulte a documentação do produto para executar estes passos.

    1.  Clique em **Iniciar** e, em seguida, em **Procurar**.
    2.  No painel **Resultados da Procura**, clique em **Todos os ficheiros e pastas** no **Assistente de Pesquisa**.
    3.  Na caixa **Totalidade ou parte do nome de ficheiro**, escreva um nome de ficheiro a partir da tabela de informações de ficheiros adequada e, em seguida, clique em **Procurar**.
    4.  Na lista de ficheiros, faça clique com o botão direito na tabela de informações do ficheiro adequada e clique em **Propriedades**.
        **Nota** Consoante a versão do sistema operativo ou programas instalados, alguns dos ficheiros que são apresentados na tabela de informações do ficheiro poderão não ser instalados.
    5.  No separador **Versão**, determine a versão do ficheiro que está instalada no computador, comparando-a com a versão que é documentada na tabela de informações de ficheiros adequada.
        **Nota** Outros atributos que não a versão do ficheiro poderão sofrer alterações durante a instalação. Comparar outros atributos de ficheiro com as informações contidas na tabela de informações de ficheiro não é um método suportado para verificar a aplicação da actualização. Além disso, em determinados casos, o nome dos ficheiros poderá ser alterado durante a instalação. Se as informações de ficheiro ou de versão não estiverem presentes, utilize um dos outros métodos disponíveis para verificar a instalação da actualização.

-   **Verificação da Chave de Registo**

    Poderá também verificar os ficheiros instalados por esta actualização de segurança revendo a seguinte chave de registo:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB917159\\Filelist

    **Nota** Esta chave de registo poderá não conter uma lista completa dos ficheiros instalados. Além disso, esta chave de registo poderá não ser criada correctamente quando um administrador ou um OEM integrar ou associar a actualização de segurança 917159 aos ficheiros de origem de instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) às seguintes entidades por trabalharem connosco para proteger os clientes:

-   Pedram Amini da [TippingPoint Security Research Team](http://www.tippingpoint.com/security) em colaboração com H D Moore por fornecer informações sobre a Vulnerabilidade de Sobrecarga de Heap na Mailslot - (CVE-2006-1314).
-   Nicolas Pouvesle da [Tenable Network Security](http://www.tenablesecurity.com/) por fornecer informações sobre uma questão descrita na Vulnerabilidade de Divulgação de Informações através de SMB - (CVE-2006-1315).
-   Mike Price e Rafal Wojtczuk da [McAfee Avert Labs](http://www.mcafee.com/us/threat_center/default.asp) por fornecerem informações sobre a Vulnerabilidade de Divulgação de Informações através de SMB - (CVE-2006-1315).

**Obter Outras Actualizações de Segurança:**

Estão disponíveis actualizações para outros problemas de segurança nas seguintes localizações:

-   As actualizações de segurança estão disponíveis no [Centro de Transferências da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Pode encontrá-las mais facilmente através de uma procura pelas palavras "security\_patch".
-   As actualizações para as plataformas de consumidor estão disponíveis no [Web site do Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt).

**Suporte:**

-   Os clientes nos E.U.A. e no Canadá podem receber suporte técnico a partir do web site de [Suporte Técnico da Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) em 1-866-PCSAFETY. As chamadas de suporte técnico associadas a actualizações de segurança são gratuitas.
-   Os clientes internacionais podem receber suporte das subsidiárias locais da Microsoft. O suporte técnico associado às actualizações de segurança é gratuito. Para mais informações sobre como contactar a Microsoft relativamente a questões de suporte, visite o [Web site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de Segurança:**

-   O Web site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos Microsoft.
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=pt-pt)
-   Catálogo do Windows Update: Para mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 da Base de Dados de Conhecimento da Microsoft](http://support.microsoft.com/kb/323166).
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Utilizando o Microsoft Software Update Services (SUS) os administradores podem implementar rápida e eficazmente as mais recentes actualizações críticas e actualizações de segurança em servidores baseados no Windows 2000 e no Windows Server 2003, bem como em sistemas de computadores de secretária que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implementar actualizações de segurança com os Software Update Services, visite o [Web site dos Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Ao utilizar os Windows Server Update Services (WSUS), os administradores podem rápida e fiavelmente implementar as actualizações críticas mais recentes e as actualizações de segurança para os sistemas operativos Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 até Windows 2000 e sistemas operativos posteriores.

Para mais informações sobre como implementar actualizações de segurança usando os Windows Server Update Services, visite o [Web site dos Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O Microsoft Systems Management Server (SMS) fornece uma solução empresarial altamente configurável para gerir actualizações. O SMS permite aos administradores identificarem sistemas baseados no Windows que necessitem de actualizações de segurança e executar a implementação controlada dessas actualizações em toda a empresa, com um mínimo de incómodo para os utilizadores finais. Para mais informações sobre como os administradores podem utilizar o SMS 2003 para implementar actualizações, visite o [Web site SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Os utilizadores do SMS 2.0 também podem utilizar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) para ajudar na implementação das actualizações de segurança. Para obter informações sobre o SMS, visite o [Web site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Nota** O SMS utiliza as ferramentas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool e Enterprise Update Scanning Tool para fornecer um suporte abrangente na detecção e implementação de actualizações dos boletins de segurança. Algumas actualizações de software poderão não ser detectadas por estas ferramentas. Nestes casos, os administradores podem utilizar as capacidades de inventário do SMS para fornecer actualizações a sistemas específicos. Para mais informações sobre este procedimento, visite o seguinte [Web site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas actualizações de segurança requerem direitos administrativos após o reinício do sistema. Os administradores podem utilizar a ferramenta Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizações.

**Exclusão de garantia:**

As informações fornecidas na Base de Dados de Conhecimento da Microsoft são fornecidas "tal como estão", sem garantias de qualquer tipo. A Microsoft exclui todas as garantias, sejam expressas ou implícitas, incluindo as garantias de comercialização e adequação a um fim específico. Em caso algum serão a Microsoft Corporation ou os seus fornecedores responsáveis por quaisquer prejuízos, incluindo prejuízos directos, indirectos, incidentais ou consequentes, extraordinários ou por perda de lucros negociais, ainda que a Microsoft Corporation, ou os seus fornecedores tenham sido notificados da possibilidade de ocorrência de tais prejuízos. A exclusão ou limitação de responsabilidade por prejuízos consequentes ou incidentais não é permitida em alguns estados ou jurisdições, pelo que a limitação supra poderá não ser aplicável.

**Revisões:**

-   V1.0 (11 de Julho de 2006): Boletim publicado.
-   V1.1 (1 de Julho de 2006): Boletim actualizado na secção “Perguntas mais frequentes sobre a Vulnerabilidade de Sobrecarga de Heap na Mailslot - CVE-2006-1314” para identificar serviços predefinidos que utilizam Mailslots. Clarificação das plataformas afectadas que necessitam de credenciais de início de sessão válidas listadas na secção “Factores atenuantes para a Vulnerabilidade de Divulgação de Informações através de SMB - CVE-2006-1315”.

*Built at 2014-04-18T01:50:00Z-07:00*
